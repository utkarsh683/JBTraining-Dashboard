
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Invoice Processing Guidelines</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.min.js"></script>
    <style>
        :root {
            --primary: #2a9d8f;
            --secondary: #264653;
            --accent: #e9c46a;
            --light: #f8f9fa;
            --dark: #212529;
            --success: #2a9d8f;
            --warning: #f4a261;
            --danger: #e76f51;
            --info: #457b9d;
            --border-radius: 12px;
            --box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
            --gradient: linear-gradient(135deg, #2a9d8f 0%, #264653 100%);
            --quiz-primary: #4f46e5;
            --quiz-secondary: #7c3aed;
            --quiz-accent: #ec4899;
        }
        /* Theme selector styles */
        .theme-select {
            padding: 6px 8px;
            border-radius: 8px;
            border: 1px solid rgba(0,0,0,0.08);
            background: white;
            font-size: 14px;
            color: #222;
            transition: transform 160ms ease, box-shadow 160ms ease, background-color 160ms ease, color 160ms ease;
            cursor: pointer;
        }
        .theme-select:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(0,0,0,0.12);
            background-color: var(--primary);
            color: #fff;
            border-color: rgba(0,0,0,0.12);
        }
        .theme-select:focus {
            outline: none;
            box-shadow: 0 0 0 4px rgba(42,157,143,0.12);
        }
        .theme-select option { padding: 6px; }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        html {
            scroll-behavior: smooth;
            scroll-padding-top: 30px;
        }
        
        body {
            background: linear-gradient(135deg, #f5f7fa 0%, #e3f2fd 100%);
            color: #333;
            line-height: 1.6;
            min-height: 100vh;
        }
        
        .container {
            display: flex;
            min-height: 100vh;
            max-width: 1600px;
            margin: 0 auto;
            box-shadow: var(--box-shadow);
            background: white;
        }
        
        /* Sidebar Styles */
        .sidebar {
            width: 280px;
            background: var(--gradient);
            color: white;
            padding: 25px 20px;
            position: sticky;
            top: 0;
            height: 100vh;
            overflow-y: auto;
            transition: all 0.3s ease;
            z-index: 100;
        }
        
        .logo {
            display: flex;
            align-items: center;
            margin-bottom: 40px;
            padding-bottom: 20px;
            border-bottom: 1px solid rgba(255, 255, 255, 0.2);
        }
        
        .logo i {
            font-size: 32px;
            margin-right: 12px;
            color: white;
        }
        
        .logo h1 {
            font-size: 22px;
            font-weight: 700;
        }
        
        .nav-links {
            list-style: none;
        }
        
        /* Dropdown Styles */
        .dropdown {
            position: relative;
            margin-bottom: 8px;
        }

        .dropdown-btn {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 14px 16px;
            color: rgba(255, 255, 255, 0.85);
            text-decoration: none;
            border-radius: var(--border-radius);
            transition: all 0.3s ease;
            font-weight: 500;
            cursor: pointer;
            background: transparent;
            border: none;
            width: 100%;
            text-align: left;
            font-size: inherit;
            font-family: inherit;
        }

        .dropdown-btn:hover, .dropdown-btn.active {
            background: rgba(255, 255, 255, 0.15);
            color: white;
            transform: translateX(5px);
        }

        .dropdown-btn i:first-child {
            margin-right: 12px;
            font-size: 18px;
            width: 24px;
            text-align: center;
        }

        .dropdown-icon {
            margin-left: auto;
            font-size: 12px;
            transition: transform 0.3s ease;
        }

        .dropdown-btn.active .dropdown-icon {
            transform: rotate(180deg);
        }

        .dropdown-content {
            display: none;
            padding-left: 30px;
            padding-top: 5px;
            padding-bottom: 5px;
            background: rgba(0, 0, 0, 0.2);
            border-radius: 0 0 var(--border-radius) var(--border-radius);
            margin-top: -8px;
            margin-bottom: 8px;
            animation: slideDown 0.3s ease;
        }

        @keyframes slideDown {
            from {
                opacity: 0;
                transform: translateY(-10px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .dropdown-content a {
            display: block;
            padding: 10px 16px;
            color: rgba(255, 255, 255, 0.7);
            text-decoration: none;
            border-radius: 6px;
            font-size: 14px;
            margin-bottom: 2px;
            transition: all 0.2s ease;
            position: relative;
            padding-left: 24px;
        }

        .dropdown-content a:hover {
            background: rgba(255, 255, 255, 0.1);
            color: white;
            transform: translateX(3px);
        }

        .dropdown-content a:before {
            content: "â€¢";
            position: absolute;
            left: 10px;
            color: var(--accent);
        }

        .dropdown-content a.active {
            background: rgba(255, 255, 255, 0.15);
            color: white;
        }

        .dropdown.active .dropdown-content {
            display: block;
        }
        
        /* Divider for dropdown */
        .dropdown-divider {
            height: 1px;
            background: rgba(255, 255, 255, 0.2);
            margin: 8px 16px;
        }
        
        .nav-links li:not(.dropdown) {
            margin-bottom: 8px;
        }
        
        .nav-links a:not(.dropdown-btn) {
            display: flex;
            align-items: center;
            padding: 14px 16px;
            color: rgba(255, 255, 255, 0.85);
            text-decoration: none;
            border-radius: var(--border-radius);
            transition: all 0.3s ease;
            font-weight: 500;
        }
        
        .nav-links a:not(.dropdown-btn):hover, .nav-links a:not(.dropdown-btn).active {
            background: rgba(255, 255, 255, 0.15);
            color: white;
            transform: translateX(5px);
        }
        
        .nav-links i {
            margin-right: 12px;
            font-size: 18px;
            width: 24px;
            text-align: center;
        }
        
        /* Main Content Styles */
        .main-content {
            flex: 1;
            padding: 30px 40px;
            overflow-y: auto;
        }
        
        .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 40px;
            padding-bottom: 20px;
            border-bottom: 1px solid rgba(0, 0, 0, 0.08);
        }
        
        .header h2 {
            color: var(--primary);
            font-weight: 700;
            font-size: 28px;
        }
        
        .header-actions {
            display: flex;
            gap: 15px;
        }
        
        .btn {
            display: flex;
            align-items: center;
            padding: 12px 20px;
            background: var(--primary);
            color: white;
            border: none;
            border-radius: var(--border-radius);
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 4px 12px rgba(42, 157, 143, 0.3);
        }
        
        .btn:hover {
            background: var(--secondary);
            transform: translateY(-2px);
            box-shadow: 0 6px 15px rgba(42, 157, 143, 0.4);
        }
        
        .btn i {
            margin-right: 8px;
        }
        
        .btn-outline {
            background: transparent;
            border: 2px solid var(--primary);
            color: var(--primary);
        }
        
        .btn-outline:hover {
            background: var(--primary);
            color: white;
        }
        
        .search-box {
            display: flex;
            align-items: center;
            background: white;
            padding: 12px 20px;
            border-radius: 50px;
            box-shadow: var(--box-shadow);
            width: 300px;
        }
        
        .search-box input {
            border: none;
            outline: none;
            background: transparent;
            width: 100%;
            margin-left: 12px;
            font-size: 16px;
        }
        
        /* Section Styles */
        .section {
            background: white;
            border-radius: var(--border-radius);
            box-shadow: var(--box-shadow);
            padding: 30px;
            margin-bottom: 40px;
            border-top: 5px solid var(--primary);
            transition: transform 0.3s ease;
            scroll-margin-top: 30px;
        }
        
        .section:hover {
            transform: translateY(-5px);
        }
        
        .section-header {
            display: flex;
            align-items: center;
            margin-bottom: 25px;
            padding-bottom: 20px;
            border-bottom: 1px solid rgba(0, 0, 0, 0.08);
        }
        
        .section-icon {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 60px;
            height: 60px;
            background: var(--gradient);
            color: white;
            border-radius: 50%;
            margin-right: 20px;
            font-size: 24px;
            box-shadow: 0 6px 15px rgba(42, 157, 143, 0.3);
        }
        
        .section-title {
            font-size: 26px;
            color: var(--primary);
            font-weight: 700;
        }
        
        .definition-box {
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            border-left: 5px solid var(--primary);
            padding: 20px 25px;
            margin-bottom: 25px;
            border-radius: 0 var(--border-radius) var(--border-radius) 0;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.05);
        }
        
        .definition-box h3 {
            color: var(--primary);
            margin-bottom: 12px;
            font-size: 20px;
            display: flex;
            align-items: center;
        }
        
        .definition-box h3 i {
            margin-right: 10px;
        }
        
        /* Table Styles */
        .table-container {
            overflow-x: auto;
            margin: 25px 0;
            border-radius: var(--border-radius);
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.05);
            border: 1px solid rgba(0, 0, 0, 0.05);
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            background: white;
        }
        
        th {
            background: var(--gradient);
            color: white;
            font-weight: 600;
            padding: 18px 20px;
            text-align: left;
        }
        
        td {
            padding: 16px 20px;
            border-bottom: 1px solid rgba(0, 0, 0, 0.05);
        }
        
        tr:last-child td {
            border-bottom: none;
        }
        
        tr:hover {
            background: rgba(42, 157, 143, 0.03);
        }
        
        /* Status Indicators */
        .status {
            display: inline-flex;
            align-items: center;
            padding: 8px 16px;
            border-radius: 50px;
            font-size: 13px;
            font-weight: 600;
            text-align: center;
        }
        
        .status i {
            margin-right: 6px;
        }
        
        .status-yes {
            background: rgba(42, 157, 143, 0.15);
            color: var(--success);
        }
        
        .status-no {
            background: rgba(231, 111, 81, 0.15);
            color: var(--danger);
        }
        
        .status-warning {
            background: rgba(244, 162, 97, 0.15);
            color: var(--warning);
        }
        
        /* Example Cards */
        .example-cards {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
            gap: 25px;
            margin: 25px 0;
        }
        
        .example-card {
            background: white;
            border-radius: var(--border-radius);
            box-shadow: 0 6px 15px rgba(0, 0, 0, 0.05);
            padding: 25px;
            border-top: 4px solid var(--info);
            transition: all 0.3s ease;
        }
        
        .example-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
        }
        
        .example-card h4 {
            color: var(--primary);
            margin-bottom: 12px;
            font-size: 18px;
            display: flex;
            align-items: center;
        }
        
        .example-card h4 i {
            margin-right: 10px;
            color: var(--info);
        }
        
        /* Rules Grid */
        .rules-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 25px;
            margin: 25px 0;
        }
        
        .rule-card {
            background: white;
            border-radius: var(--border-radius);
            box-shadow: 0 6px 15px rgba(0, 0, 0, 0.05);
            padding: 25px;
            border-left: 5px solid var(--success);
            transition: all 0.3s ease;
        }
        
        .rule-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
        }
        
        .rule-card h4 {
            color: var(--primary);
            margin-bottom: 12px;
            font-size: 18px;
            display: flex;
            align-items: center;
        }
        
        .rule-card h4 i {
            margin-right: 10px;
            color: var(--success);
        }
        
        /* Footer */
        .footer {
            text-align: center;
            padding: 30px;
            color: #777;
            font-size: 15px;
            border-top: 1px solid rgba(0, 0, 0, 0.08);
            margin-top: 50px;
            background: rgba(248, 249, 250, 0.7);
            border-radius: var(--border-radius);
        }
        
        /* Stats Cards */
        .stats-container {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }
        
        .stat-card {
            background: white;
            border-radius: var(--border-radius);
            box-shadow: 0 6px 15px rgba(0, 0, 0, 0.05);
            padding: 25px;
            text-align: center;
            transition: all 0.3s ease;
        }
        
        .stat-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
        }
        
        .stat-card i {
            font-size: 36px;
            margin-bottom: 15px;
            color: var(--primary);
        }
        
        .stat-card .number {
            font-size: 32px;
            font-weight: 700;
            color: var(--primary);
            margin-bottom: 5px;
        }
        
        .stat-card .label {
            color: #666;
            font-size: 14px;
            font-weight: 500;
        }
        
        /* Responsive */
        @media (max-width: 1200px) {
            .container {
                flex-direction: column;
            }
            
            .sidebar {
                width: 100%;
                height: auto;
                position: relative;
            }
            
            .main-content {
                margin-left: 0;
            }
        }
        
        @media (max-width: 768px) {
            .header {
                flex-direction: column;
                align-items: flex-start;
                gap: 20px;
            }
            
            .header-actions {
                width: 100%;
                justify-content: space-between;
            }
            
            .search-box {
                width: 100%;
            }
        }
        
        /* Floating Action Button */
        .fab {
            position: fixed;
            bottom: 30px;
            right: 30px;
            width: 60px;
            height: 60px;
            background: var(--primary);
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            box-shadow: 0 6px 20px rgba(42, 157, 143, 0.4);
            cursor: pointer;
            z-index: 1000;
            transition: all 0.3s ease;
            display: none;
        }
        
        .fab:hover {
            background: var(--secondary);
            transform: scale(1.1);
        }
        
        /* Progress Bar */
        .progress-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 4px;
            background: transparent;
            z-index: 1001;
        }
        
        .progress-bar {
            height: 4px;
            background: var(--primary);
            width: 0%;
            transition: width 0.3s ease;
        }
        
        /* Toast Notification */
        .toast {
            position: fixed;
            bottom: 30px;
            left: 50%;
            transform: translateX(-50%);
            background: var(--dark);
            color: white;
            padding: 15px 25px;
            border-radius: var(--border-radius);
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.2);
            z-index: 1000;
            display: flex;
            align-items: center;
            opacity: 0;
            transition: opacity 0.3s ease;
        }
        
        .toast.show {
            opacity: 1;
        }
        
        .toast i {
            margin-right: 10px;
            color: var(--success);
        }
        
        /* Toggle Switch */
        .toggle-container {
            display: flex;
            align-items: center;
            margin-bottom: 20px;
        }
        
        .toggle-text {
            margin-right: 15px;
            font-weight: 500;
            color: var(--dark);
        }
        
        .toggle-switch {
            position: relative;
            display: inline-block;
            width: 60px;
            height: 30px;
        }
        
        .toggle-switch input {
            opacity: 0;
            width: 0;
            height: 0;
        }
        
        .slider {
            position: absolute;
            cursor: pointer;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: #ccc;
            transition: .4s;
            border-radius: 34px;
        }
        
        .slider:before {
            position: absolute;
            content: "";
            height: 22px;
            width: 22px;
            left: 4px;
            bottom: 4px;
            background-color: white;
            transition: .4s;
            border-radius: 50%;
        }
        
        input:checked + .slider {
            background-color: var(--primary);
        }
        
        input:checked + .slider:before {
            transform: translateX(30px);
        }
        
        /* Step Indicator */
        .step-indicator {
            display: flex;
            align-items: center;
            margin: 20px 0;
            position: relative;
        }
        
        .step {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 40px;
            height: 40px;
            background: var(--primary);
            color: white;
            border-radius: 50%;
            font-weight: 700;
            box-shadow: 0 4px 10px rgba(42, 157, 143, 0.3);
            z-index: 2;
        }
        
        .step-line {
            flex: 1;
            height: 3px;
            background: #e0e0e0;
            margin: 0 10px;
        }
        
        .step-line.active {
            background: var(--primary);
        }
        
        .step-content {
            margin-left: 20px;
            flex: 1;
        }
        
        .step-content h4 {
            color: var(--primary);
            margin-bottom: 8px;
        }
        
        .important-note {
            background: rgba(244, 162, 97, 0.1);
            border-left: 5px solid var(--warning);
            padding: 20px;
            border-radius: 0 var(--border-radius) var(--border-radius) 0;
            margin: 20px 0;
        }
        
        .important-note h4 {
            color: var(--warning);
            display: flex;
            align-items: center;
            margin-bottom: 10px;
        }
        
        .important-note h4 i {
            margin-right: 10px;
        }

        /* Quiz Section Styles */
        .quiz-section {
            background: white;
            border-radius: var(--border-radius);
            box-shadow: var(--box-shadow);
            padding: 30px;
            margin-bottom: 40px;
            border-top: 5px solid var(--quiz-primary);
            scroll-margin-top: 30px;
        }

        .quiz-header {
            text-align: center;
            margin-bottom: 40px;
        }

        .quiz-header h2 {
            color: var(--quiz-primary);
            font-size: 32px;
            margin-bottom: 15px;
        }

        .quiz-header p {
            color: #666;
            font-size: 18px;
        }

        .quiz-levels {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 25px;
            margin-bottom: 40px;
        }

        .level-card {
            background: white;
            border-radius: var(--border-radius);
            padding: 30px;
            text-align: center;
            box-shadow: 0 6px 15px rgba(0, 0, 0, 0.08);
            border: 2px solid #e2e8f0;
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .level-card:hover {
            transform: translateY(-5px);
            border-color: var(--quiz-primary);
            box-shadow: 0 15px 30px rgba(79, 70, 229, 0.15);
        }

        .level-icon {
            width: 80px;
            height: 80px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--quiz-primary), var(--quiz-secondary));
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 32px;
            margin: 0 auto 20px;
        }

        .level-card h3 {
            color: var(--quiz-primary);
            margin-bottom: 15px;
            font-size: 24px;
        }

        .level-card p {
            color: #666;
            margin-bottom: 20px;
            line-height: 1.6;
        }

        .level-difficulty {
            display: inline-block;
            padding: 6px 15px;
            border-radius: 20px;
            font-size: 14px;
            font-weight: 600;
        }

        .difficulty-easy {
            background: rgba(16, 185, 129, 0.15);
            color: #047857;
        }

        .difficulty-medium {
            background: rgba(245, 158, 11, 0.15);
            color: #b45309;
        }

        .difficulty-hard {
            background: rgba(239, 68, 68, 0.15);
            color: #b91c1c;
        }

        .difficulty-expert {
            background: rgba(139, 92, 246, 0.15);
            color: #7c3aed;
        }

        /* Quiz Container */
        .quiz-container {
            display: none;
        }

        .quiz-container.active {
            display: block;
            animation: fadeIn 0.5s ease-out;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .quiz-stats {
            display: flex;
            justify-content: space-between;
            align-items: center;
            background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);
            border-radius: var(--border-radius);
            padding: 20px;
            margin-bottom: 30px;
            flex-wrap: wrap;
            gap: 15px;
        }

        .stat-box {
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .stat-icon {
            width: 40px;
            height: 40px;
            border-radius: 10px;
            background: var(--quiz-primary);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 18px;
        }

        .stat-content h4 {
            font-size: 24px;
            color: var(--quiz-primary);
            margin-bottom: 5px;
        }

        .stat-content p {
            font-size: 14px;
            color: #666;
        }

        .quiz-progress {
            flex: 1;
            max-width: 300px;
        }

        .progress-text {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
        }

        .progress-bar-quiz {
            height: 8px;
            background: #e2e8f0;
            border-radius: 4px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(135deg, var(--quiz-primary), var(--quiz-secondary));
            border-radius: 4px;
            width: 0%;
            transition: width 0.5s ease;
        }

        /* Questions Grid - Level 4 Specific */
        .questions-grid-level4 {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 20px;
            margin-bottom: 40px;
            max-height: 70vh;
            overflow-y: auto;
            padding: 10px;
        }

        @media (max-width: 1200px) {
            .questions-grid-level4 {
                grid-template-columns: 1fr;
            }
        }

        .question-card {
            background: white;
            border-radius: var(--border-radius);
            padding: 20px;
            border-left: 5px solid var(--quiz-primary);
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.08);
            transition: all 0.3s ease;
        }

        .question-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.12);
        }

        .question-header {
            display: flex;
            align-items: flex-start;
            margin-bottom: 15px;
            gap: 15px;
        }

        .question-number {
            width: 40px;
            height: 40px;
            min-width: 40px;
            border-radius: 50%;
            background: linear-gradient(135deg, var(--quiz-primary), var(--quiz-secondary));
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 16px;
        }

        .question-text {
            font-size: 16px;
            font-weight: 600;
            line-height: 1.5;
            color: #333;
            flex: 1;
        }

        .options-container {
            display: grid;
            gap: 10px;
        }

        .option {
            padding: 14px 16px;
            background: #f8fafc;
            border: 2px solid #e2e8f0;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
        }

        .option:hover {
            border-color: var(--quiz-primary);
            background: rgba(79, 70, 229, 0.05);
        }

        .option.selected {
            border-color: var(--quiz-primary);
            background: linear-gradient(135deg, rgba(79, 70, 229, 0.1), rgba(124, 58, 237, 0.1));
            box-shadow: 0 4px 12px rgba(79, 70, 229, 0.15);
        }

        .option-letter {
            width: 32px;
            height: 32px;
            min-width: 32px;
            border-radius: 50%;
            background: var(--quiz-primary);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            margin-right: 12px;
            font-size: 14px;
        }

        .option.selected .option-letter {
            background: var(--quiz-secondary);
        }

        .option-text {
            flex: 1;
            font-size: 15px;
            line-height: 1.4;
        }

        /* Quiz Controls - Fixed at Bottom for Level 4 */
        .quiz-controls-level4 {
            position: sticky;
            bottom: 0;
            background: white;
            padding: 20px;
            border-top: 1px solid #e2e8f0;
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-top: 20px;
            box-shadow: 0 -4px 20px rgba(0, 0, 0, 0.05);
            border-radius: 0 0 var(--border-radius) var(--border-radius);
        }

        .quiz-btn {
            padding: 14px 30px;
            border: none;
            border-radius: 10px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .quiz-btn-primary {
            background: linear-gradient(135deg, var(--quiz-primary), var(--quiz-secondary));
            color: white;
        }

        .quiz-btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(79, 70, 229, 0.3);
        }

        .quiz-btn-secondary {
            background: white;
            color: #333;
            border: 2px solid #e2e8f0;
        }

        .quiz-btn-secondary:hover {
            background: #f8fafc;
            border-color: var(--quiz-primary);
        }

        /* Results Section */
        .results-container {
            display: none;
            background: white;
            border-radius: var(--border-radius);
            padding: 40px;
            box-shadow: var(--box-shadow);
            margin-bottom: 40px;
            border-top: 5px solid var(--success);
        }

        .results-container.active {
            display: block;
            animation: fadeIn 0.6s ease-out;
        }

        .results-header {
            text-align: center;
            margin-bottom: 40px;
        }

        .results-header h2 {
            font-size: 36px;
            color: var(--quiz-primary);
            margin-bottom: 15px;
        }

        .score-card {
            background: linear-gradient(135deg, var(--quiz-primary), var(--quiz-secondary));
            border-radius: 20px;
            padding: 40px;
            text-align: center;
            color: white;
            margin-bottom: 40px;
            position: relative;
            overflow: hidden;
        }

        .score-display {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 15px;
        }

        .score-value {
            font-size: 100px;
            font-weight: 800;
            line-height: 1;
        }

        .score-percentage {
            font-size: 32px;
            font-weight: 600;
            opacity: 0.9;
        }

        .score-message {
            font-size: 20px;
            margin-top: 10px;
            opacity: 0.9;
        }

        .score-details {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 20px;
            margin-top: 30px;
        }

        @media (max-width: 768px) {
            .score-details {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        .detail-box {
            background: rgba(255, 255, 255, 0.2);
            border-radius: 15px;
            padding: 20px;
            text-align: center;
            backdrop-filter: blur(10px);
        }

        .detail-value {
            font-size: 28px;
            font-weight: 700;
            margin-bottom: 5px;
        }

        .detail-label {
            font-size: 14px;
            opacity: 0.9;
        }

        /* Answer Review */
        .answers-review {
            margin-top: 40px;
        }

        .answers-review h3 {
            color: var(--quiz-primary);
            margin-bottom: 25px;
            font-size: 24px;
            text-align: center;
        }

        .answer-cards {
            display: grid;
            gap: 20px;
            max-height: 60vh;
            overflow-y: auto;
            padding: 10px;
        }

        .answer-card {
            background: #f8fafc;
            border-radius: 15px;
            padding: 20px;
            border-left: 5px solid;
            transition: all 0.3s ease;
        }

        .answer-card.correct {
            border-left-color: var(--success);
        }

        .answer-card.incorrect {
            border-left-color: var(--danger);
        }

        .answer-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .question-number-small {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            background: var(--quiz-primary);
            color: white;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 14px;
            flex-shrink: 0;
        }

        .answer-status {
            padding: 6px 12px;
            border-radius: 20px;
            font-weight: 600;
            font-size: 13px;
        }

        .status-correct {
            background: rgba(16, 185, 129, 0.2);
            color: #047857;
        }

        .status-incorrect {
            background: rgba(239, 68, 68, 0.2);
            color: #b91c1c;
        }

        .question-review {
            font-weight: 600;
            margin-bottom: 12px;
            font-size: 16px;
        }

        .answer-comparison {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-top: 15px;
        }

        @media (max-width: 768px) {
            .answer-comparison {
                grid-template-columns: 1fr;
            }
        }

        .answer-box {
            background: white;
            border-radius: 8px;
            padding: 15px;
            border: 2px solid;
        }

        .answer-box.user-answer {
            border-color: var(--quiz-primary);
        }

        .answer-box.correct-answer {
            border-color: var(--success);
        }

        .box-label {
            font-size: 13px;
            color: #666;
            margin-bottom: 8px;
            font-weight: 600;
        }

        .answer-text {
            font-size: 15px;
            line-height: 1.4;
        }

        .explanation {
            margin-top: 15px;
            padding: 15px;
            background: white;
            border-radius: 8px;
            border-left: 4px solid var(--quiz-primary);
            font-size: 14px;
        }

        .explanation strong {
            color: var(--quiz-primary);
        }

        /* Floating Elements */
        .floating-elements {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: -1;
        }

        .floating-element {
            position: absolute;
            width: 50px;
            height: 50px;
            background: rgba(79, 70, 229, 0.05);
            border-radius: 50%;
            animation: float 15s linear infinite;
        }

        @keyframes float {
            0% { transform: translate(0, 0) rotate(0deg); }
            25% { transform: translate(50px, 50px) rotate(90deg); }
            50% { transform: translate(0, 100px) rotate(180deg); }
            75% { transform: translate(-50px, 50px) rotate(270deg); }
            100% { transform: translate(0, 0) rotate(360deg); }
        }

        /* Scrollbar Styling */
        .questions-grid-level4::-webkit-scrollbar,
        .answer-cards::-webkit-scrollbar {
            width: 8px;
        }

        .questions-grid-level4::-webkit-scrollbar-track,
        .answer-cards::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 4px;
        }

        .questions-grid-level4::-webkit-scrollbar-thumb,
        .answer-cards::-webkit-scrollbar-thumb {
            background: var(--quiz-primary);
            border-radius: 4px;
        }

        .questions-grid-level4::-webkit-scrollbar-thumb:hover,
        .answer-cards::-webkit-scrollbar-thumb:hover {
            background: var(--quiz-secondary);
        }

        /* Add anchor points for dropdown links */
        #general-rules,
        #processing-steps,
        #example-scenarios,
        #item-types,
        #po-definition,
        #po-terms,
        #po-format,
        #po-examples,
        #due-date-definition,
        #due-date-terms,
        #due-date-calculation,
        #due-date-exceptions,
        #invoice-codes,
        #receipt-codes,
        #number-format,
        #date-rules,
        #split-definition,
        #split-rules,
        #split-examples,
        #split-exceptions,
        #bottle-calculation,
        #catch-definition,
        #catch-rules,
        #catch-examples,
        #catch-validation,
        #uom-conversion,
        #freight-definition,
        #other-charge-definition,
        #charge-examples,
        #charge-processing,
        #practical-box,
        #deposit-categories,
        #keg-deposit,
        #deposit-on-item,
        #keg-return,
        #deposit-examples,
        #discount-definition,
        #discount-conditions,
        #discount-steps,
        #discount-examples,
        #split-discount,
        #credit-definition,
        #credit-keywords,
        #credit-processing,
        #credit-examples,
        #reverse-processing {
            scroll-margin-top: 100px;
        }
        
        /* TTS Controls Container */
        .tts-controls {
            position: fixed;
            bottom: 30px;
            left: 30px;
            background: white;
            border-radius: 15px;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
            padding: 15px;
            z-index: 1000;
            display: flex;
            align-items: center;
            gap: 15px;
            transition: transform 0.3s ease;
            border: 1px solid #e0e0e0;
            min-width: 300px;
            flex-wrap: wrap;
        }
        
        .tts-controls.minimized {
            transform: translateX(-260px);
        }
        
        .tts-controls.minimized .tts-main-controls,
        .tts-controls.minimized .tts-settings,
        .tts-controls.minimized .tts-language-switcher {
            display: none;
        }
        
        /* TTS Main Controls */
        .tts-main-controls {
            display: flex;
            align-items: center;
            gap: 10px;
            flex: 1;
            min-width: 250px;
        }
        
        .tts-btn {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            border: none;
            background: var(--primary);
            color: white;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
            box-shadow: 0 4px 8px rgba(42, 157, 143, 0.3);
        }
        
        .tts-btn:hover {
            background: var(--secondary);
            transform: scale(1.1);
        }
        
        .tts-btn:disabled {
            background: #cccccc;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }
        
        .tts-btn.play {
            background: linear-gradient(135deg, var(--primary), #34d399);
        }
        
        .tts-btn.pause {
            background: linear-gradient(135deg, #f59e0b, #fbbf24);
        }
        
        .tts-btn.stop {
            background: linear-gradient(135deg, #ef4444, #f87171);
        }
        
        /* Progress bar */
        .tts-progress-container {
            flex: 1;
            height: 6px;
            background: #e5e7eb;
            border-radius: 3px;
            overflow: hidden;
            position: relative;
        }
        
        .tts-progress-bar {
            height: 100%;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            border-radius: 3px;
            width: 0%;
            transition: width 0.3s ease;
        }
        
        /* Current section indicator */
        .tts-current-section {
            font-size: 12px;
            color: #666;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
            max-width: 120px;
        }
        
        /* TTS Settings */
        .tts-settings {
            display: flex;
            align-items: center;
            gap: 15px;
            padding: 10px 0;
            border-top: 1px solid #e5e7eb;
            margin-top: 10px;
            width: 100%;
            flex-wrap: wrap;
        }
        
        .tts-settings select,
        .tts-settings input {
            padding: 8px 12px;
            border-radius: 8px;
            border: 1px solid #d1d5db;
            font-size: 14px;
            background: white;
        }
        
        .tts-settings select {
            flex: 1;
            min-width: 150px;
        }
        
        .tts-settings label {
            font-size: 12px;
            color: #666;
            display: flex;
            flex-direction: column;
            gap: 5px;
        }
        
        .tts-speed {
            width: 60px;
        }
        
        /* TTS Language Switcher */
        .tts-language-switcher {
            display: flex;
            gap: 10px;
            margin-top: 10px;
            padding-top: 10px;
            border-top: 1px solid #e5e7eb;
            width: 100%;
        }

        .lang-btn {
            padding: 6px 12px;
            border: 1px solid #d1d5db;
            background: white;
            border-radius: 6px;
            font-size: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            flex: 1;
            text-align: center;
        }

        .lang-btn:hover {
            border-color: var(--primary);
            background: rgba(42, 157, 143, 0.05);
        }

        .lang-btn.active {
            background: var(--primary);
            color: white;
            border-color: var(--primary);
        }

        /* TTS Language Indicator */
        .tts-language-indicator {
            position: absolute;
            top: -25px;
            left: 10px;
            background: var(--info);
            color: white;
            padding: 2px 8px;
            border-radius: 10px;
            font-size: 10px;
            font-weight: 600;
        }

        /* TTS Pause/Resume indicator */
        .tts-pause-indicator {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-top: 8px;
            padding: 8px;
            background: rgba(244, 162, 97, 0.1);
            border-radius: 6px;
            font-size: 12px;
            color: var(--warning);
            width: 100%;
        }

        .tts-pause-indicator i {
            font-size: 14px;
        }
        
        /* TTS Minimize/Expand Button */
        .tts-toggle {
            position: absolute;
            right: -12px;
            top: 50%;
            transform: translateY(-50%);
            width: 24px;
            height: 24px;
            border-radius: 50%;
            background: var(--primary);
            color: white;
            border: none;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
        }
        
        /* Highlight for currently reading text */
        .tts-highlight {
            background: linear-gradient(135deg, rgba(42, 157, 143, 0.2), rgba(233, 196, 106, 0.2));
            border-radius: 4px;
            padding: 2px 4px;
            transition: all 0.3s ease;
        }
        
        /* TTS Status Indicator */
        .tts-status {
            position: absolute;
            top: -10px;
            right: 10px;
            background: var(--primary);
            color: white;
            padding: 3px 8px;
            border-radius: 10px;
            font-size: 10px;
            font-weight: 600;
        }
        
        /* Floating Elements for TTS */
        .floating-element.tts {
            background: rgba(42, 157, 143, 0.1);
            animation: float-tts 20s linear infinite;
        }
        
        @keyframes float-tts {
            0% { transform: translate(0, 0) rotate(0deg); opacity: 0.5; }
            25% { transform: translate(20px, 20px) rotate(90deg); opacity: 0.8; }
            50% { transform: translate(0, 40px) rotate(180deg); opacity: 0.5; }
            75% { transform: translate(-20px, 20px) rotate(270deg); opacity: 0.8; }
            100% { transform: translate(0, 0) rotate(360deg); opacity: 0.5; }
        }
        
        /* Upload Section Styles */
        .upload-container {
            background: white;
            border-radius: var(--border-radius);
            padding: 30px;
            box-shadow: var(--box-shadow);
        }

        .upload-area {
            border: 3px dashed var(--primary);
            border-radius: var(--border-radius);
            padding: 60px 30px;
            text-align: center;
            background: rgba(42, 157, 143, 0.05);
            margin-bottom: 30px;
            position: relative;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .upload-area:hover {
            background: rgba(42, 157, 143, 0.1);
            border-color: var(--secondary);
            transform: translateY(-2px);
        }

        .upload-area.dragover {
            background: rgba(42, 157, 143, 0.15);
            border-color: var(--accent);
        }

        .upload-icon {
            font-size: 60px;
            color: var(--primary);
            margin-bottom: 20px;
        }

        .upload-area h3 {
            color: var(--primary);
            margin-bottom: 10px;
            font-size: 24px;
        }

        .upload-area p {
            color: #666;
            margin-bottom: 5px;
        }

        .upload-formats {
            font-size: 14px;
            color: #888;
            margin-top: 15px;
        }

        #fileInput {
            position: absolute;
            width: 100%;
            height: 100%;
            top: 0;
            left: 0;
            opacity: 0;
            cursor: pointer;
        }

        .upload-progress {
            margin-top: 20px;
            background: #f8f9fa;
            padding: 15px;
            border-radius: 10px;
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .progress-bar-upload {
            flex: 1;
            height: 8px;
            background: #e0e0e0;
            border-radius: 4px;
            overflow: hidden;
        }

        .progress-fill-upload {
            height: 100%;
            background: linear-gradient(135deg, var(--primary), var(--secondary));
            border-radius: 4px;
            width: 0%;
            transition: width 0.3s ease;
        }

        /* Upload Filters */
        .upload-filters {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            flex-wrap: wrap;
            gap: 15px;
        }

        .filter-controls {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        .filter-btn {
            padding: 8px 16px;
            background: #f8f9fa;
            border: 2px solid #e0e0e0;
            border-radius: 20px;
            color: #666;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .filter-btn:hover {
            border-color: var(--primary);
            color: var(--primary);
        }

        .filter-btn.active {
            background: var(--primary);
            color: white;
            border-color: var(--primary);
        }

        .sort-select {
            padding: 8px 16px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            background: white;
            color: #333;
            font-weight: 500;
            min-width: 180px;
        }

        /* Files Grid */
        .files-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
            max-height: 500px;
            overflow-y: auto;
            padding: 10px;
        }

        .file-card {
            background: white;
            border-radius: 12px;
            padding: 20px;
            border: 2px solid #f0f0f0;
            text-align: center;
            transition: all 0.3s ease;
            cursor: pointer;
            position: relative;
            overflow: hidden;
        }

        .file-card:hover {
            transform: translateY(-5px);
            border-color: var(--primary);
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.1);
        }

        .file-icon {
            width: 60px;
            height: 60px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 0 auto 15px;
            font-size: 28px;
            color: white;
        }

        .file-icon.pdf { background: linear-gradient(135deg, #ff6b6b, #ee5a52); }
        .file-icon.excel { background: linear-gradient(135deg, #1d6f42, #107c41); }
        .file-icon.word { background: linear-gradient(135deg, #2b579a, #2b579a); }
        .file-icon.image { background: linear-gradient(135deg, #9c27b0, #673ab7); }
        .file-icon.ppt { background: linear-gradient(135deg, #d24726, #c43e1c); }
        .file-icon.json { background: linear-gradient(135deg, #ff9800, #f57c00); }
        .file-icon.html { background: linear-gradient(135deg, #e44d26, #f16529); }
        .file-icon.txt { background: linear-gradient(135deg, #757575, #616161); }
        .file-icon.other { background: linear-gradient(135deg, #607d8b, #455a64); }

        .file-name {
            font-weight: 600;
            color: #333;
            margin-bottom: 8px;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .file-size {
            font-size: 12px;
            color: #666;
            margin-bottom: 5px;
        }

        .file-date {
            font-size: 11px;
            color: #888;
        }

        .file-actions {
            position: absolute;
            top: 10px;
            right: 10px;
            display: flex;
            gap: 5px;
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .file-card:hover .file-actions {
            opacity: 1;
        }

        .file-action-btn {
            width: 30px;
            height: 30px;
            border-radius: 50%;
            background: white;
            border: 1px solid #e0e0e0;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .file-action-btn:hover {
            background: var(--primary);
            color: white;
            border-color: var(--primary);
        }

        /* Upload Stats */
        .upload-stats {
            display: flex;
            justify-content: space-around;
            background: #f8f9fa;
            padding: 20px;
            border-radius: 12px;
            margin-top: 30px;
        }

        .stat-item {
            text-align: center;
            color: #666;
        }

        .stat-item i {
            font-size: 24px;
            color: var(--primary);
            margin-bottom: 8px;
            display: block;
        }

        .stat-item span {
            display: block;
            font-size: 24px;
            font-weight: 700;
            color: var(--primary);
            margin-bottom: 5px;
        }

        /* Preview Modal */
        .preview-modal {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: white;
            z-index: 2000;
            display: none;
            flex-direction: column;
        }

        .preview-header {
            background: var(--gradient);
            color: white;
            padding: 20px 30px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
        }

        .preview-header-left {
            display: flex;
            align-items: center;
            gap: 20px;
        }

        .preview-header-right {
            display: flex;
            gap: 10px;
        }

        .preview-btn {
            padding: 10px 20px;
            border: none;
            border-radius: 8px;
            background: rgba(255, 255, 255, 0.2);
            color: white;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .preview-btn:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: translateY(-2px);
        }

        .download-btn {
            background: rgba(16, 185, 129, 0.8);
        }

        .close-btn {
            background: rgba(239, 68, 68, 0.8);
        }

        .preview-content {
            flex: 1;
            padding: 30px;
            overflow: auto;
        }

        .preview-footer {
            background: #f8f9fa;
            padding: 20px 30px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-top: 1px solid #e0e0e0;
        }

        .file-info {
            display: flex;
            gap: 20px;
            font-size: 14px;
            color: #666;
        }

        .file-info span {
            padding: 6px 12px;
            background: white;
            border-radius: 6px;
            border: 1px solid #e0e0e0;
        }

        .preview-controls {
            display: flex;
            align-items: center;
            gap: 20px;
        }

        .preview-nav-btn {
            padding: 10px 20px;
            border: 2px solid var(--primary);
            background: white;
            color: var(--primary);
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .preview-nav-btn:hover:not(:disabled) {
            background: var(--primary);
            color: white;
        }

        .preview-nav-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            border-color: #ccc;
            color: #ccc;
        }

        #fileCounter {
            font-weight: 600;
            color: #333;
        }

        /* Preview Content Styles */
        .preview-frame {
            width: 100%;
            height: 100%;
            border: none;
            border-radius: 8px;
            background: white;
        }

        .preview-image {
            max-width: 100%;
            max-height: 100%;
            display: block;
            margin: 0 auto;
            border-radius: 8px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
        }

        .preview-text {
            background: white;
            padding: 30px;
            border-radius: 8px;
            font-family: 'Courier New', monospace;
            font-size: 14px;
            line-height: 1.6;
            white-space: pre-wrap;
            max-height: 70vh;
            overflow: auto;
        }

        .preview-unsupported {
            text-align: center;
            padding: 60px 30px;
            color: #666;
        }

        .preview-unsupported i {
            font-size: 80px;
            color: #ccc;
            margin-bottom: 20px;
        }

        .preview-unsupported h3 {
            color: #333;
            margin-bottom: 10px;
        }

        /* Empty State */
        .empty-state {
            text-align: center;
            padding: 60px 30px;
            color: #999;
        }

        .empty-state i {
            font-size: 80px;
            margin-bottom: 20px;
            opacity: 0.5;
        }

        .empty-state h3 {
            margin-bottom: 10px;
            color: #666;
        }
        
        /* Responsive adjustments for TTS */
        @media (max-width: 768px) {
            .tts-controls {
                bottom: 20px;
                left: 20px;
                right: 20px;
                min-width: auto;
                max-width: calc(100vw - 40px);
            }
            
            .tts-controls.minimized {
                transform: translateX(-85%);
            }
            
            .tts-settings {
                flex-wrap: wrap;
            }
            
            .tts-settings select {
                min-width: 100px;
            }
            
            .tts-main-controls {
                min-width: 200px;
            }
            
            .tts-current-section {
                max-width: 80px;
            }
            
            .files-grid {
                grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            }
            
            .upload-filters {
                flex-direction: column;
                align-items: stretch;
            }
            
            .filter-controls {
                justify-content: center;
            }
            
            .upload-stats {
                flex-direction: column;
                gap: 20px;
            }
            
            .preview-header {
                padding: 15px;
                flex-direction: column;
                gap: 15px;
            }
            
            .file-info {
                flex-direction: column;
                gap: 10px;
            }
            
            .preview-footer {
                flex-direction: column;
                gap: 20px;
            }
        }
        
        /* Dark mode adjustments for TTS */
        body.dark-mode .tts-controls {
            background: #2d2d2d;
            border-color: #444;
        }
        
        body.dark-mode .tts-settings select,
        body.dark-mode .tts-settings input {
            background: #3d3d3d;
            border-color: #555;
            color: #f5f5f5;
        }
        
        body.dark-mode .tts-current-section {
            color: #ccc;
        }
        
        body.dark-mode .tts-progress-container {
            background: #444;
        }
        
        body.dark-mode .tts-settings label {
            color: #ccc;
        }
        
        body.dark-mode .lang-btn {
            background: #3d3d3d;
            border-color: #555;
            color: #f5f5f5;
        }
        
        body.dark-mode .lang-btn.active {
            background: var(--primary);
            color: white;
        }
        
        body.dark-mode .lang-btn:hover {
            background: rgba(42, 157, 143, 0.2);
        }
    </style>
</head>
<body>
    <div class="progress-container">
        <div class="progress-bar" id="progressBar"></div>
    </div>
    
    <div class="container">
        <!-- Sidebar -->
        <div class="sidebar">
            <div class="logo">
                <i class="fas fa-file-invoice"></i>
                <h1>Invoice Processing Guidelines</h1>
            </div>
            <ul class="nav-links">
                <!-- Main How to Process Dropdown containing ALL processing points -->
                <li class="dropdown">
                    <a href="#how-to-process" class="dropdown-btn active">
                        <i class="fas fa-cogs"></i> How to Process 
                        <i class="fas fa-chevron-down dropdown-icon"></i>
                    </a>
                    <div class="dropdown-content">
                        <!-- Processing Overview -->
                        <a href="#general-rules">General Rules</a>
                        <a href="#processing-steps">Processing Steps</a>
                        <a href="#example-scenarios">Example Scenarios</a>
                        <a href="#item-types">Item Types</a>
                        
                        <div class="dropdown-divider"></div>
                        
                        <!-- All Specific Processing Points -->
                        <a href="#purchase-order"><i class="fas fa-shopping-cart"></i> Purchase Order</a>
                        <a href="#due-date"><i class="fas fa-calendar-day"></i> Due Date</a>
                        <a href="#invoice-number"><i class="fas fa-hashtag"></i> Invoice Number & Date</a>
                        <a href="#liquor-split"><i class="fas fa-wine-bottle"></i> Liquor Invoice - Split</a>
                        <a href="#standard-catch"><i class="fas fa-balance-scale"></i> Standard/Food Invoice - CATCH</a>
                        <a href="#freight-charge"><i class="fas fa-truck"></i> Freight & Other Charges</a>
                        <a href="#deposit"><i class="fas fa-money-bill-wave"></i> Liquor Invoice - Deposit</a>
                        <a href="#discount"><i class="fas fa-percentage"></i> 100% Discount</a>
                        <a href="#credit-memo"><i class="fas fa-file-invoice-dollar"></i> Credit Memo</a>
                    </div>
                </li>
                
                <!-- Quiz and Upload in sidebar -->
                <li><a href="#quiz-section"><i class="fas fa-graduation-cap"></i> Training Quiz</a></li>
                <li><a href="#upload-section"><i class="fas fa-upload"></i> Upload Files</a></li>
            </ul>
            
            <div class="toggle-container" style="margin-top: 40px;">
                <span class="toggle-text">Dark Mode</span>
                <label class="toggle-switch">
                    <input type="checkbox" id="darkModeToggle">
                    <span class="slider"></span>
                </label>
            </div>
            
            <!-- TTS Status in Sidebar -->
            <div id="ttsSidebarStatus" style="margin-top: 30px; padding: 15px; background: rgba(255,255,255,0.1); border-radius: 8px; display: none;">
                <h4 style="color: white; margin-bottom: 10px; font-size: 14px;">
                    <i class="fas fa-volume-up"></i> Text-to-Speech
                </h4>
                <div id="ttsCurrentStatus" style="font-size: 12px; color: rgba(255,255,255,0.8);">
                    Ready to read
                </div>
                <div id="ttsCurrentSection" style="font-size: 11px; color: var(--accent); margin-top: 5px; font-style: italic;">
                    No section selected
                </div>
            </div>
        </div>
        
        <!-- Main Content -->
        <div class="main-content" id="mainContent">
            <div class="header">
                <h2>Invoice Processing Guidelines</h2>
                <div class="header-actions">
                    <div class="search-box">
                        <i class="fas fa-search"></i>
                        <input type="text" placeholder="Search guidelines..." id="searchInput">
                    </div>
                    
                    <!-- TTS Control Button in Header -->
                    <select id="themeSelect" class="theme-select" title="Change theme" style="margin-right:10px;">
                        <option value="default">Theme: Default</option>
                        <option value="teal">Theme: Teal</option>
                        <option value="purple">Theme: Purple</option>
                        <option value="olive">Theme: Olive</option>
                        <option value="dark">Theme: Dark</option>
                    </select>
                    <button class="btn btn-outline" id="ttsHeaderBtn" style="margin-right: 10px;">
                        <i class="fas fa-volume-up"></i> Read Aloud
                    </button>
                    
                    <button class="btn" id="downloadPdf">
                        <i class="fas fa-download"></i> Export PDF
                    </button>
                    <button class="btn btn-outline" id="printBtn">
                        <i class="fas fa-print"></i> Print
                    </button>
                </div>
            </div>
            
            <!-- TTS Floating Controls -->
            <div class="tts-controls" id="ttsControls">
                <div class="tts-status" id="ttsStatus">Ready</div>
                <div class="tts-language-indicator" id="ttsLanguageIndicator">English</div>
                <div class="tts-main-controls">
                    <button class="tts-btn play" id="ttsPlayBtn" title="Play">
                        <i class="fas fa-play"></i>
                    </button>
                    <button class="tts-btn pause" id="ttsPauseBtn" title="Pause" disabled>
                        <i class="fas fa-pause"></i>
                    </button>
                    <button class="tts-btn stop" id="ttsStopBtn" title="Stop" disabled>
                        <i class="fas fa-stop"></i>
                    </button>
                    
                    <div class="tts-progress-container">
                        <div class="tts-progress-bar" id="ttsProgressBar"></div>
                    </div>
                    
                    <div class="tts-current-section" id="ttsCurrentSectionText">
                        Select a section
                    </div>
                </div>
                
                <div class="tts-settings">
                    <label>
                        Voice:
                        <select id="ttsVoiceSelect"></select>
                    </label>
                    
                    <label>
                        Speed:
                        <input type="number" id="ttsSpeed" class="tts-speed" min="0.5" max="2" step="0.1" value="1">
                    </label>
                    
                    <label>
                        Pitch:
                        <input type="number" id="ttsPitch" min="0.5" max="2" step="0.1" value="1">
                    </label>
                </div>
                
                <!-- Language Switcher -->
                <div class="tts-language-switcher">
                    <button class="lang-btn active" data-lang="en" title="English">
                        <i class="fas fa-language"></i> English
                    </button>
                    <button class="lang-btn" data-lang="hi" title="Hindi">
                        <i class="fas fa-language"></i> à¤¹à¤¿à¤‚à¤¦à¥€
                    </button>
                    <button class="lang-btn" data-lang="gu" title="Gujarati">
                        <i class="fas fa-language"></i> àª—à«àªœàª°àª¾àª¤à«€
                    </button>
                </div>
                
                <button class="tts-toggle" id="ttsToggleBtn" title="Minimize">
                    <i class="fas fa-chevron-left" id="ttsToggleIcon"></i>
                </button>
            </div>
            
            <div class="stats-container">
                <div class="stat-card">
                    <i class="fas fa-file-invoice"></i>
                    <div class="number">10</div>
                    <div class="label">Processing Categories</div>
                </div>
                <div class="stat-card">
                    <i class="fas fa-check-circle"></i>
                    <div class="number">42</div>
                    <div class="label">Guidelines</div>
                </div>
                <div class="stat-card">
                    <i class="fas fa-table"></i>
                    <div class="number">24</div>
                    <div class="label">Reference Tables</div>
                </div>
                <div class="stat-card">
                    <i class="fas fa-lightbulb"></i>
                    <div class="number">35</div>
                    <div class="label">Examples</div>
                </div>
            </div>
            
            <!-- How to Process Section -->
            <section id="how-to-process" class="section">
                <div class="section-header">
                    <div class="section-icon">
                        <i class="fas fa-cogs"></i>
                    </div>
                    <h2 class="section-title">How to Process the Invoice</h2>
                </div>
                
                <div class="definition-box">
                    <h3><i class="fas fa-info-circle"></i> Definition</h3>
                    <p>This rule explains how to process invoices and assign the correct line details and default codes based on whether the items are Food, Liquor, or Non-Food, and as per the TENT (template/request) instructions.</p>
                </div>
                
                <div class="important-note">
                    <h4><i class="fas fa-exclamation-circle"></i> Important Note</h4>
                    <p>Always verify the item type before assigning the code.</p>
                </div>
                
                <h3 id="general-rules">âš™ï¸ General Rules</h3>
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>Step / Condition</th>
                                <th>Instruction / Action</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>âž¤ Line Details</td>
                                <td>Always create line details for every invoice (each item or as per TENT).</td>
                            </tr>
                            <tr>
                                <td>âž¤ XCG-101 (Purchase Summary)</td>
                                <td>The default code is always XCG-101 (Purchase Summary).</td>
                            </tr>
                            <tr>
                                <td>âž¤ X.CHEF Default</td>
                                <td>Check the invoice type before deciding the code: 
                                    <br>- If the invoice has Food or Liquor items â†’ Create line details.
                                    <br>- If the invoice has Non-Food items â†’ Create line using XCG-101 (Purchase Summary).
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                
                <div class="definition-box">
                    <h3><i class="fas fa-info-circle"></i> Definition</h3>
                    <p>This rule explains how to process invoices based on whether they contain Food or Non-Food items, and how to handle cases where the TENT (template/request) asks for a specific line or code.</p>
                </div>
                
                <h3>âš™ï¸ Rules</h3>
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>Condition</th>
                                <th>Instruction / Action</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>1ï¸âƒ£ Non-Food Invoice</td>
                                <td>When the invoice contains Non-Food items and the TENT also requests line creation, then you must create individual lines for each item in the invoice.</td>
                            </tr>
                            <tr>
                                <td>2ï¸âƒ£ Food Invoice</td>
                                <td>When the invoice contains Food items, but the TENT requests code XCG-101, then you should create a single line using code XCG-101 (Purchase Summary) instead of creating multiple item lines.</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                
                <h3 id="example-scenarios">ðŸ’¡ Example Scenarios - 1</h3>
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>Invoice Type</th>
                                <th>TENT Request</th>
                                <th>Action to Take</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>Non-Food Invoice (e.g., cleaning items, napkins)</td>
                                <td>"Create Lines"</td>
                                <td><span class="status status-yes">Create all lines individually</span></td>
                            </tr>
                            <tr>
                                <td>Food Invoice (e.g., meat, vegetables)</td>
                                <td>"Use XCG-101"</td>
                                <td><span class="status status-yes">Create one single line under Purchase Summary (XCG-101)</span></td>
                            </tr>
                            <tr>
                                <td>Mixed Invoice</td>
                                <td>Mixed TENT instruction</td>
                                <td><span class="status status-warning">Check each item and follow as per category</span></td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                
                <h3 id="item-types">ðŸ’¡ Example Scenarios - 2</h3>
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>Invoice Type</th>
                                <th>Contains</th>
                                <th>Code to Use</th>
                                <th>Action</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>Food Invoice</td>
                                <td>Food items (e.g., vegetables, meat)</td>
                                <td>X.CHEF Default</td>
                                <td><span class="status status-yes">Create line with X.CHEF Default</span></td>
                            </tr>
                            <tr>
                                <td>Liquor Invoice</td>
                                <td>Beer, Wine, Spirits</td>
                                <td>X.CHEF Default</td>
                                <td><span class="status status-yes">Create line with X.CHEF Default</span></td>
                            </tr>
                            <tr>
                                <td>Non-Food Invoice</td>
                                <td>Cleaning supplies, napkins, paper items</td>
                                <td>XCG-101</td>
                                <td><span class="status status-yes">Create line with XCG-101</span></td>
                            </tr>
                            <tr>
                                <td>Mixed Invoice</td>
                                <td>Food + Non-Food</td>
                                <td>Check each item and assign code accordingly</td>
                                <td><span class="status status-warning">Verify item category</span></td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                
                <h3 id="processing-steps">Processing Steps</h3>
                <div class="step-indicator">
                    <div class="step">1</div>
                    <div class="step-line active"></div>
                    <div class="step-content">
                        <h4>Identify Invoice Type</h4>
                        <p>Determine if the invoice contains Food, Liquor, Non-Food items, or a mix.</p>
                    </div>
                </div>
                
                <div class="step-indicator">
                    <div class="step">2</div>
                    <div class="step-line active"></div>
                    <div class="step-content">
                        <h4>Check TENT Instructions</h4>
                        <p>Review the TENT (template/request) for specific instructions on line creation or code usage.</p>
                    </div>
                </div>
                
                <div class="step-indicator">
                    <div class="step">3</div>
                    <div class="step-line active"></div>
                    <div class="step-content">
                        <h4>Assign Correct Codes</h4>
                        <p>Use X.CHEF Default for Food/Liquor items and XCG-101 for Non-Food items, unless TENT specifies otherwise.</p>
                    </div>
                </div>
                
                <div class="step-indicator">
                    <div class="step">4</div>
                    <div class="step-line"></div>
                    <div class="step-content">
                        <h4>Create Line Details</h4>
                        <p>Create individual line items or a summary line based on the invoice type and TENT instructions.</p>
                    </div>
                </div>
            </section>
            
            <!-- Purchase Order Section -->
            <section id="purchase-order" class="section">
                <div class="section-header">
                    <div class="section-icon">
                        <i class="fas fa-shopping-cart"></i>
                    </div>
                    <h2 class="section-title">Purchase Order (PO Number)</h2>
                </div>
                
                <div class="definition-box" id="po-definition">
                    <h3><i class="fas fa-info-circle"></i> Definition</h3>
                    <p>A Purchase Order (PO) Number is a unique identifier assigned to each purchase transaction. It represents the formal request issued by a buyer to a seller, detailing the products, quantities, and agreed prices for goods or services.</p>
                </div>
                
                <h3 id="po-terms">Common Terms Used</h3>
                <div class="rules-grid">
                    <div class="rule-card">
                        <h4><i class="fas fa-tag"></i> PO Number</h4>
                        <p>Standard abbreviation for Purchase Order Number</p>
                    </div>
                    <div class="rule-card">
                        <h4><i class="fas fa-file-alt"></i> Purchase Order Number</h4>
                        <p>Full form of PO Number</p>
                    </div>
                    <div class="rule-card">
                        <h4><i class="fas fa-file-contract"></i> Purchase Order</h4>
                        <p>Complete purchase order document</p>
                    </div>
                    <div class="rule-card">
                        <h4><i class="fas fa-user-tag"></i> Customer Purchase Order</h4>
                        <p>PO issued by the customer</p>
                    </div>
                    <div class="rule-card">
                        <h4><i class="fas fa-user-check"></i> Customer PO</h4>
                        <p>Abbreviated form of Customer Purchase Order</p>
                    </div>
                </div>
                
                <h3 id="po-format">PO Number Format</h3>
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>Type</th>
                                <th>Format</th>
                                <th>Example</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>Standard PO</td>
                                <td>Numbers only or alphanumeric</td>
                                <td>PO-12345 or 202300123</td>
                            </tr>
                            <tr>
                                <td>Vendor Reference</td>
                                <td>May include vendor name or code</td>
                                <td>VENDOR-001 or ABC-2023-456</td>
                            </tr>
                            <tr>
                                <td>Customer PO</td>
                                <td>Customer-specific format</td>
                                <td>CUST-PO-789 or 2023-07-15-001</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                
                <h3 id="po-examples">Examples from Different Vendors</h3>
                <div class="example-cards">
                    <div class="example-card">
                        <h4><i class="fas fa-building"></i> Sysco</h4>
                        <p>Format: Usually numeric or alphanumeric with prefix</p>
                        <p>Example: SYS-456789 or 7890123</p>
                    </div>
                    <div class="example-card">
                        <h4><i class="fas fa-warehouse"></i> US Foods</h4>
                        <p>Format: Typically numeric sequence</p>
                        <p>Example: 12345678 or UF-789012</p>
                    </div>
                    <div class="example-card">
                        <h4><i class="fas fa-store"></i> Local Supplier</h4>
                        <p>Format: Varies widely, may include date</p>
                        <p>Example: LS-2023-07-15 or INV-789</p>
                    </div>
                </div>
            </section>
            
            <!-- Due Date Section -->
            <section id="due-date" class="section">
                <div class="section-header">
                    <div class="section-icon">
                        <i class="fas fa-calendar-day"></i>
                    </div>
                    <h2 class="section-title">Due Date</h2>
                </div>
                
                <div class="definition-box" id="due-date-definition">
                    <h3><i class="fas fa-info-circle"></i> Definition</h3>
                    <p>A Due Date is the final date by which payment must be made for the goods or services mentioned in an invoice. It indicates the deadline for settling the payment as agreed between the buyer and seller.</p>
                </div>
                
                <p>When an invoice includes a due date, that exact date should be entered in the corresponding field or textbox in the system. The due date helps in maintaining proper payment schedules and avoiding delays or penalties.</p>
                
                <h3 id="due-date-terms">Common Terms Used</h3>
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>Term</th>
                                <th>Description</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>Due Date</td>
                                <td>Standard term for payment deadline</td>
                            </tr>
                            <tr>
                                <td>List Due Date</td>
                                <td>Due date specified in the list/document</td>
                            </tr>
                            <tr>
                                <td>Payable on or Before</td>
                                <td>Payment should be made by this date</td>
                            </tr>
                            <tr>
                                <td>Please Remit the Amount by</td>
                                <td>Polite request for payment by specific date</td>
                            </tr>
                            <tr>
                                <td>Due By</td>
                                <td>Alternative phrasing for due date</td>
                            </tr>
                            <tr>
                                <td>Pay By</td>
                                <td>Direct instruction for payment deadline</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                
                <h3 id="due-date-calculation">Due Date Calculation Methods</h3>
                <div class="rules-grid">
                    <div class="rule-card">
                        <h4><i class="fas fa-calculator"></i> Net 30</h4>
                        <p>Payment due 30 days from invoice date</p>
                        <p>Example: Invoice date July 1 â†’ Due date July 31</p>
                    </div>
                    <div class="rule-card">
                        <h4><i class="fas fa-calculator"></i> Net 15</h4>
                        <p>Payment due 15 days from invoice date</p>
                        <p>Example: Invoice date July 1 â†’ Due date July 16</p>
                    </div>
                    <div class="rule-card">
                        <h4><i class="fas fa-calculator"></i> Net 10</h4>
                        <p>Payment due 10 days from invoice date</p>
                        <p>Example: Invoice date July 1 â†’ Due date July 11</p>
                    </div>
                    <div class="rule-card">
                        <h4><i class="fas fa-calculator"></i> Due on Receipt</h4>
                        <p>Payment due immediately upon receipt</p>
                        <p>Example: Use invoice date as due date</p>
                    </div>
                </div>
                
                <div class="definition-box" id="due-date-exceptions" style="border-left-color: var(--warning);">
                    <h3><i class="fas fa-exclamation-circle"></i> Important Note</h3>
                    <p>If the invoice has a Due Date mentioned, it must be entered compulsorily. If not mentioned, leave the field blank or use default system settings.</p>
                </div>
                
                <h3 id="due-date-exceptions">Special Cases and Exceptions</h3>
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>Scenario</th>
                                <th>Action</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>Multiple due dates on same invoice</td>
                                <td>Use the earliest due date mentioned</td>
                            </tr>
                            <tr>
                                <td>Contradictory due dates</td>
                                <td>Verify with vendor or use the most recent date</td>
                            </tr>
                            <tr>
                                <td>Due date in foreign format</td>
                                <td>Convert to MM/DD/YYYY format</td>
                            </tr>
                            <tr>
                                <td>Weekend/holiday due date</td>
                                <td>Use the date as written (do not adjust)</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </section>
            
            <!-- Invoice Number & Date Section -->
            <section id="invoice-number" class="section">
                <div class="section-header">
                    <div class="section-icon">
                        <i class="fas fa-hashtag"></i>
                    </div>
                    <h2 class="section-title">Invoice Number & Invoice Date</h2>
                </div>
                
                <div class="definition-box" id="invoice-codes">
                    <h3><i class="fas fa-info-circle"></i> Definition</h3>
                    <p>The Invoice Number and Invoice Date are unique identifiers used to record and track invoice details for billing and payment purposes. They are essential for reference, reconciliation, and audit trails.</p>
                </div>
                
                <h3 id="invoice-codes">In Case of an Invoice</h3>
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>Code</th>
                                <th>Meaning</th>
                                <th>Description</th>
                                <th>When to Use</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>I</strong></td>
                                <td>Invoice Number / Date</td>
                                <td>Unique invoice reference number and date issued by the seller.</td>
                                <td>Standard invoice documents</td>
                            </tr>
                            <tr>
                                <td><strong>S</strong></td>
                                <td>Shipping Number / Date</td>
                                <td>Shipment tracking number and date of dispatch.</td>
                                <td>When invoice references shipment</td>
                            </tr>
                            <tr>
                                <td><strong>D</strong></td>
                                <td>Delivery Number / Date</td>
                                <td>Delivery reference number and date when goods were delivered.</td>
                                <td>Delivery receipts or notes</td>
                            </tr>
                            <tr>
                                <td><strong>O</strong></td>
                                <td>Order Number / Date</td>
                                <td>Purchase order reference number and date issued by the buyer.</td>
                                <td>When PO number is provided</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                
                <p><em>(If none of the above invoice details are given, then use the following numbers.)</em></p>
                
                <h3 id="receipt-codes">In Case of a Receipt</h3>
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>Code</th>
                                <th>Meaning</th>
                                <th>Description</th>
                                <th>When to Use</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td><strong>A</strong></td>
                                <td>Auth / Authorization Code</td>
                                <td>Code used to verify transaction approval.</td>
                                <td>Credit card receipts</td>
                            </tr>
                            <tr>
                                <td><strong>A</strong></td>
                                <td>Approval Number</td>
                                <td>Confirmation number for the approved transaction.</td>
                                <td>Approved expense reports</td>
                            </tr>
                            <tr>
                                <td><strong>R</strong></td>
                                <td>Reference Number</td>
                                <td>Reference ID used to link the payment or transaction.</td>
                                <td>Bank transfers, wire payments</td>
                            </tr>
                            <tr>
                                <td><strong>T</strong></td>
                                <td>Transaction Number / ID</td>
                                <td>Unique identification number assigned to the payment transaction.</td>
                                <td>Electronic payments</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                
                <h3 id="number-format">Invoice Number Format Rules</h3>
                <div class="rules-grid">
                    <div class="rule-card">
                        <h4><i class="fas fa-ban"></i> No Spaces</h4>
                        <p>Remove all spaces from invoice numbers</p>
                        <p>Example: "INV 123 456" â†’ "INV123456"</p>
                    </div>
                    <div class="rule-card">
                        <h4><i class="fas fa-sync-alt"></i> Case Sensitivity</h4>
                        <p>Preserve original case (usually uppercase)</p>
                        <p>Example: "Inv-789" stays as "Inv-789"</p>
                    </div>
                    <div class="rule-card">
                        <h4><i class="fas fa-filter"></i> Special Characters</h4>
                        <p>Include hyphens and slashes as shown</p>
                        <p>Example: "INV-2023/001" remains unchanged</p>
                    </div>
                    <div class="rule-card">
                        <h4><i class="fas fa-check"></i> Validation</h4>
                        <p>Verify against purchase order if available</p>
                        <p>Ensure it matches vendor records</p>
                    </div>
                </div>
                
                <h3 id="date-rules">Date Format Rules</h3>
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>Date Format</th>
                                <th>Example</th>
                                <th>How to Enter</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>MM/DD/YYYY</td>
                                <td>07/15/2023</td>
                                <td>Enter as shown</td>
                            </tr>
                            <tr>
                                <td>DD/MM/YYYY</td>
                                <td>15/07/2023</td>
                                <td>Convert to MM/DD/YYYY</td>
                            </tr>
                            <tr>
                                <td>YYYY-MM-DD</td>
                                <td>2023-07-15</td>
                                <td>Convert to MM/DD/YYYY</td>
                            </tr>
                            <tr>
                                <td>Written Date</td>
                                <td>July 15, 2023</td>
                                <td>Convert to 07/15/2023</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                
                <div class="definition-box" style="border-left-color: var(--warning);">
                    <h3><i class="fas fa-lightbulb"></i> Note</h3>
                    <p>Do not include spaces in the Invoice Number. Always verify the date format matches your system requirements (typically MM/DD/YYYY).</p>
                </div>
            </section>
            
            <!-- Liquor Invoice Split Section -->
            <section id="liquor-split" class="section">
                <div class="section-header">
                    <div class="section-icon">
                        <i class="fas fa-wine-bottle"></i>
                    </div>
                    <h2 class="section-title">Liquor Invoice â€“ Split</h2>
                </div>
                
                <div class="definition-box" id="split-definition">
                    <h3><i class="fas fa-info-circle"></i> Definition</h3>
                    <p>A Liquor Invoice (Split) occurs when the bottle quantity in an invoice shows that a full case has been broken or divided into smaller parts. This typically happens when a restaurant or bar purchases partial cases of liquor bottles.</p>
                </div>
                
                <p>Whenever this happens, it must be marked as <strong>"SPLIT"</strong> in the system to ensure proper inventory tracking and pricing calculations.</p>
                
                <h3 id="split-rules">ðŸ“˜ SPLIT Rules</h3>
                <div class="rules-grid">
                    <div class="rule-card">
                        <h4>Rule 1</h4>
                        <p>If Bottle Quantity (BT Qty) is mentioned in the invoice â†’ it is a SPLIT case.</p>
                        <p>Example: BT Qty: 6 bottles</p>
                    </div>
                    <div class="rule-card">
                        <h4>Rule 2</h4>
                        <p>If Pack > 1 and Bottle Quantity is shown â†’ mark as SPLIT.</p>
                        <p>Example: Pack: 12, BT Qty: 6</p>
                    </div>
                    <div class="rule-card">
                        <h4>Rule 3</h4>
                        <p>If Pack = 1 and BT Qty = 1 â†’ NOT SPLIT.</p>
                        <p>Example: Single bottle purchase</p>
                    </div>
                    <div class="rule-card">
                        <h4>Rule 4</h4>
                        <p>Always check both Pack and Quantity fields before marking as SPLIT.</p>
                        <p>Example: Compare Pack size vs Bottle Quantity</p>
                    </div>
                </div>
                
                <h3 id="split-examples">ðŸ’¡ Examples</h3>
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>Invoice Entry</th>
                                <th>Pack</th>
                                <th>BT Qty</th>
                                <th>Interpretation</th>
                                <th>SPLIT</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>1 CS Qty</td>
                                <td>12</td>
                                <td>-</td>
                                <td>Full case â€“ not split</td>
                                <td><span class="status status-no">No</span></td>
                            </tr>
                            <tr>
                                <td>1/CS Qty</td>
                                <td>12</td>
                                <td>-</td>
                                <td>Full case â€“ not split</td>
                                <td><span class="status status-no">No</span></td>
                            </tr>
                            <tr>
                                <td>/1 BT Qty</td>
                                <td>1</td>
                                <td>1</td>
                                <td>Single bottle â€“ not split</td>
                                <td><span class="status status-no">No</span></td>
                            </tr>
                            <tr>
                                <td>Pack = 6, BT Qty = 2</td>
                                <td>6</td>
                                <td>2</td>
                                <td>Case broken â€“ split</td>
                                <td><span class="status status-yes">Yes</span></td>
                            </tr>
                            <tr>
                                <td>12 bottles (no pack)</td>
                                <td>12</td>
                                <td>12</td>
                                <td>Full case equivalent â€“ not split</td>
                                <td><span class="status status-no">No</span></td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                
                <div class="definition-box" id="split-exceptions" style="border-left-color: var(--warning);">
                    <h3><i class="fas fa-lightbulb"></i> Note</h3>
                    <p>Always mark "SPLIT" when bottles are mentioned separately and Pack is greater than 1. This ensures accurate quantity tracking and proper inventory control. If unsure, check with supervisor or refer to vendor guidelines.</p>
                </div>
                
                <h3 id="bottle-calculation">ðŸŸ¦ Simple Rule (Funda)</h3>
                <div class="rules-grid">
                    <div class="rule-card">
                        <h4>Rule 1</h4>
                        <p>Whenever Bottle Quantity (BT Qty) is mentioned in the invoice and Pack is more than 1, âž¡ï¸ It will be considered as SPLIT.</p>
                        <p>Example: Pack: 12, BT Qty: 6 â†’ SPLIT</p>
                    </div>
                    <div class="rule-card">
                        <h4>Rule 2</h4>
                        <p>Whenever Bottle Quantity (BT Qty) is mentioned in the invoice and Pack = 1, âž¡ï¸ It will NOT be considered as SPLIT.</p>
                        <p>Example: Pack: 1, BT Qty: 1 â†’ NOT SPLIT</p>
                    </div>
                    <div class="rule-card">
                        <h4>Rule 3</h4>
                        <p>If only case quantity is mentioned without bottle quantity, âž¡ï¸ It is NOT SPLIT.</p>
                        <p>Example: 1 CS â†’ NOT SPLIT</p>
                    </div>
                </div>
                
                <h3>Common Scenarios & Solutions</h3>
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>Scenario</th>
                                <th>What to Look For</th>
                                <th>Action</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>Mixed case and bottle quantities</td>
                                <td>Some items as cases, some as bottles</td>
                                <td>Mark only bottle items with Pack>1 as SPLIT</td>
                            </tr>
                            <tr>
                                <td>Vendor uses different terminology</td>
                                <td>"BTL" instead of "BT", "EA" instead of "Bottle"</td>
                                <td>Apply same rules regardless of terminology</td>
                            </tr>
                            <tr>
                                <td>Fractional cases</td>
                                <td>0.5 case or similar fractions</td>
                                <td>Calculate bottle equivalent and mark as SPLIT</td>
                            </tr>
                            <tr>
                                <td>No pack size mentioned</td>
                                <td>Only bottle quantity shown</td>
                                <td>Check standard pack size for that product</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </section>
            
            <!-- Standard / Food Invoice - CATCH Section -->
            <section id="standard-catch" class="section">
                <div class="section-header">
                    <div class="section-icon">
                        <i class="fas fa-balance-scale"></i>
                    </div>
                    <h2 class="section-title">Standard / Food Invoice â€“ CATCH</h2>
                </div>
                
                <div class="definition-box" id="catch-definition">
                    <h3><i class="fas fa-info-circle"></i> Definition</h3>
                    <p>A CATCH item refers to any product where the weight is used as the quantity instead of the number of pieces or units. Such items are sold or billed by weight, typically for fresh produce, meat, seafood, and other perishable goods.</p>
                </div>
                
                <h3 id="catch-rules">ðŸ“˜ CATCH Rules</h3>
                <p>Mark a product as CATCH when weight is taken as the quantity. âœ…</p>
                <p>Before marking as CATCH, ensure the following:</p>
                
                <div class="rules-grid">
                    <div class="rule-card">
                        <h4>UOM = LB (Pound)</h4>
                        <p>Unit of measurement must be pounds</p>
                        <p>Check for: LB, LBS, Pound, #</p>
                    </div>
                    <div class="rule-card">
                        <h4>Pack = 1</h4>
                        <p>Pack size must be 1</p>
                        <p>Not applicable for weight-based items</p>
                    </div>
                    <div class="rule-card">
                        <h4>Size = 1</h4>
                        <p>Size must be 1</p>
                        <p>Standard for weight measurements</p>
                    </div>
                    <div class="rule-card">
                        <h4>Unit = LB</h4>
                        <p>Unit must be pounds</p>
                        <p>Matches UOM field</p>
                    </div>
                    <div class="rule-card">
                        <h4>CATCH column is ticked/selected</h4>
                        <p>CATCH option must be selected</p>
                        <p>System checkbox must be checked</p>
                    </div>
                </div>
                
                <h3 id="catch-examples">ðŸ’¡ Examples</h3>
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>Description</th>
                                <th>UOM</th>
                                <th>Pack</th>
                                <th>Size</th>
                                <th>Unit</th>
                                <th>CATCH</th>
                                <th>Notes</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>Chicken Wings</td>
                                <td>LB</td>
                                <td>1</td>
                                <td>1</td>
                                <td>LB</td>
                                <td><span class="status status-yes">Yes</span></td>
                                <td>Sold by weight</td>
                            </tr>
                            <tr>
                                <td>Ground Beef</td>
                                <td>LB</td>
                                <td>1</td>
                                <td>1</td>
                                <td>LB</td>
                                <td><span class="status status-yes">Yes</span></td>
                                <td>Weight-based pricing</td>
                            </tr>
                            <tr>
                                <td>Apples (Bag)</td>
                                <td>EA</td>
                                <td>1</td>
                                <td>1</td>
                                <td>EA</td>
                                <td><span class="status status-no">No</span></td>
                                <td>Sold by each, not weight</td>
                            </tr>
                            <tr>
                                <td>Salmon Fillet</td>
                                <td>LB</td>
                                <td>1</td>
                                <td>1</td>
                                <td>LB</td>
                                <td><span class="status status-yes">Yes</span></td>
                                <td>Fresh fish by weight</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                
                <h3 id="catch-validation">How to Validate CATCH Items</h3>
                <div class="step-indicator">
                    <div class="step">1</div>
                    <div class="step-line active"></div>
                    <div class="step-content">
                        <h4>Check UOM Field</h4>
                        <p>Verify Unit of Measurement is LB (pounds)</p>
                    </div>
                </div>
                
                <div class="step-indicator">
                    <div class="step">2</div>
                    <div class="step-line active"></div>
                    <div class="step-content">
                        <h4>Review Product Description</h4>
                        <p>Look for weight indicators like "per lb", "by weight", or decimal quantities</p>
                    </div>
                </div>
                
                <div class="step-indicator">
                    <div class="step">3</div>
                    <div class="step-line active"></div>
                    <div class="step-content">
                        <h4>Check Quantity Format</h4>
                        <p>Decimal quantities (2.5, 0.75) usually indicate weight-based items</p>
                    </div>
                </div>
                
                <div class="step-indicator">
                    <div class="step">4</div>
                    <div class="step-line"></div>
                    <div class="step-content">
                        <h4>Apply CATCH Marking</h4>
                        <p>Select CATCH checkbox in system if all conditions met</p>
                    </div>
                </div>
                
                <div class="definition-box" style="border-left-color: var(--success);">
                    <h3>ðŸŸ© Note (Simple Rule / Funda)</h3>
                    <p>ðŸ‘‰ If UOM (Unit of Measurement) is automatically shown as LB in the system, and the invoice also mentions LB, then it must be marked as CATCH. âœ…</p>
                    <p>ðŸ‘‰ If product is typically sold by weight (meat, produce, seafood) and has decimal quantity, mark as CATCH.</p>
                </div>
                
                <h3 id="uom-conversion">UOM Conversion Reference</h3>
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>UOM</th>
                                <th>Full Form</th>
                                <th>CATCH?</th>
                                <th>Common Products</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>LB</td>
                                <td>Pound</td>
                                <td><span class="status status-yes">Yes</span></td>
                                <td>Meat, produce, seafood</td>
                            </tr>
                            <tr>
                                <td>OZ</td>
                                <td>Ounce</td>
                                <td><span class="status status-yes">Yes</span></td>
                                <td>Specialty items, spices</td>
                            </tr>
                            <tr>
                                <td>EA</td>
                                <td>Each</td>
                                <td><span class="status status-no">No</span></td>
                                <td>Packaged goods, cans</td>
                            </tr>
                            <tr>
                                <td>CS</td>
                                <td>Case</td>
                                <td><span class="status status-no">No</span></td>
                                <td>Beverages, packaged items</td>
                            </tr>
                            <tr>
                                <td>PK</td>
                                <td>Pack</td>
                                <td><span class="status status-no">No</span></td>
                                <td>Multi-pack items</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </section>
            
            <!-- Freight Charge Section -->
            <section id="freight-charge" class="section">
                <div class="section-header">
                    <div class="section-icon">
                        <i class="fas fa-truck"></i>
                    </div>
                    <h2 class="section-title">Freight Charge & Other Charge</h2>
                </div>
                
                <div class="definition-box" id="freight-definition">
                    <h3>ðŸš› Freight Charge</h3>
                    <p>Freight Charges include all costs related to moving or transporting goods from one place to another. These are charges applied for the delivery or shipment of materials and are typically calculated based on weight, distance, or service level.</p>
                </div>
                
                <h3 id="charge-examples">Examples of Freight Charges</h3>
                <div class="rules-grid">
                    <div class="rule-card">
                        <h4>Shipping Charge</h4>
                        <p>Cost for shipping items from warehouse to destination</p>
                        <p>Often a flat fee or weight-based</p>
                    </div>
                    <div class="rule-card">
                        <h4>Delivery Charge</h4>
                        <p>Cost for delivering items to final location</p>
                        <p>May include unloading services</p>
                    </div>
                    <div class="rule-card">
                        <h4>Transportation Charge</h4>
                        <p>General transportation costs</p>
                        <p>Includes fuel, vehicle, driver costs</p>
                    </div>
                    <div class="rule-card">
                        <h4>Handling Charge</h4>
                        <p>Cost for handling items during transport</p>
                        <p>Loading/unloading, special handling</p>
                    </div>
                    <div class="rule-card">
                        <h4>Fuel Charge</h4>
                        <p>Additional charge for fuel costs</p>
                        <p>Variable based on fuel prices</p>
                    </div>
                </div>
                
                <div class="definition-box" id="other-charge-definition">
                    <h3>ðŸ’° Other Charge</h3>
                    <p>Other Charges include all charges that are not Freight Charges or Taxes. These are additional service-related or miscellaneous costs that may apply to the transaction.</p>
                </div>
                
                <h3 id="charge-examples">Examples of Other Charges</h3>
                <div class="rules-grid">
                    <div class="rule-card">
                        <h4>Miscellaneous Charge</h4>
                        <p>Various additional charges not specified</p>
                        <p>Use for unspecified small fees</p>
                    </div>
                    <div class="rule-card">
                        <h4>Tip</h4>
                        <p>Gratuity payment for delivery personnel</p>
                        <p>Usually optional but sometimes included</p>
                    </div>
                    <div class="rule-card">
                        <h4>Fee</h4>
                        <p>Service fee for special services</p>
                        <p>Administrative or processing fees</p>
                    </div>
                    <div class="rule-card">
                        <h4>City Surcharge</h4>
                        <p>Additional city-specific charge</p>
                        <p>For deliveries in certain municipalities</p>
                    </div>
                    <div class="rule-card">
                        <h4>Service Charge</h4>
                        <p>Charge for additional services</p>
                        <p>Rush orders, special handling</p>
                    </div>
                </div>
                
                <h3 id="practical-box">âš™ï¸ How to Handle Charges in Invoice</h3>
                <div class="rules-grid">
                    <div class="rule-card">
                        <h4>ðŸŸ© Rule 1 â€“ When Item Code is Available</h4>
                        <p>If the invoice contains a Charge and the Item Code for that charge is available in the invoice, âž¡ï¸ Take it in the Line Item section.</p>
                        <p>Create separate line with the charge item code</p>
                    </div>
                    <div class="rule-card">
                        <h4>ðŸŸ¨ Rule 2 â€“ When Item Code is NOT Available</h4>
                        <p>If the invoice contains a Charge but the Item Code is not provided, âž¡ï¸ Enter it in the Practical Box (Remarks / Additional Field).</p>
                        <p>Note: Include amount and description</p>
                    </div>
                    <div class="rule-card">
                        <h4>ðŸŸ¦ Rule 3 â€“ Multiple Charges</h4>
                        <p>If multiple charges with no item codes, âž¡ï¸ Combine in Practical Box with clear descriptions.</p>
                        <p>Separate each charge with semicolons</p>
                    </div>
                </div>
                
                <h3>ðŸ“˜ Examples</h3>
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>Description</th>
                                <th>Item Code</th>
                                <th>Charge Type</th>
                                <th>Action</th>
                                <th>Notes</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>Freight Charge</td>
                                <td>FRG123</td>
                                <td>Freight</td>
                                <td>Take in Line</td>
                                <td>Use provided item code</td>
                            </tr>
                            <tr>
                                <td>Service Fee</td>
                                <td>â€”</td>
                                <td>Other</td>
                                <td>Enter in Practical Box</td>
                                <td>No item code provided</td>
                            </tr>
                            <tr>
                                <td>Fuel Surcharge</td>
                                <td>FSC456</td>
                                <td>Freight</td>
                                <td>Take in Line</td>
                                <td>Item code available</td>
                            </tr>
                            <tr>
                                <td>Delivery Tip</td>
                                <td>â€”</td>
                                <td>Other</td>
                                <td>Enter in Practical Box</td>
                                <td>Optional charge, no code</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                
                <h3 id="charge-processing">Processing Steps for Charges</h3>
                <div class="step-indicator">
                    <div class="step">1</div>
                    <div class="step-line active"></div>
                    <div class="step-content">
                        <h4>Identify Charge Type</h4>
                        <p>Determine if it's Freight, Other Charge, or Tax</p>
                    </div>
                </div>
                
                <div class="step-indicator">
                    <div class="step">2</div>
                    <div class="step-line active"></div>
                    <div class="step-content">
                        <h4>Check for Item Code</h4>
                        <p>Look for item code in invoice or system database</p>
                    </div>
                </div>
                
                <div class="step-indicator">
                    <div class="step">3</div>
                    <div class="step-line active"></div>
                    <div class="step-content">
                        <h4>Apply Appropriate Method</h4>
                        <p>Item code available â†’ Line Item<br>No item code â†’ Practical Box</p>
                    </div>
                </div>
                
                <div class="step-indicator">
                    <div class="step">4</div>
                    <div class="step-line"></div>
                    <div class="step-content">
                        <h4>Verify Amount</h4>
                        <p>Ensure charge amount matches invoice total</p>
                    </div>
                </div>
                
                <div class="definition-box" style="border-left-color: var(--success);">
                    <h3>ðŸŸ¦ Simple Rule (Funda)</h3>
                    <p>ðŸ”¹ If charge has Item Code â†’ Line Item<br>ðŸ”¹ If charge has no Item Code â†’ Practical Box<br>ðŸ”¹ Always include description and amount for Practical Box entries</p>
                </div>
                
                <h3>Common Mistakes to Avoid</h3>
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>Mistake</th>
                                <th>Correct Approach</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>Adding charges without item codes to line items</td>
                                <td>Use Practical Box for charges without codes</td>
                            </tr>
                            <tr>
                                <td>Combining multiple charges into one Practical Box entry without separation</td>
                                <td>List each charge separately in Practical Box</td>
                            </tr>
                            <tr>
                                <td>Missing freight charges in total calculation</td>
                                <td>Ensure all charges are included in invoice total</td>
                            </tr>
                            <tr>
                                <td>Confusing taxes with other charges</td>
                                <td>Taxes should be handled separately in tax section</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </section>
            
            <!-- Deposit Section -->
            <section id="deposit" class="section">
                <div class="section-header">
                    <div class="section-icon">
                        <i class="fas fa-money-bill-wave"></i>
                    </div>
                    <h2 class="section-title">Liquor Invoice â€“ Deposit</h2>
                </div>
                
                <div class="definition-box" id="deposit-categories">
                    <h3>âš™ï¸ DEPOSIT Categories</h3>
                    <p>We create a deposit line in the following three cases. Deposits are refundable amounts paid for returnable containers like kegs, bottles, or crates.</p>
                </div>
                
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>No.</th>
                                <th>Deposit Type</th>
                                <th>Description / When to Apply</th>
                                <th>Amount Pattern</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>1ï¸âƒ£</td>
                                <td>KEG Deposit</td>
                                <td>When a whole number amount is mentioned (e.g., 10, 30, 50). Standard keg deposit for beer kegs.</td>
                                <td>Whole numbers: 10, 20, 30, 50</td>
                            </tr>
                            <tr>
                                <td>2ï¸âƒ£</td>
                                <td>Deposit on above item</td>
                                <td>When the line specifically mentions "Deposit on" an item listed above it, usually with a decimal amount like 1.2, 1.3, 1.5, etc. Typically for bottle deposits.</td>
                                <td>Decimals: 1.2, 2.4, 3.6</td>
                            </tr>
                            <tr>
                                <td>3ï¸âƒ£</td>
                                <td>KEG Return</td>
                                <td>When the line indicates return of kegs, showing a negative or refund amount. This is a credit for returning empty kegs.</td>
                                <td>Negative values: -10, -30, -50</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                
                <h3 id="keg-deposit">LIQUOR INVOICE â€“ KEG DEPOSIT</h3>
                <div class="definition-box">
                    <h3>ðŸ“˜ Definition</h3>
                    <p>A KEG DEPOSIT refers to the deposit amount charged for returnable kegs in liquor invoices. Whenever the deposit amount appears as a whole number (like 10, 30, 50, etc.), it must be treated as a KEG DEPOSIT item. This deposit is refundable when the empty keg is returned.</p>
                </div>
                
                <h3>âš™ï¸ KEG DEPOSIT Rules</h3>
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>Check Point</th>
                                <th>Instruction</th>
                                <th>Example</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>Amount Type</td>
                                <td>Must be a whole number (e.g. 10, 30, 50)</td>
                                <td>30.00 (not 30.50)</td>
                            </tr>
                            <tr>
                                <td>Code</td>
                                <td>XCKD-101</td>
                                <td>Always use this code</td>
                            </tr>
                            <tr>
                                <td>Description</td>
                                <td>KEG Deposit</td>
                                <td>Standard description</td>
                            </tr>
                            <tr>
                                <td>Quantity</td>
                                <td>Same as the related product quantity</td>
                                <td>If 2 kegs, quantity = 2</td>
                            </tr>
                            <tr>
                                <td>Category</td>
                                <td>Deposit / Returnable Container</td>
                                <td>System category</td>
                            </tr>
                            <tr>
                                <td>When to Apply</td>
                                <td>When deposit appears as a fixed round number in the liquor invoice</td>
                                <td>Amount: 30.00</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                
                <h3 id="deposit-examples">ðŸ’¡ Example Scenarios - KEG DEPOSIT</h3>
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>Product Name</th>
                                <th>Deposit Amount</th>
                                <th>Action</th>
                                <th>Code</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>Bud Light Keg</td>
                                <td>30.00</td>
                                <td><span class="status status-yes">Mark as KEG Deposit</span></td>
                                <td>XCKD-101</td>
                            </tr>
                            <tr>
                                <td>Miller Lite Keg</td>
                                <td>10.00</td>
                                <td><span class="status status-yes">Mark as KEG Deposit</span></td>
                                <td>XCKD-101</td>
                            </tr>
                            <tr>
                                <td>Wine Bottle</td>
                                <td>12.75</td>
                                <td><span class="status status-no">Not a KEG Deposit</span></td>
                                <td>â€”</td>
                            </tr>
                            <tr>
                                <td>Whiskey Crate</td>
                                <td>50.00</td>
                                <td><span class="status status-yes">Mark as KEG Deposit</span></td>
                                <td>XCKD-101</td>
                            </tr>
                            <tr>
                                <td>Beer Keg (Half Barrel)</td>
                                <td>30.00</td>
                                <td><span class="status status-yes">Mark as KEG Deposit</span></td>
                                <td>XCKD-101</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                
                <h3 id="deposit-on-item">LIQUOR INVOICE â€“ DEPOSIT ON ABOVE ITEM</h3>
                <div class="definition-box">
                    <h3>ðŸ“˜ Definition</h3>
                    <p>A Deposit on above item refers to a deposit charge applied on the item listed just above it in the liquor invoice. This usually appears as a decimal amount such as 1.2, 2.4, 3.6, etc., and is typically for bottle or can deposits. The deposit is refundable when containers are returned.</p>
                </div>
                
                <h3>âš™ï¸ Rules</h3>
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>Field</th>
                                <th>Entry / Rule</th>
                                <th>Notes</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>Code</td>
                                <td>XCD-IOI</td>
                                <td>Fixed code for this deposit type</td>
                            </tr>
                            <tr>
                                <td>Description</td>
                                <td>Deposit on above item</td>
                                <td>Standard description</td>
                            </tr>
                            <tr>
                                <td>Quantity</td>
                                <td>Same as the related product quantity</td>
                                <td>Matches the item above</td>
                            </tr>
                            <tr>
                                <td>When to Apply</td>
                                <td>When the deposit value appears in decimals (e.g., 1.2, 2.4, 3.6)</td>
                                <td>Look for decimal amounts</td>
                            </tr>
                            <tr>
                                <td>Position</td>
                                <td>Immediately follows the related product</td>
                                <td>Usually next line in invoice</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                
                <h3>ðŸ’¡ Example Scenarios - DEPOSIT ON ABOVE ITEM</h3>
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>Product Name</th>
                                <th>Deposit Amount</th>
                                <th>Action</th>
                                <th>Code</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>Beer Bottle</td>
                                <td>1.20</td>
                                <td><span class="status status-yes">Mark as Deposit on above item</span></td>
                                <td>XCD-IOI</td>
                            </tr>
                            <tr>
                                <td>Wine Case</td>
                                <td>2.40</td>
                                <td><span class="status status-yes">Mark as Deposit on above item</span></td>
                                <td>XCD-IOI</td>
                            </tr>
                            <tr>
                                <td>Cider Can</td>
                                <td>3.60</td>
                                <td><span class="status status-yes">Mark as Deposit on above item</span></td>
                                <td>XCD-IOI</td>
                            </tr>
                            <tr>
                                <td>KEG Deposit</td>
                                <td>30.00</td>
                                <td><span class="status status-no">Not "Deposit on above item"</span></td>
                                <td>XCKD-101</td>
                            </tr>
                            <tr>
                                <td>Soda Bottle</td>
                                <td>0.05</td>
                                <td><span class="status status-yes">Mark as Deposit on above item</span></td>
                                <td>XCD-IOI</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                
                <h3 id="keg-return">LIQUOR INVOICE â€“ KEG RETURN</h3>
                <div class="definition-box">
                    <h3>ðŸ“˜ Definition</h3>
                    <p>A KEG RETURN refers to the return of kegs for which a deposit was previously charged. This line represents a refund or reversal of the original keg deposit and is always shown as a negative value in the invoice. It indicates that empty kegs were returned to the supplier.</p>
                </div>
                
                <h3>âš™ï¸ Rules</h3>
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>Field</th>
                                <th>Entry / Rule</th>
                                <th>Notes</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>Code</td>
                                <td>XCKR-IOI</td>
                                <td>Fixed code for keg returns</td>
                            </tr>
                            <tr>
                                <td>Description</td>
                                <td>KEG Return</td>
                                <td>Standard description</td>
                            </tr>
                            <tr>
                                <td>Quantity</td>
                                <td>Same as the related product quantity</td>
                                <td>Number of kegs returned</td>
                            </tr>
                            <tr>
                                <td>Amount</td>
                                <td>Negative value</td>
                                <td>Always shows as negative</td>
                            </tr>
                            <tr>
                                <td>When to Apply</td>
                                <td>When the line shows a return amount (negative value) related to kegs</td>
                                <td>Look for negative amounts</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                
                <h3>ðŸ’¡ Example Scenarios - KEG RETURN</h3>
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>Product Name</th>
                                <th>Return Amount</th>
                                <th>Action</th>
                                <th>Code</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>Beer Keg Return</td>
                                <td>-10.00</td>
                                <td><span class="status status-yes">Mark as KEG Return</span></td>
                                <td>XCKR-IOI</td>
                            </tr>
                            <tr>
                                <td>Cider Keg Return</td>
                                <td>-30.00</td>
                                <td><span class="status status-yes">Mark as KEG Return</span></td>
                                <td>XCKR-IOI</td>
                            </tr>
                            <tr>
                                <td>Wine Deposit</td>
                                <td>+2.40</td>
                                <td><span class="status status-no">Not a KEG Return</span></td>
                                <td>XCD-IOI</td>
                            </tr>
                            <tr>
                                <td>Empty Keg Return</td>
                                <td>-50.00</td>
                                <td><span class="status status-yes">Mark as KEG Return</span></td>
                                <td>XCKR-IOI</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                
                <h3>Summary Table - Deposit Types</h3>
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>Deposit Type</th>
                                <th>Code</th>
                                <th>Amount Pattern</th>
                                <th>Description</th>
                                <th>Sign</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>KEG Deposit</td>
                                <td>XCKD-101</td>
                                <td>Whole numbers: 10, 30, 50</td>
                                <td>KEG Deposit</td>
                                <td>Positive (+)</td>
                            </tr>
                            <tr>
                                <td>Deposit on above item</td>
                                <td>XCD-IOI</td>
                                <td>Decimals: 1.2, 2.4, 3.6</td>
                                <td>Deposit on above item</td>
                                <td>Positive (+)</td>
                            </tr>
                            <tr>
                                <td>KEG Return</td>
                                <td>XCKR-IOI</td>
                                <td>Negative: -10, -30, -50</td>
                                <td>KEG Return</td>
                                <td>Negative (-)</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                
                <div class="important-note">
                    <h4><i class="fas fa-exclamation-circle"></i> Important Notes</h4>
                    <ul>
                        <li>Always match deposit quantity with the related product quantity</li>
                        <li>Verify deposit amounts with vendor price lists when in doubt</li>
                        <li>KEG Returns should always be negative amounts</li>
                        <li>Some states have specific deposit requirements (CRV in California)</li>
                        <li>Deposits are refundable - track them separately from product costs</li>
                    </ul>
                </div>
            </section>
            
            <!-- Discount Section -->
            <section id="discount" class="section">
                <div class="section-header">
                    <div class="section-icon">
                        <i class="fas fa-percentage"></i>
                    </div>
                    <h2 class="section-title">100% Discount</h2>
                </div>
                
                <div class="definition-box" id="discount-definition">
                    <h3>ðŸ“˜ Definition</h3>
                    <p>A 100% Discount is applied when the product is billed at no charge or when the unit price and discount values are the same, meaning the customer is not being charged for the item. This typically occurs for samples, promotional items, or replacement goods.</p>
                </div>
                
                <h3 id="discount-conditions">âš™ï¸ When to Apply</h3>
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>Condition</th>
                                <th>Description</th>
                                <th>Example</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>ðŸŸ¦ No Charge</td>
                                <td>The words "NO CHARGE" are written in the product line.</td>
                                <td>"NO CHARGE â€“ Sample Wine Bottle"</td>
                            </tr>
                            <tr>
                                <td>ðŸŸ© Free Quantity</td>
                                <td>The product quantity is shown under the FREE column.</td>
                                <td>Quantity in "Free" column instead of "Quantity"</td>
                            </tr>
                            <tr>
                                <td>ðŸŸ¨ Unit Price & Discount</td>
                                <td>The Unit Price and Discount values are equal (making the total amount zero).</td>
                                <td>Unit Price: $10.00, Discount: $10.00</td>
                            </tr>
                            <tr>
                                <td>ðŸŸª Zero Amount</td>
                                <td>The line item shows zero dollar amount.</td>
                                <td>Amount: $0.00</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                
                <h3 id="discount-steps">âœ… How to Create the 100% Discount Line</h3>
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>Step</th>
                                <th>Action</th>
                                <th>Details</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>1ï¸âƒ£</td>
                                <td>Create two separate lines for the discounted product.</td>
                                <td>One positive, one negative line</td>
                            </tr>
                            <tr>
                                <td>2ï¸âƒ£</td>
                                <td>First line: Quantity = 1, Total Amount = +0.01</td>
                                <td>Small positive amount to create line</td>
                            </tr>
                            <tr>
                                <td>3ï¸âƒ£</td>
                                <td>Second line: Quantity = -1, Total Amount = -0.01</td>
                                <td>Matching negative amount to zero out</td>
                            </tr>
                            <tr>
                                <td>4ï¸âƒ£</td>
                                <td>If the 100% discount is for a bottle and the pack is more than one, mark both lines as SPLIT.</td>
                                <td>Follow SPLIT rules from Liquor section</td>
                            </tr>
                            <tr>
                                <td>5ï¸âƒ£</td>
                                <td>Use same item code as the regular product.</td>
                                <td>Don't change the product code</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                
                <h3 id="discount-examples">ðŸ’¡ Example Scenarios</h3>
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>Invoice Line Description</th>
                                <th>Condition</th>
                                <th>Action</th>
                                <th>Lines to Create</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>"NO CHARGE â€“ Sample Wine Bottle"</td>
                                <td>No Charge</td>
                                <td><span class="status status-yes">Create 100% Discount lines</span></td>
                                <td>2 lines: +0.01 and -0.01</td>
                            </tr>
                            <tr>
                                <td>"Beer (Qty under FREE column)"</td>
                                <td>Free Quantity</td>
                                <td><span class="status status-yes">Create 100% Discount lines</span></td>
                                <td>2 lines: +0.01 and -0.01</td>
                            </tr>
                            <tr>
                                <td>"Cider â€“ Unit Price = Discount"</td>
                                <td>Unit Price & Discount</td>
                                <td><span class="status status-yes">Create 100% Discount lines</span></td>
                                <td>2 lines: +0.01 and -0.01</td>
                            </tr>
                            <tr>
                                <td>"Whiskey Bottle Pack of 2"</td>
                                <td>100% Discount + Pack > 1</td>
                                <td><span class="status status-yes">Create SPLIT 100% Discount lines</span></td>
                                <td>2 SPLIT lines: +0.01 and -0.01</td>
                            </tr>
                            <tr>
                                <td>"Replacement Meat - No Charge"</td>
                                <td>No Charge for replacement</td>
                                <td><span class="status status-yes">Create 100% Discount lines</span></td>
                                <td>2 lines: +0.01 and -0.01</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                
                <h3 id="split-discount">Detailed Example: 100% Discount with SPLIT</h3>
                <div class="example-cards">
                    <div class="example-card">
                        <h4><i class="fas fa-wine-bottle"></i> Scenario</h4>
                        <p>Product: Premium Vodka Bottle</p>
                        <p>Pack Size: 6 bottles per case</p>
                        <p>Condition: NO CHARGE (Sample)</p>
                        <p>Action Required: Create 100% discount with SPLIT marking</p>
                    </div>
                    
                    <div class="example-card">
                        <h4><i class="fas fa-list-ol"></i> Line 1</h4>
                        <p>Quantity: 1</p>
                        <p>Amount: +0.01</p>
                        <p>SPLIT: Yes (Pack > 1)</p>
                        <p>Description: Premium Vodka - Sample</p>
                    </div>
                    
                    <div class="example-card">
                        <h4><i class="fas fa-list-ol"></i> Line 2</h4>
                        <p>Quantity: -1</p>
                        <p>Amount: -0.01</p>
                        <p>SPLIT: Yes (Pack > 1)</p>
                        <p>Description: Premium Vodka - Discount</p>
                    </div>
                </div>
                
                <h3>Common Questions & Answers</h3>
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>Question</th>
                                <th>Answer</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>Why create two lines instead of one zero amount line?</td>
                                <td>Some systems require non-zero amounts for tracking. Two lines create net zero while maintaining item record.</td>
                            </tr>
                            <tr>
                                <td>What if multiple free items?</td>
                                <td>Create separate 100% discount lines for each free item.</td>
                            </tr>
                            <tr>
                                <td>Can we use different amounts than 0.01?</td>
                                <td>Yes, but keep it small (0.01 is standard). Must be same amount positive and negative.</td>
                            </tr>
                            <tr>
                                <td>What about partial discounts (50% off)?</td>
                                <td>Partial discounts are handled differently - adjust unit price or use discount field.</td>
                            </tr>
                            <tr>
                                <td>Should we mark promotional items differently?</td>
                                <td>No, all 100% discounts follow the same process regardless of reason.</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                
                <div class="important-note">
                    <h4><i class="fas fa-exclamation-circle"></i> Important Notes</h4>
                    <ul>
                        <li>Always verify if item is truly 100% free (not just low cost)</li>
                        <li>Check for vendor notes explaining the free item reason</li>
                        <li>Ensure net amount is zero after creating both lines</li>
                        <li>Apply SPLIT rules if applicable (Pack > 1 for liquor bottles)</li>
                        <li>Document reason for free item in notes if possible</li>
                    </ul>
                </div>
            </section>
            
            <!-- Credit Memo Section -->
            <section id="credit-memo" class="section">
                <div class="section-header">
                    <div class="section-icon">
                        <i class="fas fa-file-invoice-dollar"></i>
                    </div>
                    <h2 class="section-title">Credit Memo</h2>
                </div>
                
                <div class="definition-box" id="credit-definition">
                    <h3>ðŸ“˜ Definition</h3>
                    <p>A Credit Memo is issued when goods are returned, adjusted, or refunded. When any of the following terms appear on an invoice, the document must be marked as a Credit Memo, and the invoice values should be processed in opposite sign (i.e., credit instead of debit). Credit memos reduce the amount owed to a vendor.</p>
                </div>
                
                <h3 id="credit-keywords">âš™ï¸ When to Mark as CREDIT MEMO</h3>
                <p>Mark the invoice as Credit Memo if you see any of the following terms:</p>
                
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>Keyword / Term</th>
                                <th>Meaning</th>
                                <th>Example</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>Credit Memo / CM</td>
                                <td>Indicates a credit document issued to the customer.</td>
                                <td>"Credit Memo #CM12345"</td>
                            </tr>
                            <tr>
                                <td>Return Memo / RM</td>
                                <td>Used for returned goods.</td>
                                <td>"Return Memo for damaged goods"</td>
                            </tr>
                            <tr>
                                <td>Return Authorization / Return Merchandise</td>
                                <td>Approval for product returns.</td>
                                <td>"RA# 789012 - Return Auth"</td>
                            </tr>
                            <tr>
                                <td>Adjustment Receipt</td>
                                <td>Price or quantity adjustment due to error or return.</td>
                                <td>"Adjustment for overcharge"</td>
                            </tr>
                            <tr>
                                <td>Pickup Receipt / Pickup Request</td>
                                <td>Document for pickup of goods being returned.</td>
                                <td>"Pickup Receipt #PR456"</td>
                            </tr>
                            <tr>
                                <td>Credit Note</td>
                                <td>Alternative term for credit memo.</td>
                                <td>"Credit Note CN-2023-001"</td>
                            </tr>
                            <tr>
                                <td>Refund</td>
                                <td>Money returned to customer.</td>
                                <td>"Refund for cancelled order"</td>
                            </tr>
                            <tr>
                                <td>Debit Memo (from vendor)</td>
                                <td>Vendor's debit memo is our credit.</td>
                                <td>"Debit Memo DM789"</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                
                <h3 id="credit-processing">How to Process Credit Memos</h3>
                <div class="step-indicator">
                    <div class="step">1</div>
                    <div class="step-line active"></div>
                    <div class="step-content">
                        <h4>Identify as Credit Memo</h4>
                        <p>Look for credit memo keywords in document</p>
                    </div>
                </div>
                
                <div class="step-indicator">
                    <div class="step">2</div>
                    <div class="step-line active"></div>
                    <div class="step-content">
                        <h4>Mark Document Type</h4>
                        <p>Select "Credit Memo" in document type field</p>
                    </div>
                </div>
                
                <div class="step-indicator">
                    <div class="step">3</div>
                    <div class="step-line active"></div>
                    <div class="step-content">
                        <h4>Reverse Amount Signs</h4>
                        <p>Enter amounts as opposite of regular invoice</p>
                    </div>
                </div>
                
                <div class="step-indicator">
                    <div class="step">4</div>
                    <div class="step-line"></div>
                    <div class="step-content">
                        <h4>Match to Original Invoice</h4>
                        <p>Reference original invoice if mentioned</p>
                    </div>
                </div>
                
                <h3 id="credit-examples">ðŸ’¡ Example Scenarios</h3>
                <div class="table-container">
                    <table>
                        <thead>
                            <tr>
                                <th>Document Type</th>
                                <th>Total Amount</th>
                                <th>Action</th>
                                <th>System Entry</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td>Credit Memo #CM123</td>
                                <td>$150.00</td>
                                <td><span class="status status-yes">Mark as Credit Memo</span></td>
                                <td>Enter as -$150.00</td>
                            </tr>
                            <tr>
                                <td>Return Memo RM456</td>
                                <td>$75.50</td>
                                <td><span class="status status-yes">Mark as Credit Memo</span></td>
                                <td>Enter as -$75.50</td>
                            </tr>
                            <tr>
                                <td>Regular Invoice</td>
                                <td>$200.00</td>
                                <td><span class="status status-no">Not a Credit Memo</span></td>
                                <td>Enter as +$200.00</td>
                            </tr>
                            <tr>
                                <td>Adjustment Receipt</td>
                                <td>$45.25</td>
                                <td><span class="status status-yes">Mark as Credit Memo</span></td>
                                <td>Enter as -$45.25</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                
                <h3 id="reverse-processing">Reverse Processing Rules</h3>
                <div class="rules-grid">
                    <div class="rule-card">
                        <h4>Amount Sign</h4>
                        <p>Regular invoice: Positive amount<br>Credit memo: Negative amount</p>
                    </div>
                    <div class="rule-card">
                        <h4>Document Type</h4>
                        <p>Select "Credit Memo" instead of "Invoice"</p>
                    </div>
                    <div class="rule-card">
                        <h4>Line Items</h4>
                        <p>Enter line items with negative quantities/amounts</p>
                    </div>
                    <div class="rule-card">
                        <h4>Reference</h4>
                        <p>Include original invoice number if provided</p>
                    </div>
                </div>
                
                <div class="important-note">
                    <h4><i class="fas fa-exclamation-circle"></i> Important Notes</h4>
                    <ul>
                        <li>Credit memos reduce accounts payable balance</li>
                        <li>Always verify if document is truly a credit (not a debit memo from customer perspective)</li>
                        <li>Match credit memos to original invoices when possible</li>
                        <li>Some vendors issue credit memos for price adjustments, returns, or overpayments</li>
                        <li>Credit memos may have different numbering sequence than regular invoices</li>
                    </ul>
                </div>
            </section>
            
            <!-- Quiz Section -->
            <section id="quiz-section" class="quiz-section">
                <div class="quiz-header">
                    <h2><i class="fas fa-graduation-cap"></i> Invoice Processing Training Quiz</h2>
                    <p>Test your knowledge with these quizzes. Choose your difficulty level!</p>
                </div>
                
                <!-- Quiz Level Selection -->
                <div class="quiz-levels">
                    <div class="level-card" data-level="1">
                        <div class="level-icon">
                            <i class="fas fa-seedling"></i>
                        </div>
                        <h3>Level 1: Beginner</h3>
                        <p>Basic questions covering fundamental concepts. Perfect for new team members.</p>
                        <div class="level-difficulty difficulty-easy">Easy â€¢ 10 Questions</div>
                    </div>
                    
                    <div class="level-card" data-level="2">
                        <div class="level-icon">
                            <i class="fas fa-tree"></i>
                        </div>
                        <h3>Level 2: Intermediate</h3>
                        <p>Moderate difficulty questions with scenario-based challenges.</p>
                        <div class="level-difficulty difficulty-medium">Medium â€¢ 15 Questions</div>
                    </div>
                    
                    <div class="level-card" data-level="3">
                        <div class="level-icon">
                            <i class="fas fa-mountain"></i>
                        </div>
                        <h3>Level 3: Advanced</h3>
                        <p>Complex scenarios and edge cases for experienced processors.</p>
                        <div class="level-difficulty difficulty-hard">Hard â€¢ 20 Questions</div>
                    </div>
                    
                    <div class="level-card" data-level="4">
                        <div class="level-icon">
                            <i class="fas fa-trophy"></i>
                        </div>
                        <h3>Level 4: Expert Challenge</h3>
                        <p>All 30 questions on one page - The ultimate test!</p>
                        <div class="level-difficulty difficulty-expert">Expert â€¢ 30 Questions</div>
                    </div>
                </div>
                
                <!-- Quiz Container (Hidden by default) -->
                <div class="quiz-container" id="quizContainer">
                    <div class="quiz-stats">
                        <div class="stat-box">
                            <div class="stat-icon">
                                <i class="fas fa-user"></i>
                            </div>
                            <div class="stat-content">
                                <h4 id="currentLevel">Level 1</h4>
                                <p>Difficulty</p>
                            </div>
                        </div>
                        
                        <div class="stat-box">
                            <div class="stat-icon">
                                <i class="fas fa-check-circle"></i>
                            </div>
                            <div class="stat-content">
                                <h4 id="answeredCount">0</h4>
                                <p>Answered</p>
                            </div>
                        </div>
                        
                        <div class="quiz-progress">
                            <div class="progress-text">
                                <span>Progress</span>
                                <span id="progressPercentage">0%</span>
                            </div>
                            <div class="progress-bar-quiz">
                                <div class="progress-fill" id="progressFill"></div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Questions Grid - Level 4 uses special grid -->
                    <div class="questions-grid-level4" id="questionsGrid">
                        <!-- Questions will be inserted here -->
                    </div>
                    
                    <!-- Quiz Controls - Fixed at Bottom -->
                    <div class="quiz-controls-level4" id="quizControls">
                        <button class="quiz-btn quiz-btn-secondary" id="backToLevels">
                            <i class="fas fa-arrow-left"></i> Back to Levels
                        </button>
                        <button class="quiz-btn quiz-btn-primary" id="submitQuiz">
                            <i class="fas fa-paper-plane"></i> Submit Answers
                        </button>
                    </div>
                </div>
                
                <!-- Results Container -->
                <div class="results-container" id="resultsContainer">
                    <div class="results-header">
                        <h2>Quiz Results</h2>
                    </div>
                    
                    <div class="score-card">
                        <div class="score-display">
                            <div class="score-value" id="finalScore">0/10</div>
                            <div class="score-percentage" id="scorePercentage">0%</div>
                            <div class="score-message" id="scoreMessage"></div>
                        </div>
                        
                        <div class="score-details">
                            <div class="detail-box">
                                <div class="detail-value" id="correctCount">0</div>
                                <div class="detail-label">Correct Answers</div>
                            </div>
                            <div class="detail-box">
                                <div class="detail-value" id="incorrectCount">0</div>
                                <div class="detail-label">Incorrect Answers</div>
                            </div>
                            <div class="detail-box">
                                <div class="detail-value" id="unansweredCount">0</div>
                                <div class="detail-label">Unanswered</div>
                            </div>
                            <div class="detail-box">
                                <div class="detail-value" id="accuracy">0%</div>
                                <div class="label">Accuracy</div>
                            </div>
                        </div>
                    </div>
                    
                    <div class="answers-review">
                        <h3><i class="fas fa-list-check"></i> Answer Review</h3>
                        <div class="answer-cards" id="answerCards">
                            <!-- Answer review cards will be inserted here -->
                        </div>
                    </div>
                    
                    <div class="quiz-controls-level4">
                        <button class="quiz-btn quiz-btn-secondary" id="retryQuiz">
                            <i class="fas fa-redo"></i> Retry This Level
                        </button>
                        <button class="quiz-btn quiz-btn-primary" id="tryAnotherLevel">
                            <i class="fas fa-random"></i> Try Another Level
                        </button>
                    </div>
                </div>
            </section>
            
            <!-- File Upload Section -->
            <section id="upload-section" class="section">
                <div class="section-header">
                    <div class="section-icon">
                        <i class="fas fa-cloud-upload-alt"></i>
                    </div>
                    <h2 class="section-title">Document Upload Center</h2>
                </div>

                <div class="upload-container">
                    <!-- Upload Area -->
                    <div class="upload-area" id="uploadArea">
                        <div class="upload-icon">
                            <i class="fas fa-cloud-upload-alt"></i>
                        </div>
                        <h3>Drag & Drop Files Here</h3>
                        <p>or click to browse</p>
                        <p class="upload-formats">Supported formats: PDF, Excel, Word, PPT, Images, JSON, HTML</p>
                        <input type="file" id="fileInput" multiple accept=".pdf,.xlsx,.xls,.doc,.docx,.ppt,.pptx,.jpg,.jpeg,.png,.gif,.json,.html,.txt,.csv">
                        <div class="upload-progress" id="uploadProgress" style="display: none;">
                            <div class="progress-bar-upload">
                                <div class="progress-fill-upload" id="uploadProgressFill"></div>
                            </div>
                            <span id="progressText">0%</span>
                        </div>
                    </div>

                    <!-- File Filters -->
                    <div class="upload-filters">
                        <div class="filter-controls">
                            <button class="filter-btn active" data-filter="all">All Files</button>
                            <button class="filter-btn" data-filter="pdf">PDF</button>
                            <button class="filter-btn" data-filter="excel">Excel</button>
                            <button class="filter-btn" data-filter="word">Word</button>
                            <button class="filter-btn" data-filter="image">Images</button>
                            <button class="filter-btn" data-filter="other">Other</button>
                        </div>
                        <div class="sort-controls">
                            <select id="sortSelect" class="sort-select">
                                <option value="date-desc">Newest First</option>
                                <option value="date-asc">Oldest First</option>
                                <option value="name-asc">Name (A-Z)</option>
                                <option value="name-desc">Name (Z-A)</option>
                                <option value="size-desc">Largest First</option>
                                <option value="size-asc">Smallest First</option>
                            </select>
                        </div>
                    </div>

                    <!-- Uploaded Files Grid -->
                    <div class="files-grid" id="filesGrid">
                        <!-- Files will be dynamically added here -->
                    </div>
                    <div class="files-controls" style="display:flex;gap:10px;align-items:center;margin-top:10px;">
                        <label style="display:flex;align-items:center;gap:8px;">
                            <input type="checkbox" id="selectAllCheckbox"> Select All
                        </label>
                        <button class="btn" id="deleteSelectedBtn" disabled>
                            <i class="fas fa-trash"></i> Delete Selected
                        </button>
                    </div>

                    <!-- Upload Stats -->
                    <div class="upload-stats">
                        <div class="stat-item">
                            <i class="fas fa-file"></i>
                            <span id="totalFiles">0</span> Files
                        </div>
                        <div class="stat-item">
                            <i class="fas fa-hdd"></i>
                            <span id="totalSize">0 MB</span> Total
                        </div>
                        <div class="stat-item">
                            <i class="fas fa-clock"></i>
                            <span id="lastUpload">Never</span>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Full Screen File Preview Modal -->
            <div class="preview-modal" id="previewModal">
                <div class="preview-header">
                    <div class="preview-header-left">
                        <button class="preview-btn back-btn" id="backBtn">
                            <i class="fas fa-arrow-left"></i> Back
                        </button>
                        <h3 id="previewTitle">File Preview</h3>
                    </div>
                    <div class="preview-header-right">
                        <button class="preview-btn view-pdf-btn" id="viewPdfBtn" title="View PDF">
                            <i class="fas fa-file-pdf"></i> View PDF
                        </button>
                        <button class="preview-btn" id="prevPdfPageBtn" title="Previous Page" disabled>
                            <i class="fas fa-arrow-left"></i>
                        </button>
                        <button class="preview-btn" id="nextPdfPageBtn" title="Next Page" disabled>
                            <i class="fas fa-arrow-right"></i>
                        </button>
                        <button class="preview-btn" id="zoomOutPdfBtn" title="Zoom Out" disabled>
                            <i class="fas fa-search-minus"></i>
                        </button>
                        <button class="preview-btn" id="zoomInPdfBtn" title="Zoom In" disabled>
                            <i class="fas fa-search-plus"></i>
                        </button>
                        <button class="preview-btn" id="pdfFullscreenBtn" title="Fullscreen">
                            <i class="fas fa-expand"></i>
                        </button>
                        <button class="preview-btn download-btn" id="downloadPreviewBtn">
                            <i class="fas fa-download"></i> Download
                        </button>
                        <button class="preview-btn close-btn" id="closePreviewBtn">
                            <i class="fas fa-times"></i> Close
                        </button>
                    </div>
                </div>
                <div class="preview-content" id="previewContent">
                    <!-- Preview content will be loaded here -->
                </div>
                <div class="preview-footer">
                    <div class="file-info">
                        <span id="fileNamePreview"></span>
                        <span id="fileSizePreview"></span>
                        <span id="fileTypePreview"></span>
                        <span id="uploadDatePreview"></span>
                    </div>
                    <div class="preview-controls">
                        <button class="preview-nav-btn" id="prevFileBtn" disabled>
                            <i class="fas fa-chevron-left"></i> Previous
                        </button>
                        <span id="fileCounter">0/0</span>
                        <button class="preview-nav-btn" id="nextFileBtn" disabled>
                            Next <i class="fas fa-chevron-right"></i>
                        </button>
                    </div>
                </div>
            </section>
            
            <div class="footer">
                <p>Invoice Processing Guidelines &copy; 2023 | Last Updated: June 2023 | Version 2.0</p>
            </div>
        </div>
    </div>
    
    <div class="fab" id="backToTop">
        <i class="fas fa-arrow-up"></i>
    </div>
    
    <div class="toast" id="toast">
        <i class="fas fa-check-circle"></i>
        <span id="toastMessage">PDF downloaded successfully!</span>
    </div>

    <!-- Floating elements for visual effect -->
    <div class="floating-elements">
        <div class="floating-element tts" style="top: 20%; left: 10%; width: 30px; height: 30px; animation-delay: 0s;"></div>
        <div class="floating-element tts" style="top: 60%; left: 80%; width: 40px; height: 40px; animation-delay: 5s;"></div>
        <div class="floating-element tts" style="top: 80%; left: 20%; width: 25px; height: 25px; animation-delay: 10s;"></div>
        <div class="floating-element tts" style="top: 40%; left: 70%; width: 35px; height: 35px; animation-delay: 15s;"></div>
    </div>

    <script>
        // TTS Manager with Multi-Language Support
        const ttsManager = {
            synth: window.speechSynthesis,
            voices: [],
            currentUtterance: null,
            isPlaying: false,
            isPaused: false,
            currentSection: null,
            currentLanguage: 'en', // Default language
            languageVoices: {
                en: null,
                hi: null,
                gu: null
            },
            settings: {
                voice: null,
                rate: 1,
                pitch: 1,
                language: 'en'
            },
            sections: [],
            currentSectionIndex: 0,
            translations: {
                en: {
                    // Section titles
                    'Invoice Processing Guidelines': 'Invoice Processing Guidelines',
                    'How to Process the Invoice': 'How to Process the Invoice',
                    'Purchase Order (PO Number)': 'Purchase Order (PO Number)',
                    'Due Date': 'Due Date',
                    'Invoice Number & Invoice Date': 'Invoice Number & Invoice Date',
                    'Liquor Invoice â€“ Split': 'Liquor Invoice â€“ Split',
                    'Standard / Food Invoice â€“ CATCH': 'Standard / Food Invoice â€“ CATCH',
                    'Freight Charge & Other Charge': 'Freight Charge & Other Charge',
                    'Liquor Invoice â€“ Deposit': 'Liquor Invoice â€“ Deposit',
                    '100% Discount': '100% Discount',
                    'Credit Memo': 'Credit Memo',
                    'Invoice Processing Training Quiz': 'Invoice Processing Training Quiz',
                    'Document Upload Center': 'Document Upload Center',
                    
                    // Common terms
                    'Definition': 'Definition',
                    'Examples': 'Examples',
                    'Rules': 'Rules',
                    'Processing Steps': 'Processing Steps',
                    'Important Note': 'Important Note',
                    'When to Apply': 'When to Apply',
                    'How to Create': 'How to Create',
                    'Common Questions': 'Common Questions',
                    'Summary': 'Summary',
                    'General Rules': 'General Rules',
                    'Example Scenarios': 'Example Scenarios',
                    'Item Types': 'Item Types',
                    'Common Terms Used': 'Common Terms Used',
                    'PO Number Format': 'PO Number Format',
                    'Examples from Different Vendors': 'Examples from Different Vendors',
                    'Due Date Calculation Methods': 'Due Date Calculation Methods',
                    'Special Cases and Exceptions': 'Special Cases and Exceptions',
                    'Invoice Number Format Rules': 'Invoice Number Format Rules',
                    'Date Format Rules': 'Date Format Rules',
                    'SPLIT Rules': 'SPLIT Rules',
                    'Simple Rule (Funda)': 'Simple Rule (Funda)',
                    'Common Scenarios & Solutions': 'Common Scenarios & Solutions',
                    'CATCH Rules': 'CATCH Rules',
                    'How to Validate CATCH Items': 'How to Validate CATCH Items',
                    'UOM Conversion Reference': 'UOM Conversion Reference',
                    'Examples of Freight Charges': 'Examples of Freight Charges',
                    'Examples of Other Charges': 'Examples of Other Charges',
                    'How to Handle Charges in Invoice': 'How to Handle Charges in Invoice',
                    'Processing Steps for Charges': 'Processing Steps for Charges',
                    'Common Mistakes to Avoid': 'Common Mistakes to Avoid',
                    'DEPOSIT Categories': 'DEPOSIT Categories',
                    'LIQUOR INVOICE â€“ KEG DEPOSIT': 'LIQUOR INVOICE â€“ KEG DEPOSIT',
                    'LIQUOR INVOICE â€“ DEPOSIT ON ABOVE ITEM': 'LIQUOR INVOICE â€“ DEPOSIT ON ABOVE ITEM',
                    'LIQUOR INVOICE â€“ KEG RETURN': 'LIQUOR INVOICE â€“ KEG RETURN',
                    'Summary Table - Deposit Types': 'Summary Table - Deposit Types',
                    'When to Apply 100% Discount': 'When to Apply 100% Discount',
                    'How to Create the 100% Discount Line': 'How to Create the 100% Discount Line',
                    'Detailed Example: 100% Discount with SPLIT': 'Detailed Example: 100% Discount with SPLIT',
                    'Common Questions & Answers': 'Common Questions & Answers',
                    'When to Mark as CREDIT MEMO': 'When to Mark as CREDIT MEMO',
                    'How to Process Credit Memos': 'How to Process Credit Memos',
                    'Reverse Processing Rules': 'Reverse Processing Rules',
                    'Drag & Drop Files Here': 'Drag & Drop Files Here',
                    'or click to browse': 'or click to browse'
                },
                hi: {
                    // Section titles
                    'Invoice Processing Guidelines': 'à¤šà¤¾à¤²à¤¾à¤¨ à¤ªà¥à¤°à¤¸à¤‚à¤¸à¥à¤•à¤°à¤£ à¤¦à¤¿à¤¶à¤¾à¤¨à¤¿à¤°à¥à¤¦à¥‡à¤¶',
                    'How to Process the Invoice': 'à¤šà¤¾à¤²à¤¾à¤¨ à¤•à¥ˆà¤¸à¥‡ à¤¸à¤‚à¤¸à¤¾à¤§à¤¿à¤¤ à¤•à¤°à¥‡à¤‚',
                    'Purchase Order (PO Number)': 'à¤•à¥à¤°à¤¯ à¤†à¤¦à¥‡à¤¶ (PO à¤¨à¤‚à¤¬à¤°)',
                    'Due Date': 'à¤¨à¤¿à¤¯à¤¤ à¤¤à¤¾à¤°à¥€à¤–',
                    'Invoice Number & Invoice Date': 'à¤šà¤¾à¤²à¤¾à¤¨ à¤¨à¤‚à¤¬à¤° à¤”à¤° à¤šà¤¾à¤²à¤¾à¤¨ à¤¤à¤¾à¤°à¥€à¤–',
                    'Liquor Invoice â€“ Split': 'à¤¶à¤°à¤¾à¤¬ à¤šà¤¾à¤²à¤¾à¤¨ â€“ à¤µà¤¿à¤­à¤¾à¤œà¤¿à¤¤',
                    'Standard / Food Invoice â€“ CATCH': 'à¤®à¤¾à¤¨à¤• / à¤–à¤¾à¤¦à¥à¤¯ à¤šà¤¾à¤²à¤¾à¤¨ â€“ CATCH',
                    'Freight Charge & Other Charge': 'à¤®à¤¾à¤² à¤¢à¥à¤²à¤¾à¤ˆ à¤¶à¥à¤²à¥à¤• à¤”à¤° à¤…à¤¨à¥à¤¯ à¤¶à¥à¤²à¥à¤•',
                    'Liquor Invoice â€“ Deposit': 'à¤¶à¤°à¤¾à¤¬ à¤šà¤¾à¤²à¤¾à¤¨ â€“ à¤œà¤®à¤¾',
                    '100% Discount': '100% à¤›à¥‚à¤Ÿ',
                    'Credit Memo': 'à¤•à¥à¤°à¥‡à¤¡à¤¿à¤Ÿ à¤œà¥à¤žà¤¾à¤ªà¤¨',
                    'Invoice Processing Training Quiz': 'à¤šà¤¾à¤²à¤¾à¤¨ à¤ªà¥à¤°à¤¸à¤‚à¤¸à¥à¤•à¤°à¤£ à¤ªà¥à¤°à¤¶à¤¿à¤•à¥à¤·à¤£ à¤ªà¥à¤°à¤¶à¥à¤¨à¥‹à¤¤à¥à¤¤à¤°à¥€',
                    'Document Upload Center': 'à¤¦à¤¸à¥à¤¤à¤¾à¤µà¥‡à¤œà¤¼ à¤…à¤ªà¤²à¥‹à¤¡ à¤•à¥‡à¤‚à¤¦à¥à¤°',
                    
                    // Common terms
                    'Definition': 'à¤ªà¤°à¤¿à¤­à¤¾à¤·à¤¾',
                    'Examples': 'à¤‰à¤¦à¤¾à¤¹à¤°à¤£',
                    'Rules': 'à¤¨à¤¿à¤¯à¤®',
                    'Processing Steps': 'à¤ªà¥à¤°à¤¸à¤‚à¤¸à¥à¤•à¤°à¤£ à¤šà¤°à¤£',
                    'Important Note': 'à¤®à¤¹à¤¤à¥à¤µà¤ªà¥‚à¤°à¥à¤£ à¤¨à¥‹à¤Ÿ',
                    'When to Apply': 'à¤•à¤¬ à¤²à¤¾à¤—à¥‚ à¤•à¤°à¥‡à¤‚',
                    'How to Create': 'à¤•à¥ˆà¤¸à¥‡ à¤¬à¤¨à¤¾à¤à¤‚',
                    'Common Questions': 'à¤¸à¤¾à¤®à¤¾à¤¨à¥à¤¯ à¤ªà¥à¤°à¤¶à¥à¤¨',
                    'Summary': 'à¤¸à¤¾à¤°à¤¾à¤‚à¤¶',
                    'General Rules': 'à¤¸à¤¾à¤®à¤¾à¤¨à¥à¤¯ à¤¨à¤¿à¤¯à¤®',
                    'Example Scenarios': 'à¤‰à¤¦à¤¾à¤¹à¤°à¤£ à¤ªà¤°à¤¿à¤¦à¥ƒà¤¶à¥à¤¯',
                    'Item Types': 'à¤†à¤‡à¤Ÿà¤® à¤ªà¥à¤°à¤•à¤¾à¤°',
                    'Common Terms Used': 'à¤ªà¥à¤°à¤¯à¥à¤•à¥à¤¤ à¤¸à¤¾à¤®à¤¾à¤¨à¥à¤¯ à¤¶à¤¬à¥à¤¦',
                    'PO Number Format': 'PO à¤¨à¤‚à¤¬à¤° à¤ªà¥à¤°à¤¾à¤°à¥‚à¤ª',
                    'Examples from Different Vendors': 'à¤µà¤¿à¤­à¤¿à¤¨à¥à¤¨ à¤µà¤¿à¤•à¥à¤°à¥‡à¤¤à¤¾à¤“à¤‚ à¤•à¥‡ à¤‰à¤¦à¤¾à¤¹à¤°à¤£',
                    'Due Date Calculation Methods': 'à¤¨à¤¿à¤¯à¤¤ à¤¤à¤¾à¤°à¥€à¤– à¤—à¤£à¤¨à¤¾ à¤µà¤¿à¤§à¤¿à¤¯à¤¾à¤',
                    'Special Cases and Exceptions': 'à¤µà¤¿à¤¶à¥‡à¤· à¤®à¤¾à¤®à¤²à¥‡ à¤”à¤° à¤…à¤ªà¤µà¤¾à¤¦',
                    'Invoice Number Format Rules': 'à¤šà¤¾à¤²à¤¾à¤¨ à¤¨à¤‚à¤¬à¤° à¤ªà¥à¤°à¤¾à¤°à¥‚à¤ª à¤¨à¤¿à¤¯à¤®',
                    'Date Format Rules': 'à¤¤à¤¾à¤°à¥€à¤– à¤ªà¥à¤°à¤¾à¤°à¥‚à¤ª à¤¨à¤¿à¤¯à¤®',
                    'SPLIT Rules': 'à¤µà¤¿à¤­à¤¾à¤œà¤¨ à¤¨à¤¿à¤¯à¤®',
                    'Simple Rule (Funda)': 'à¤¸à¤°à¤² à¤¨à¤¿à¤¯à¤® (à¤«à¤‚à¤¡à¤¾)',
                    'Common Scenarios & Solutions': 'à¤¸à¤¾à¤®à¤¾à¤¨à¥à¤¯ à¤ªà¤°à¤¿à¤¦à¥ƒà¤¶à¥à¤¯ à¤”à¤° à¤¸à¤®à¤¾à¤§à¤¾à¤¨',
                    'CATCH Rules': 'à¤•à¥ˆà¤š à¤¨à¤¿à¤¯à¤®',
                    'How to Validate CATCH Items': 'à¤•à¥ˆà¤š à¤†à¤‡à¤Ÿà¤® à¤•à¥ˆà¤¸à¥‡ à¤®à¤¾à¤¨à¥à¤¯ à¤•à¤°à¥‡à¤‚',
                    'UOM Conversion Reference': 'à¤¯à¥‚à¤“à¤à¤® à¤°à¥‚à¤ªà¤¾à¤‚à¤¤à¤°à¤£ à¤¸à¤‚à¤¦à¤°à¥à¤­',
                    'Examples of Freight Charges': 'à¤®à¤¾à¤² à¤¢à¥à¤²à¤¾à¤ˆ à¤¶à¥à¤²à¥à¤• à¤•à¥‡ à¤‰à¤¦à¤¾à¤¹à¤°à¤£',
                    'Examples of Other Charges': 'à¤…à¤¨à¥à¤¯ à¤¶à¥à¤²à¥à¤•à¥‹à¤‚ à¤•à¥‡ à¤‰à¤¦à¤¾à¤¹à¤°à¤£',
                    'How to Handle Charges in Invoice': 'à¤šà¤¾à¤²à¤¾à¤¨ à¤®à¥‡à¤‚ à¤¶à¥à¤²à¥à¤• à¤•à¥ˆà¤¸à¥‡ à¤¸à¤‚à¤­à¤¾à¤²à¥‡à¤‚',
                    'Processing Steps for Charges': 'à¤¶à¥à¤²à¥à¤•à¥‹à¤‚ à¤•à¥‡ à¤²à¤¿à¤ à¤ªà¥à¤°à¤¸à¤‚à¤¸à¥à¤•à¤°à¤£ à¤šà¤°à¤£',
                    'Common Mistakes to Avoid': 'à¤¬à¤šà¤¨à¥‡ à¤•à¥‡ à¤²à¤¿à¤ à¤¸à¤¾à¤®à¤¾à¤¨à¥à¤¯ à¤—à¤²à¤¤à¤¿à¤¯à¤¾à¤',
                    'DEPOSIT Categories': 'à¤œà¤®à¤¾ à¤¶à¥à¤°à¥‡à¤£à¤¿à¤¯à¤¾à¤',
                    'LIQUOR INVOICE â€“ KEG DEPOSIT': 'à¤¶à¤°à¤¾à¤¬ à¤šà¤¾à¤²à¤¾à¤¨ - à¤•à¥‡à¤— à¤œà¤®à¤¾',
                    'LIQUOR INVOICE â€“ DEPOSIT ON ABOVE ITEM': 'à¤¶à¤°à¤¾à¤¬ à¤šà¤¾à¤²à¤¾à¤¨ - à¤Šà¤ªà¤° à¤•à¥‡ à¤†à¤‡à¤Ÿà¤® à¤ªà¤° à¤œà¤®à¤¾',
                    'LIQUOR INVOICE â€“ KEG RETURN': 'à¤¶à¤°à¤¾à¤¬ à¤šà¤¾à¤²à¤¾à¤¨ - à¤•à¥‡à¤— à¤µà¤¾à¤ªà¤¸à¥€',
                    'Summary Table - Deposit Types': 'à¤¸à¤¾à¤°à¤¾à¤‚à¤¶ à¤¤à¤¾à¤²à¤¿à¤•à¤¾ - à¤œà¤®à¤¾ à¤ªà¥à¤°à¤•à¤¾à¤°',
                    'When to Apply 100% Discount': '100% à¤›à¥‚à¤Ÿ à¤•à¤¬ à¤²à¤¾à¤—à¥‚ à¤•à¤°à¥‡à¤‚',
                    'How to Create the 100% Discount Line': '100% à¤›à¥‚à¤Ÿ à¤²à¤¾à¤‡à¤¨ à¤•à¥ˆà¤¸à¥‡ à¤¬à¤¨à¤¾à¤à¤‚',
                    'Detailed Example: 100% Discount with SPLIT': 'à¤µà¤¿à¤¸à¥à¤¤à¥ƒà¤¤ à¤‰à¤¦à¤¾à¤¹à¤°à¤£: à¤µà¤¿à¤­à¤¾à¤œà¤¨ à¤•à¥‡ à¤¸à¤¾à¤¥ 100% à¤›à¥‚à¤Ÿ',
                    'Common Questions & Answers': 'à¤¸à¤¾à¤®à¤¾à¤¨à¥à¤¯ à¤ªà¥à¤°à¤¶à¥à¤¨ à¤”à¤° à¤‰à¤¤à¥à¤¤à¤°',
                    'When to Mark as CREDIT MEMO': 'à¤•à¥à¤°à¥‡à¤¡à¤¿à¤Ÿ à¤®à¥‡à¤®à¥‹ à¤•à¥‡ à¤°à¥‚à¤ª à¤®à¥‡à¤‚ à¤•à¤¬ à¤šà¤¿à¤¹à¥à¤¨à¤¿à¤¤ à¤•à¤°à¥‡à¤‚',
                    'How to Process Credit Memos': 'à¤•à¥à¤°à¥‡à¤¡à¤¿à¤Ÿ à¤®à¥‡à¤®à¥‹ à¤•à¥ˆà¤¸à¥‡ à¤¸à¤‚à¤¸à¤¾à¤§à¤¿à¤¤ à¤•à¤°à¥‡à¤‚',
                    'Reverse Processing Rules': 'à¤‰à¤²à¥à¤Ÿà¤¾ à¤ªà¥à¤°à¤¸à¤‚à¤¸à¥à¤•à¤°à¤£ à¤¨à¤¿à¤¯à¤®',
                    'Drag & Drop Files Here': 'à¤«à¤¼à¤¾à¤‡à¤²à¥‡à¤‚ à¤¯à¤¹à¤¾à¤ à¤–à¥€à¤‚à¤šà¥‡à¤‚ à¤”à¤° à¤›à¥‹à¤¡à¤¼à¥‡à¤‚',
                    'or click to browse': 'à¤¯à¤¾ à¤¬à¥à¤°à¤¾à¤‰à¤œà¤¼ à¤•à¤°à¤¨à¥‡ à¤•à¥‡ à¤²à¤¿à¤ à¤•à¥à¤²à¤¿à¤• à¤•à¤°à¥‡à¤‚'
                },
                gu: {
                    // Section titles
                    'Invoice Processing Guidelines': 'àª‡àª¨àªµà«‹àª‡àª¸ àªªà«àª°à«‹àª¸à«‡àª¸àª¿àª‚àª— àª¦àª¿àª¶àª¾àª¨àª¿àª°à«àª¦à«‡àª¶à«‹',
                    'How to Process the Invoice': 'àª‡àª¨àªµà«‹àª‡àª¸ àª•à«‡àªµà«€ àª°à«€àª¤à«‡ àªªà«àª°à«‹àª¸à«‡àª¸ àª•àª°àªµà«‹',
                    'Purchase Order (PO Number)': 'àªªàª°àªšà«‡àª àª“àª°à«àª¡àª° (PO àª¨àª‚àª¬àª°)',
                    'Due Date': 'àª¨àª¿àª¯àª¤ àª¤àª¾àª°à«€àª–',
                    'Invoice Number & Invoice Date': 'àª‡àª¨àªµà«‹àª‡àª¸ àª¨àª‚àª¬àª° àª…àª¨à«‡ àª‡àª¨àªµà«‹àª‡àª¸ àª¤àª¾àª°à«€àª–',
                    'Liquor Invoice â€“ Split': 'àª²àª¿àª•àª° àª‡àª¨àªµà«‹àª‡àª¸ â€“ àªµàª¿àª­àª¾àªœàª¿àª¤',
                    'Standard / Food Invoice â€“ CATCH': 'àª¸à«àªŸàª¾àª¨à«àª¡àª°à«àª¡ / àª«à«‚àª¡ àª‡àª¨àªµà«‹àª‡àª¸ â€“ CATCH',
                    'Freight Charge & Other Charge': 'àª«à«àª°à«‡àªŸ àªšàª¾àª°à«àªœ àª…àª¨à«‡ àª…àª¨à«àª¯ àªšàª¾àª°à«àªœ',
                    'Liquor Invoice â€“ Deposit': 'àª²àª¿àª•àª° àª‡àª¨àªµà«‹àª‡àª¸ â€“ àªœàª®àª¾',
                    '100% Discount': '100% àª¡àª¿àª¸à«àª•àª¾àª‰àª¨à«àªŸ',
                    'Credit Memo': 'àª•à«àª°à«‡àª¡àª¿àªŸ àª®à«‡àª®à«‹',
                    'Invoice Processing Training Quiz': 'àª‡àª¨àªµà«‹àª‡àª¸ àªªà«àª°à«‹àª¸à«‡àª¸àª¿àª‚àª— àª¤àª¾àª²à«€àª® àª•à«àªµàª¿àª',
                    'Document Upload Center': 'àª¦àª¸à«àª¤àª¾àªµà«‡àªœ àª…àªªàª²à«‹àª¡ àª•à«‡àª¨à«àª¦à«àª°',
                    
                    // Common terms
                    'Definition': 'àªµà«àª¯àª¾àª–à«àª¯àª¾',
                    'Examples': 'àª‰àª¦àª¾àª¹àª°àª£à«‹',
                    'Rules': 'àª¨àª¿àª¯àª®à«‹',
                    'Processing Steps': 'àªªà«àª°à«‹àª¸à«‡àª¸àª¿àª‚àª— àª¸à«àªŸà«‡àªªà«àª¸',
                    'Important Note': 'àª®àª¹àª¤à«àªµàªªà«‚àª°à«àª£ àª¨à«‹àª‚àª§',
                    'When to Apply': 'àª•à«àª¯àª¾àª°à«‡ àª²àª¾àª—à« àª•àª°àªµà«àª‚',
                    'How to Create': 'àª•à«‡àªµà«€ àª°à«€àª¤à«‡ àª¬àª¨àª¾àªµàªµà«àª‚',
                    'Common Questions': 'àª¸àª¾àª®àª¾àª¨à«àª¯ àªªà«àª°àª¶à«àª¨à«‹',
                    'Summary': 'àª¸àª¾àª°àª¾àª‚àª¶',
                    'General Rules': 'àª¸àª¾àª®àª¾àª¨à«àª¯ àª¨àª¿àª¯àª®à«‹',
                    'Example Scenarios': 'àª‰àª¦àª¾àª¹àª°àª£ àªªàª°àª¿àª¸à«àª¥àª¿àª¤àª¿àª“',
                    'Item Types': 'àª†àª‡àªŸàª® àªªà«àª°àª•àª¾àª°à«‹',
                    'Common Terms Used': 'àªµàªªàª°àª¾àª¯à«‡àª²àª¾ àª¸àª¾àª®àª¾àª¨à«àª¯ àª¶àª¬à«àª¦à«‹',
                    'PO Number Format': 'PO àª¨àª‚àª¬àª° àª«à«‹àª°à«àª®à«‡àªŸ',
                    'Examples from Different Vendors': 'àªµàª¿àªµàª¿àª§ àªµà«‡àª¨à«àª¡àª°à«àª¸àª¨àª¾ àª‰àª¦àª¾àª¹àª°àª£à«‹',
                    'Due Date Calculation Methods': 'àª¨àª¿àª¯àª¤ àª¤àª¾àª°à«€àª– àª—àª£àª¤àª°à«€ àªªàª¦à«àª§àª¤àª¿àª“',
                    'Special Cases and Exceptions': 'àª–àª¾àª¸ àª•à«‡àª¸ àª…àª¨à«‡ àª…àªªàªµàª¾àª¦à«‹',
                    'Invoice Number Format Rules': 'àª‡àª¨àªµà«‹àª‡àª¸ àª¨àª‚àª¬àª° àª«à«‹àª°à«àª®à«‡àªŸ àª¨àª¿àª¯àª®à«‹',
                    'Date Format Rules': 'àª¤àª¾àª°à«€àª– àª«à«‹àª°à«àª®à«‡àªŸ àª¨àª¿àª¯àª®à«‹',
                    'SPLIT Rules': 'àªµàª¿àª­àª¾àªœàª¨ àª¨àª¿àª¯àª®à«‹',
                    'Simple Rule (Funda)': 'àª¸àª°àª³ àª¨àª¿àª¯àª® (àª«àª‚àª¡àª¾)',
                    'Common Scenarios & Solutions': 'àª¸àª¾àª®àª¾àª¨à«àª¯ àªªàª°àª¿àª¸à«àª¥àª¿àª¤àª¿àª“ àª…àª¨à«‡ àª‰àª•à«‡àª²à«‹',
                    'CATCH Rules': 'àª•à«‡àªš àª¨àª¿àª¯àª®à«‹',
                    'How to Validate CATCH Items': 'àª•à«‡àªš àª†àª‡àªŸàª®à«àª¸ àª•à«‡àªµà«€ àª°à«€àª¤à«‡ àª®àª¾àª¨à«àª¯ àª•àª°àªµà«€',
                    'UOM Conversion Reference': 'UOM àª•àª¨à«àªµàª°à«àªàª¨ àª¸àª‚àª¦àª°à«àª­',
                    'Examples of Freight Charges': 'àª«à«àª°à«‡àªŸ àªšàª¾àª°à«àªœàª¨àª¾ àª‰àª¦àª¾àª¹àª°àª£à«‹',
                    'Examples of Other Charges': 'àª…àª¨à«àª¯ àªšàª¾àª°à«àªœàª¨àª¾ àª‰àª¦àª¾àª¹àª°àª£à«‹',
                    'How to Handle Charges in Invoice': 'àª‡àª¨àªµà«‹àª‡àª¸àª®àª¾àª‚ àªšàª¾àª°à«àªœ àª•à«‡àªµà«€ àª°à«€àª¤à«‡ àª¸àª‚àª­àª¾àª³àªµàª¾',
                    'Processing Steps for Charges': 'àªšàª¾àª°à«àªœ àª®àª¾àªŸà«‡ àªªà«àª°à«‹àª¸à«‡àª¸àª¿àª‚àª— àª¸à«àªŸà«‡àªªà«àª¸',
                    'Common Mistakes to Avoid': 'àªŸàª¾àª³àªµàª¾ àª®àª¾àªŸà«‡ àª¸àª¾àª®àª¾àª¨à«àª¯ àª­à«‚àª²à«‹',
                    'DEPOSIT Categories': 'àªœàª®àª¾ àª¶à«àª°à«‡àª£à«€àª“',
                    'LIQUOR INVOICE â€“ KEG DEPOSIT': 'àª²àª¿àª•àª° àª‡àª¨àªµà«‹àª‡àª¸ - àª•à«‡àª— àª¡àª¿àªªà«‹àªàª¿àªŸ',
                    'LIQUOR INVOICE â€“ DEPOSIT ON ABOVE ITEM': 'àª²àª¿àª•àª° àª‡àª¨àªµà«‹àª‡àª¸ - àª‰àªªàª°àª¨àª¾ àª†àª‡àªŸàª® àªªàª° àªœàª®àª¾',
                    'LIQUOR INVOICE â€“ KEG RETURN': 'àª²àª¿àª•àª° àª‡àª¨àªµà«‹àª‡àª¸ - àª•à«‡àª— àª°à«€àªŸàª°à«àª¨',
                    'Summary Table - Deposit Types': 'àª¸àª¾àª°àª¾àª‚àª¶ àª•à«‹àª·à«àªŸàª• - àªœàª®àª¾ àªªà«àª°àª•àª¾àª°à«‹',
                    'When to Apply 100% Discount': '100% àª¡àª¿àª¸à«àª•àª¾àª‰àª¨à«àªŸ àª•à«àª¯àª¾àª°à«‡ àª²àª¾àª—à« àª•àª°àªµà«àª‚',
                    'How to Create the 100% Discount Line': '100% àª¡àª¿àª¸à«àª•àª¾àª‰àª¨à«àªŸ àª²àª¾àª‡àª¨ àª•à«‡àªµà«€ àª°à«€àª¤à«‡ àª¬àª¨àª¾àªµàªµà«€',
                    'Detailed Example: 100% Discount with SPLIT': 'àªµàª¿àª¸à«àª¤à«ƒàª¤ àª‰àª¦àª¾àª¹àª°àª£: SPLIT àª¸àª¾àª¥à«‡ 100% àª¡àª¿àª¸à«àª•àª¾àª‰àª¨à«àªŸ',
                    'Common Questions & Answers': 'àª¸àª¾àª®àª¾àª¨à«àª¯ àªªà«àª°àª¶à«àª¨à«‹ àª…àª¨à«‡ àªœàªµàª¾àª¬à«‹',
                    'When to Mark as CREDIT MEMO': 'àª•à«àª°à«‡àª¡àª¿àªŸ àª®à«‡àª®à«‹ àª¤àª°à«€àª•à«‡ àª•à«àª¯àª¾àª°à«‡ àªšàª¿àª¹à«àª¨àª¿àª¤ àª•àª°àªµà«àª‚',
                    'How to Process Credit Memos': 'àª•à«àª°à«‡àª¡àª¿àªŸ àª®à«‡àª®à«‹ àª•à«‡àªµà«€ àª°à«€àª¤à«‡ àªªà«àª°à«‹àª¸à«‡àª¸ àª•àª°àªµà«àª‚',
                    'Reverse Processing Rules': 'àªµàª¿àªªàª°à«€àª¤ àªªà«àª°à«‹àª¸à«‡àª¸àª¿àª‚àª— àª¨àª¿àª¯àª®à«‹',
                    'Drag & Drop Files Here': 'àª«àª¾àª‡àª²à«‹ àª…àª¹à«€àª‚ àª–à«‡àª‚àªšà«‹ àª…àª¨à«‡ àª›à«‹àª¡à«‹',
                    'or click to browse': 'àª…àª¥àªµàª¾ àª¬à«àª°àª¾àª‰àª àª•àª°àªµàª¾ àª®àª¾àªŸà«‡ àª•à«àª²àª¿àª• àª•àª°à«‹'
                }
            },
            
            init: function() {
                this.loadVoices();
                this.setupEventListeners();
                this.loadSettings();
                this.gatherSections();
                
                // Update voices when they are loaded
                if (this.synth.onvoiceschanged !== undefined) {
                    this.synth.onvoiceschanged = () => this.loadVoices();
                }
                
                // Show TTS controls after a delay
                setTimeout(() => {
                    const ttsControls = document.getElementById('ttsControls');
                    if (ttsControls) {
                        ttsControls.style.opacity = '1';
                    }
                }, 1000);
            },
            
            loadVoices: function() {
                this.voices = this.synth.getVoices();
                this.identifyLanguageVoices();
                this.populateVoiceSelect();
            },
            
            identifyLanguageVoices: function() {
                // Clear previous voice assignments
                this.languageVoices = { en: null, hi: null, gu: null };
                
                this.voices.forEach(voice => {
                    const lang = voice.lang.substring(0, 2).toLowerCase();
                    
                    // Assign voices by language
                    if (lang === 'en' && !this.languageVoices.en) {
                        this.languageVoices.en = voice;
                    } else if (lang === 'hi' && !this.languageVoices.hi) {
                        this.languageVoices.hi = voice;
                    } else if (lang === 'gu' && !this.languageVoices.gu) {
                        this.languageVoices.gu = voice;
                    }
                    
                    // Also look for specific voice names
                    if (voice.name.includes('Hindi') && !this.languageVoices.hi) {
                        this.languageVoices.hi = voice;
                    }
                    if (voice.name.includes('Gujarati') && !this.languageVoices.gu) {
                        this.languageVoices.gu = voice;
                    }
                    if ((voice.name.includes('English') || voice.name.includes('US') || voice.name.includes('UK')) && !this.languageVoices.en) {
                        this.languageVoices.en = voice;
                    }
                });
                
                // If no specific language voice found, use the first available voice
                if (!this.languageVoices.en && this.voices.length > 0) {
                    this.languageVoices.en = this.voices[0];
                }
                if (!this.languageVoices.hi && this.languageVoices.en) {
                    this.languageVoices.hi = this.languageVoices.en;
                }
                if (!this.languageVoices.gu && this.languageVoices.en) {
                    this.languageVoices.gu = this.languageVoices.en;
                }
            },
            
            populateVoiceSelect: function() {
                const voiceSelect = document.getElementById('ttsVoiceSelect');
                voiceSelect.innerHTML = '';
                
                // Filter voices for current language
                const currentLang = this.currentLanguage;
                const langVoices = this.voices.filter(voice => 
                    voice.lang.startsWith(currentLang) || 
                    (currentLang === 'hi' && voice.name.includes('Hindi')) ||
                    (currentLang === 'gu' && voice.name.includes('Gujarati')) ||
                    (currentLang === 'en' && (voice.lang.startsWith('en') || voice.name.includes('English')))
                );
                
                if (langVoices.length > 0) {
                    langVoices.forEach(voice => {
                        const option = document.createElement('option');
                        option.value = voice.name;
                        option.textContent = `${voice.name} (${voice.lang})`;
                        voiceSelect.appendChild(option);
                    });
                    
                    // Set default voice for current language
                    const defaultVoice = this.languageVoices[currentLang];
                    if (defaultVoice && langVoices.some(v => v.name === defaultVoice.name)) {
                        voiceSelect.value = defaultVoice.name;
                        this.settings.voice = defaultVoice.name;
                    } else if (langVoices.length > 0) {
                        voiceSelect.value = langVoices[0].name;
                        this.settings.voice = langVoices[0].name;
                    }
                } else {
                    // Fallback to any available voice
                    const option = document.createElement('option');
                    option.value = this.voices[0]?.name || '';
                    option.textContent = this.voices[0]?.name ? `${this.voices[0].name} (${this.voices[0].lang})` : 'No voices available';
                    voiceSelect.appendChild(option);
                    this.settings.voice = this.voices[0]?.name || null;
                }
                
                this.saveSettings();
            },
            
            translateText: function(text, targetLang) {
                const lang = targetLang || this.currentLanguage;
                
                // Simple translation lookup
                if (this.translations[lang] && this.translations[lang][text]) {
                    return this.translations[lang][text];
                }
                
                // If no translation found, return original text
                return text;
            },
            
            gatherSections: function() {
                const sections = document.querySelectorAll('.section, .quiz-section, #upload-section');
                this.sections = Array.from(sections).map(section => ({
                    id: section.id,
                    title: section.querySelector('.section-title')?.textContent || 
                           section.querySelector('.quiz-header h2')?.textContent || 'Untitled',
                    element: section,
                    content: this.extractReadableContent(section)
                }));
            },
            
            extractReadableContent: function(section) {
                // Clone the section to avoid modifying the original
                const clone = section.cloneNode(true);
                
                // Remove elements that shouldn't be read
                const elementsToRemove = clone.querySelectorAll(
                    '.section-icon, .nav-links, .btn, .search-box, .table-container, .quiz-levels, .quiz-container, .results-container, .footer, .fab, .toast, .toggle-container, .stats-container, .quiz-stats, .quiz-controls-level4, .header-actions, .tts-controls, .upload-container, .preview-modal'
                );
                
                elementsToRemove.forEach(el => el.remove());
                
                // Get the text content
                let text = clone.textContent;
                
                // Clean up the text
                text = text.replace(/\s+/g, ' ').trim();
                text = text.replace(/([.,!?;:])\s+/g, '$1 ').trim();
                
                // Translate section titles and common terms
                const sectionTitle = section.querySelector('.section-title')?.textContent || 
                                    section.querySelector('.quiz-header h2')?.textContent || '';
                
                if (sectionTitle && this.currentLanguage !== 'en') {
                    const translatedTitle = this.translateText(sectionTitle, this.currentLanguage);
                    if (translatedTitle !== sectionTitle) {
                        text = text.replace(sectionTitle, translatedTitle);
                    }
                }
                
                // Translate common terms in the text
                const commonTerms = Object.keys(this.translations.en);
                commonTerms.forEach(term => {
                    const translated = this.translateText(term, this.currentLanguage);
                    if (translated !== term) {
                        text = text.replace(new RegExp(term, 'gi'), translated);
                    }
                });
                
                return text;
            },
            
            setupEventListeners: function() {
                // TTS Control buttons
                document.getElementById('ttsPlayBtn').addEventListener('click', () => this.play());
                document.getElementById('ttsPauseBtn').addEventListener('click', () => this.pause());
                document.getElementById('ttsStopBtn').addEventListener('click', () => this.stop());
                
                // TTS Settings
                document.getElementById('ttsVoiceSelect').addEventListener('change', (e) => {
                    this.settings.voice = e.target.value;
                    this.saveSettings();
                });
                
                document.getElementById('ttsSpeed').addEventListener('change', (e) => {
                    this.settings.rate = parseFloat(e.target.value);
                    this.saveSettings();
                });
                
                document.getElementById('ttsPitch').addEventListener('change', (e) => {
                    this.settings.pitch = parseFloat(e.target.value);
                    this.saveSettings();
                });
                
                // Language switcher buttons
                document.querySelectorAll('.lang-btn').forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        const lang = e.target.dataset.lang || e.target.closest('.lang-btn').dataset.lang;
                        this.switchLanguage(lang);
                    });
                });
                
                // TTS Toggle button
                document.getElementById('ttsToggleBtn').addEventListener('click', () => this.toggleControls());
                
                // Header TTS button
                document.getElementById('ttsHeaderBtn').addEventListener('click', () => {
                    const ttsControls = document.getElementById('ttsControls');
                    ttsControls.classList.remove('minimized');
                    this.playCurrentSection();
                });
                
                // When user clicks on a section, update current section
                document.querySelectorAll('.section, .quiz-section, #upload-section').forEach((section, index) => {
                    section.addEventListener('click', () => {
                        this.currentSectionIndex = index;
                        this.updateCurrentSection();
                    });
                });
                
                // Auto-detect when user scrolls to a section
                window.addEventListener('scroll', () => {
                    const scrollPosition = window.scrollY + 100;
                    
                    this.sections.forEach((section, index) => {
                        const sectionTop = section.element.offsetTop;
                        const sectionBottom = sectionTop + section.element.offsetHeight;
                        
                        if (scrollPosition >= sectionTop && scrollPosition < sectionBottom) {
                            if (this.currentSectionIndex !== index) {
                                this.currentSectionIndex = index;
                                this.updateCurrentSection();
                            }
                        }
                    });
                });
            },
            
            switchLanguage: function(lang) {
                if (lang === this.currentLanguage) return;
                
                // Update active button
                document.querySelectorAll('.lang-btn').forEach(btn => {
                    btn.classList.remove('active');
                    if (btn.dataset.lang === lang) {
                        btn.classList.add('active');
                    }
                });
                
                // Update language indicator
                const langNames = {
                    en: 'English',
                    hi: 'Hindi',
                    gu: 'Gujarati'
                };
                document.getElementById('ttsLanguageIndicator').textContent = langNames[lang];
                
                // Stop current speech if playing
                if (this.isPlaying || this.isPaused) {
                    this.stop();
                }
                
                // Update current language
                this.currentLanguage = lang;
                this.settings.language = lang;
                
                // Update voice selection for new language
                this.populateVoiceSelect();
                
                // Update current section text with translation
                this.updateCurrentSection();
                
                // Save settings
                this.saveSettings();
                
                // Show confirmation
                this.showToast(`Language switched to ${langNames[lang]}`, 'success');
            },
            
            play: function() {
                if (this.isPaused && this.currentUtterance) {
                    this.synth.resume();
                    this.isPlaying = true;
                    this.isPaused = false;
                    this.updateUI();
                } else {
                    this.playCurrentSection();
                }
            },
            
            playCurrentSection: function() {
                if (this.currentSectionIndex >= this.sections.length) return;
                
                this.stop(); // Stop any current speech
                
                const section = this.sections[this.currentSectionIndex];
                this.currentSection = section;
                
                // Scroll to section
                section.element.scrollIntoView({ behavior: 'smooth', block: 'start' });
                
                // Get content in current language
                const content = this.extractReadableContent(section.element);
                
                // Create utterance
                const utterance = new SpeechSynthesisUtterance(content);
                
                // Set language
                utterance.lang = this.getLanguageCode(this.currentLanguage);
                
                // Set voice
                let selectedVoice = null;
                
                // Try to find voice for current language
                const voiceForLang = this.languageVoices[this.currentLanguage];
                if (voiceForLang) {
                    selectedVoice = voiceForLang;
                } else {
                    // Fallback to selected voice from dropdown
                    selectedVoice = this.voices.find(v => v.name === this.settings.voice);
                }
                
                if (selectedVoice) {
                    utterance.voice = selectedVoice;
                }
                
                // Set rate and pitch
                utterance.rate = this.settings.rate;
                utterance.pitch = this.settings.pitch;
                
                // Event listeners for the utterance
                utterance.onstart = () => {
                    this.isPlaying = true;
                    this.isPaused = false;
                    this.currentUtterance = utterance;
                    this.updateUI();
                    this.highlightSection();
                };
                
                utterance.onend = () => {
                    this.isPlaying = false;
                    this.currentUtterance = null;
                    this.updateUI();
                    this.removeHighlight();
                    
                    // Auto-play next section if available
                    if (this.currentSectionIndex < this.sections.length - 1) {
                        setTimeout(() => {
                            this.currentSectionIndex++;
                            this.playCurrentSection();
                        }, 500);
                    }
                };
                
                utterance.onerror = (event) => {
                    console.error('Speech synthesis error:', event);
                    this.isPlaying = false;
                    this.currentUtterance = null;
                    this.updateUI();
                    this.removeHighlight();
                    this.showToast('Speech synthesis error: ' + event.error, 'error');
                };
                
                utterance.onpause = () => {
                    this.isPlaying = false;
                    this.isPaused = true;
                    this.updateUI();
                };
                
                utterance.onresume = () => {
                    this.isPlaying = true;
                    this.isPaused = false;
                    this.updateUI();
                };
                
                // Speak
                this.synth.speak(utterance);
            },
            
            getLanguageCode: function(lang) {
                const codes = {
                    en: 'en-US',
                    hi: 'hi-IN',
                    gu: 'gu-IN'
                };
                return codes[lang] || 'en-US';
            },
            
            pause: function() {
                if (this.isPlaying && !this.isPaused) {
                    this.synth.pause();
                    this.isPlaying = false;
                    this.isPaused = true;
                    this.updateUI();
                }
            },
            
            stop: function() {
                if (this.currentUtterance || this.isPlaying || this.isPaused) {
                    this.synth.cancel();
                    this.isPlaying = false;
                    this.isPaused = false;
                    this.currentUtterance = null;
                    this.updateUI();
                    this.removeHighlight();
                }
            },
            
            updateCurrentSection: function() {
                const section = this.sections[this.currentSectionIndex];
                const translatedTitle = this.translateText(section.title, this.currentLanguage);
                document.getElementById('ttsCurrentSectionText').textContent = translatedTitle;
                
                // Update sidebar status
                const sidebarStatus = document.getElementById('ttsSidebarStatus');
                const currentStatus = document.getElementById('ttsCurrentStatus');
                const currentSection = document.getElementById('ttsCurrentSection');
                
                if (sidebarStatus && currentStatus && currentSection) {
                    sidebarStatus.style.display = 'block';
                    currentStatus.textContent = this.isPlaying ? 'Reading aloud...' : 'Ready to read';
                    currentSection.textContent = `Section: ${translatedTitle}`;
                }
            },
            
            highlightSection: function() {
                if (this.currentSection) {
                    this.currentSection.element.classList.add('tts-highlight');
                }
            },
            
            removeHighlight: function() {
                document.querySelectorAll('.tts-highlight').forEach(el => {
                    el.classList.remove('tts-highlight');
                });
            },
            
            updateUI: function() {
                const playBtn = document.getElementById('ttsPlayBtn');
                const pauseBtn = document.getElementById('ttsPauseBtn');
                const stopBtn = document.getElementById('ttsStopBtn');
                const status = document.getElementById('ttsStatus');
                const progressBar = document.getElementById('ttsProgressBar');
                
                if (this.isPlaying) {
                    playBtn.disabled = true;
                    pauseBtn.disabled = false;
                    stopBtn.disabled = false;
                    status.textContent = 'Reading';
                    status.style.background = 'linear-gradient(135deg, var(--primary), #34d399)';
                    
                    // Update progress bar based on section index
                    const progress = ((this.currentSectionIndex + 1) / this.sections.length) * 100;
                    progressBar.style.width = `${progress}%`;
                    
                    // Update play button icon
                    playBtn.innerHTML = '<i class="fas fa-play"></i>';
                } else if (this.isPaused) {
                    playBtn.disabled = false;
                    pauseBtn.disabled = true;
                    stopBtn.disabled = false;
                    status.textContent = 'Paused';
                    status.style.background = 'linear-gradient(135deg, #f59e0b, #fbbf24)';
                    
                    // Update play button icon
                    playBtn.innerHTML = '<i class="fas fa-play"></i>';
                } else {
                    playBtn.disabled = false;
                    pauseBtn.disabled = true;
                    stopBtn.disabled = true;
                    status.textContent = 'Ready';
                    status.style.background = 'var(--primary)';
                    
                    // Reset progress bar
                    progressBar.style.width = '0%';
                    
                    // Update play button icon
                    playBtn.innerHTML = '<i class="fas fa-play"></i>';
                }
                
                // Update header button
                const headerBtn = document.getElementById('ttsHeaderBtn');
                if (this.isPlaying) {
                    headerBtn.innerHTML = '<i class="fas fa-volume-up"></i> Stop Reading';
                    headerBtn.style.background = 'var(--primary)';
                    headerBtn.style.color = 'white';
                } else {
                    headerBtn.innerHTML = '<i class="fas fa-volume-up"></i> Read Aloud';
                    headerBtn.style.background = '';
                    headerBtn.style.color = '';
                }
                
                // Update language indicator
                const langNames = {
                    en: 'English',
                    hi: 'Hindi',
                    gu: 'Gujarati'
                };
                document.getElementById('ttsLanguageIndicator').textContent = langNames[this.currentLanguage];
            },
            
            toggleControls: function() {
                const controls = document.getElementById('ttsControls');
                const icon = document.getElementById('ttsToggleIcon');
                
                controls.classList.toggle('minimized');
                
                if (controls.classList.contains('minimized')) {
                    icon.className = 'fas fa-chevron-right';
                    icon.parentElement.title = 'Expand';
                } else {
                    icon.className = 'fas fa-chevron-left';
                    icon.parentElement.title = 'Minimize';
                }
            },
            
            saveSettings: function() {
                localStorage.setItem('ttsSettings', JSON.stringify(this.settings));
            },
            
            loadSettings: function() {
                const saved = localStorage.getItem('ttsSettings');
                if (saved) {
                    this.settings = JSON.parse(saved);
                    
                    // Update UI elements
                    document.getElementById('ttsSpeed').value = this.settings.rate;
                    document.getElementById('ttsPitch').value = this.settings.pitch;
                    
                    // Set language if saved
                    if (this.settings.language) {
                        this.switchLanguage(this.settings.language);
                    }
                }
            },
            
            showToast: function(message, type = 'info') {
                const toast = document.getElementById('toast');
                const toastMessage = document.getElementById('toastMessage');
                
                toastMessage.textContent = message;
                
                // Set color based on type
                if (type === 'error') {
                    toast.style.background = 'var(--danger)';
                } else if (type === 'success') {
                    toast.style.background = 'var(--success)';
                } else {
                    toast.style.background = 'var(--dark)';
                }
                
                toast.classList.add('show');
                
                setTimeout(() => {
                    toast.classList.remove('show');
                }, 3000);
            }
        };

        // Question Banks for different levels
        const questionBanks = {
            1: [
                {
                    id: 1,
                    question: "What are the three types of invoices mentioned in the training?",
                    options: [
                        "Standard/Food Invoice, Liquor Invoice, Service/Non-Food Invoice",
                        "Vendor Invoice, Tenant Invoice, Supplier Invoice",
                        "Digital Invoice, Paper Invoice, Email Invoice",
                        "Food Invoice, Drink Invoice, Service Invoice"
                    ],
                    correctAnswer: 0,
                    explanation: "The three types are: Standard/Food Invoice, Liquor Invoice, and Service/Non-Food Invoice"
                },
                {
                    id: 2,
                    question: "What is the difference between a Vendor and a Tenant?",
                    options: [
                        "Vendor supplies products, Tenant buys products",
                        "Vendor buys products, Tenant supplies products",
                        "Both are the same",
                        "Vendor processes invoices, Tenant creates invoices"
                    ],
                    correctAnswer: 0,
                    explanation: "Vendor supplies the products, Tenant buys the products"
                },
                {
                    id: 3,
                    question: "What does 'I' represent in invoice processing codes?",
                    options: [
                        "Invoice Number/Date",
                        "Internal Reference",
                        "Item Count",
                        "Import Code"
                    ],
                    correctAnswer: 0,
                    explanation: "In invoice processing, 'I' stands for Invoice Number/Date"
                },
                {
                    id: 4,
                    question: "What is a Purchase Order (PO) number?",
                    options: [
                        "A unique number assigned to purchase covering all tenant information",
                        "A random number generated by the system",
                        "The vendor's identification number",
                        "The invoice sequence number"
                    ],
                    correctAnswer: 0,
                    explanation: "PO number is a unique number assigned to purchase covering all tenant information"
                },
                {
                    id: 5,
                    question: "When should you mark a product as CATCH?",
                    options: [
                        "When weight is taken as the quantity",
                        "When the price is too high",
                        "When it's a food product",
                        "When it's a liquor product"
                    ],
                    correctAnswer: 0,
                    explanation: "CATCH is marked when weight is taken as quantity. UOM should be LB, Pack=1, Size=1, Unit=LB"
                },
                {
                    id: 6,
                    question: "What is a Zero Dollar Invoice?",
                    options: [
                        "An invoice with total amount of zero",
                        "An invoice with missing amount",
                        "A cancelled invoice",
                        "A duplicate invoice"
                    ],
                    correctAnswer: 0,
                    explanation: "Zero Dollar Invoice has a total amount of zero"
                },
                {
                    id: 7,
                    question: "What should you do when you see 'Credit Memo' on an invoice?",
                    options: [
                        "Mark as CREDIT MEMO and process in opposite sign",
                        "Ignore it and process normally",
                        "Delete the invoice",
                        "Send it to manual exception"
                    ],
                    correctAnswer: 0,
                    explanation: "Credit Memo should be marked and processed in opposite sign of the invoice"
                },
                {
                    id: 8,
                    question: "What code is used for Purchase Summary in Non-Food invoices?",
                    options: [
                        "XCG-101",
                        "XCKD-101",
                        "XCD-101",
                        "XCRV-101"
                    ],
                    correctAnswer: 0,
                    explanation: "XCG-101 is used for Purchase Summary with Description: PURCHASE SUMMARY"
                },
                {
                    id: 9,
                    question: "What does UOM stand for?",
                    options: [
                        "Unit of Measurement",
                        "Unit of Money",
                        "Universal Order Method",
                        "User Order Management"
                    ],
                    correctAnswer: 0,
                    explanation: "UOM stands for Unit of Measurement"
                },
                {
                    id: 10,
                    question: "What is Freight Charge?",
                    options: [
                        "Amount required to transfer material from one place to another",
                        "Tax on purchased items",
                        "Discount on bulk orders",
                        "Penalty for late payment"
                    ],
                    correctAnswer: 0,
                    explanation: "Freight Charge includes shipping, delivery, transportation, fuel, and handling charges"
                }
            ],
            2: [
                {
                    id: 1,
                    question: "What is the difference between DUPLICATE and POSSIBLE DUPLICATE?",
                    options: [
                        "Duplicate is already processed, Possible Duplicate is pending in queue",
                        "Duplicate is pending, Possible Duplicate is processed",
                        "Both are the same",
                        "Duplicate is for food, Possible Duplicate is for liquor"
                    ],
                    correctAnswer: 0,
                    explanation: "DUPLICATE invoices are already processed, POSSIBLE DUPLICATE are similar copies pending in queue"
                },
                {
                    id: 2,
                    question: "What is a NON-INVOICE IMAGE?",
                    options: [
                        "Packing slip, statement or any image other than invoice",
                        "Blurred invoice image",
                        "Invoice with missing pages",
                        "Invoice with zero amount"
                    ],
                    correctAnswer: 0,
                    explanation: "Non-Invoice Images include packing slips, statements, or any images other than actual invoices"
                },
                {
                    id: 3,
                    question: "What is BAD QUALITY IMAGE?",
                    options: [
                        "Blurred or not properly visible invoice",
                        "Invoice with wrong date",
                        "Invoice from unverified vendor",
                        "Invoice without signature"
                    ],
                    correctAnswer: 0,
                    explanation: "Bad Quality Image refers to invoices that are blurred or not properly visible"
                },
                {
                    id: 4,
                    question: "What should you do when an invoice has more than one page and a page is missing?",
                    options: [
                        "Mark as MISSING INVOICE PAGE",
                        "Process it normally",
                        "Ignore the missing page",
                        "Create a new invoice"
                    ],
                    correctAnswer: 0,
                    explanation: "If any page of a multi-page invoice is missing, it should be marked as MISSING INVOICE PAGE"
                },
                {
                    id: 5,
                    question: "What is MULTIPLE INVOICE?",
                    options: [
                        "Two or more different invoices on one single page",
                        "Invoice with multiple products",
                        "Invoice from multiple vendors",
                        "Invoice processed multiple times"
                    ],
                    correctAnswer: 0,
                    explanation: "Multiple Invoice refers to two or more different invoices on one single page"
                },
                {
                    id: 6,
                    question: "What should you do when there are two or more invoices in one file?",
                    options: [
                        "Send to PAGE SEPARATION",
                        "Process them together",
                        "Delete the extra invoices",
                        "Mark as duplicate"
                    ],
                    correctAnswer: 0,
                    explanation: "When there are multiple invoices in one file, send to PAGE SEPARATION"
                },
                {
                    id: 7,
                    question: "Which term is NOT a type of Credit Memo?",
                    options: [
                        "Purchase Order",
                        "Credit Memo / CM",
                        "Return Memo / RM",
                        "Adjustment Receipt"
                    ],
                    correctAnswer: 0,
                    explanation: "Purchase Order is not a type of Credit Memo. Credit Memo terms include: Credit Memo, Return Memo, Return Authorization, Adjustment Receipt, Pickup Receipt"
                },
                {
                    id: 8,
                    question: "What is STANDARD or FOOD INVOICE?",
                    options: [
                        "Invoice that has food products in description",
                        "Invoice from standard vendor",
                        "Invoice with standard format",
                        "Invoice for food services"
                    ],
                    correctAnswer: 0,
                    explanation: "Standard/Food Invoice has food products in description like Meat, Vegetables, Dairy Products"
                },
                {
                    id: 9,
                    question: "When do we mark SPLIT for SYSCO invoices?",
                    options: [
                        "When we get the line 'S Only'",
                        "When invoice amount is high",
                        "When there are multiple products",
                        "When vendor is not verified"
                    ],
                    correctAnswer: 0,
                    explanation: "For SYSCO invoices, mark SPLIT when you get the line 'S Only'. UOM should be blank"
                },
                {
                    id: 10,
                    question: "How do we process SERVICE/NON-FOOD invoices?",
                    options: [
                        "Use Item Code XCG-101 with Description PURCHASE SUMMARY",
                        "Process each line item separately",
                        "Mark as exception",
                        "Send to manual review"
                    ],
                    correctAnswer: 0,
                    explanation: "For Non-Food invoices, use Item Code: XCG-101, Description: PURCHASE SUMMARY, Quantity: 1, Amount as per invoice"
                },
                {
                    id: 11,
                    question: "What is LIQUOR INVOICE?",
                    options: [
                        "Invoice that has liquor or drinkable products",
                        "Invoice from liquor store",
                        "Invoice with high value",
                        "Invoice with alcohol tax"
                    ],
                    correctAnswer: 0,
                    explanation: "Liquor Invoice has liquor or any drinkable products like Vodka, Whiskey, Beer, Pepsi"
                },
                {
                    id: 12,
                    question: "When is SPLIT marked in Liquor Invoice?",
                    options: [
                        "When purchase is made by bottle and pack is more than 1",
                        "When invoice has multiple pages",
                        "When vendor is not verified",
                        "When tax is not calculated"
                    ],
                    correctAnswer: 0,
                    explanation: "In Liquor Invoice, mark SPLIT when purchase is made by bottle and pack is more than 1"
                },
                {
                    id: 13,
                    question: "What code is used for KEG DEPOSIT?",
                    options: [
                        "XCKD-101",
                        "XCD-101",
                        "XCKR-101",
                        "XCRV-101"
                    ],
                    correctAnswer: 0,
                    explanation: "XCKD-101 is used for KEG DEPOSIT when deposit amount is in whole number"
                },
                {
                    id: 14,
                    question: "What code is used for DEPOSIT ON ABOVE ITEM?",
                    options: [
                        "XCD-101",
                        "XCKD-101",
                        "XCKR-101",
                        "XCRV-101"
                    ],
                    correctAnswer: 0,
                    explanation: "XCD-101 is used for DEPOSIT ON ABOVE ITEM when deposit amount is in decimal number"
                },
                {
                    id: 15,
                    question: "How is KEG RETURN processed?",
                    options: [
                        "In negative value with code XCKR-101",
                        "In positive value with code XCKD-101",
                        "As normal line item",
                        "As credit memo"
                    ],
                    correctAnswer: 0,
                    explanation: "KEG RETURN is always processed in negative value with code XCKR-101"
                }
            ],
            3: [
                {
                    id: 1,
                    question: "What is CRV?",
                    options: [
                        "California Redemption Value for bottles",
                        "Credit Return Value",
                        "Customer Return Voucher",
                        "Cash Return Voucher"
                    ],
                    correctAnswer: 0,
                    explanation: "CRV is California Redemption Value, processed with code XCRV-101"
                },
                {
                    id: 2,
                    question: "When do we create 100% discount line?",
                    options: [
                        "When NO CHARGE is written in product line",
                        "When invoice has minor errors",
                        "When vendor offers special discount",
                        "When product is out of stock"
                    ],
                    correctAnswer: 0,
                    explanation: "100% discount line is created when: NO CHARGE is written, quantity is under FREE column, or unit price equals discount"
                },
                {
                    id: 3,
                    question: "How is CASE TO BOTTLE conversion done?",
                    options: [
                        "Unit Price / Pack = ?, External Amount / ? = No. of Bottles",
                        "Case quantity Ã— Pack size",
                        "Bottle quantity Ã· Pack size",
                        "External Amount Ã· Unit Price"
                    ],
                    correctAnswer: 0,
                    explanation: "Case to bottle conversion: Unit Price / Pack = ?, then External Amount / ? = No. of Bottles"
                },
                {
                    id: 4,
                    question: "What does 'Xtrachef Default' preference mean?",
                    options: [
                        "Food & Liquor invoices: Line Item, Non-Food: XCG",
                        "All invoices: Line Item",
                        "All invoices: XCG",
                        "Food: XCG, Liquor & Non-Food: Line Item"
                    ],
                    correctAnswer: 0,
                    explanation: "Xtrachef Default: Food & Liquor invoices process as Line Item, Non-Food as XCG"
                },
                {
                    id: 5,
                    question: "Where are tenant-specific requirements mentioned?",
                    options: [
                        "In VENDOR NOTE",
                        "In invoice header",
                        "In PO number",
                        "In product description"
                    ],
                    correctAnswer: 0,
                    explanation: "Tenant-specific requirements are mentioned in VENDOR NOTE"
                },
                {
                    id: 6,
                    question: "Scenario: An invoice has Food items but TENT requests XCG-101. What should you do?",
                    options: [
                        "Create a single line using XCG-101 (Purchase Summary)",
                        "Create individual lines for each food item",
                        "Mark as exception and send for review",
                        "Process normally with X.CHEF Default"
                    ],
                    correctAnswer: 0,
                    explanation: "When TENT specifically requests XCG-101, use it even for Food invoices"
                },
                {
                    id: 7,
                    question: "What should you check before marking an item as CATCH?",
                    options: [
                        "UOM = LB, Pack = 1, Size = 1, Unit = LB",
                        "Price is per pound, Vendor is approved, Product is fresh",
                        "Invoice has weight column, product is meat, quantity is decimal",
                        "System shows catch option, invoice mentions weight, product is seafood"
                    ],
                    correctAnswer: 0,
                    explanation: "Before marking CATCH: UOM must be LB, Pack=1, Size=1, Unit=LB, and CATCH column ticked"
                },
                {
                    id: 8,
                    question: "How to process freight charge when item code is NOT available?",
                    options: [
                        "Enter it in the Practical Box (Remarks/Additional Field)",
                        "Skip it as it's not billable",
                        "Create a generic line item",
                        "Contact vendor for item code"
                    ],
                    correctAnswer: 0,
                    explanation: "If charge has no Item Code â†’ Practical Box"
                },
                {
                    id: 9,
                    question: "What's the difference between KEG DEPOSIT and DEPOSIT ON ABOVE ITEM?",
                    options: [
                        "KEG Deposit is whole number, Deposit on above item is decimal",
                        "KEG Deposit is for beer only, Deposit on above item is for all liquor",
                        "KEG Deposit uses XCKD-101, Deposit on above item uses XCG-101",
                        "KEG Deposit is refundable, Deposit on above item is not"
                    ],
                    correctAnswer: 0,
                    explanation: "KEG DEPOSIT: whole numbers (10, 30, 50). DEPOSIT ON ABOVE ITEM: decimals (1.2, 2.4, 3.6)"
                },
                {
                    id: 10,
                    question: "How to create 100% discount lines for a bottle with Pack > 1?",
                    options: [
                        "Create two lines: Qty=1 Amount=+0.01 and Qty=-1 Amount=-0.01, mark both as SPLIT",
                        "Create one line with 100% discount option",
                        "Skip discount as it's complex",
                        "Mark as free item without lines"
                    ],
                    correctAnswer: 0,
                    explanation: "For 100% discount on bottle with Pack>1: create two SPLIT lines with +0.01 and -0.01 amounts"
                },
                {
                    id: 11,
                    question: "What to do when invoice shows 'Due Date: Net 30'?",
                    options: [
                        "Calculate 30 days from invoice date and enter that date",
                        "Enter 'Net 30' in due date field",
                        "Leave due date blank",
                        "Mark as exception"
                    ],
                    correctAnswer: 0,
                    explanation: "Calculate the actual date 30 days from invoice date and enter that date"
                },
                {
                    id: 12,
                    question: "How to handle invoice with mixed Food and Non-Food items?",
                    options: [
                        "Check each item and assign codes accordingly (X.CHEF for Food, XCG-101 for Non-Food)",
                        "Use XCG-101 for all items",
                        "Use X.CHEF for all items",
                        "Split into separate invoices"
                    ],
                    correctAnswer: 0,
                    explanation: "For mixed invoices: verify each item category and assign appropriate code"
                },
                {
                    id: 13,
                    question: "What does 'SPLIT' indicate in Liquor Invoice?",
                    options: [
                        "Case has been broken into bottles",
                        "Invoice is divided into multiple payments",
                        "Items are from different suppliers",
                        "Tax is calculated separately"
                    ],
                    correctAnswer: 0,
                    explanation: "SPLIT means a full case has been broken or divided into smaller parts (bottles)"
                },
                {
                    id: 14,
                    question: "When should you NOT include spaces in Invoice Number?",
                    options: [
                        "Always - never include spaces in Invoice Number",
                        "When invoice number is alphanumeric",
                        "When system automatically removes spaces",
                        "When vendor specifically requests no spaces"
                    ],
                    correctAnswer: 0,
                    explanation: "Do not include spaces in the Invoice Number - always remove them"
                },
                {
                    id: 15,
                    question: "What's the correct way to handle a Credit Memo?",
                    options: [
                        "Mark as CREDIT MEMO and process values in opposite sign",
                        "Process normally like regular invoice",
                        "Send to supervisor for approval",
                        "Combine with next regular invoice"
                    ],
                    correctAnswer: 0,
                    explanation: "Credit Memo must be marked and processed in opposite sign (credit instead of debit)"
                },
                {
                    id: 16,
                    question: "How to determine if an invoice is SPLIT?",
                    options: [
                        "Check if Bottle Quantity (BT Qty) is mentioned and Pack > 1",
                        "Check if price is per bottle",
                        "Check if vendor is liquor supplier",
                        "Check if quantity is less than case size"
                    ],
                    correctAnswer: 0,
                    explanation: "SPLIT when Bottle Quantity is mentioned AND Pack is more than 1"
                },
                {
                    id: 17,
                    question: "What is the 'Simple Rule' for CATCH items?",
                    options: [
                        "If UOM is automatically shown as LB and invoice mentions LB, mark as CATCH",
                        "If product is sold by weight, mark as CATCH",
                        "If price includes weight, mark as CATCH",
                        "If system suggests CATCH, mark it"
                    ],
                    correctAnswer: 0,
                    explanation: "Simple Rule: If UOM is LB in system and invoice mentions LB â†’ mark as CATCH"
                },
                {
                    id: 18,
                    question: "How to handle Other Charges like 'City Surcharge'?",
                    options: [
                        "Check if Item Code exists: if yes â†’ Line Item, if no â†’ Practical Box",
                        "Always put in Practical Box",
                        "Always create line item",
                        "Ignore as it's tax-related"
                    ],
                    correctAnswer: 0,
                    explanation: "Other Charges: Item Code available â†’ Line Item, no Item Code â†’ Practical Box"
                },
                {
                    id: 19,
                    question: "What are the three DEPOSIT categories?",
                    options: [
                        "KEG Deposit, Deposit on above item, KEG Return",
                        "Bottle Deposit, Case Deposit, Crate Deposit",
                        "Refundable Deposit, Non-refundable Deposit, Security Deposit",
                        "Alcohol Deposit, Food Deposit, Service Deposit"
                    ],
                    correctAnswer: 0,
                    explanation: "Three deposit categories: 1) KEG Deposit, 2) Deposit on above item, 3) KEG Return"
                },
                {
                    id: 20,
                    question: "What action for invoice with 'NO CHARGE' written on product line?",
                    options: [
                        "Create 100% discount lines",
                        "Skip the product",
                        "Process normally with zero amount",
                        "Mark as sample and exclude"
                    ],
                    correctAnswer: 0,
                    explanation: "'NO CHARGE' requires creating 100% discount lines"
                }
            ],
            4: [] // Level 4 will combine all questions from levels 1-3
        };

        // Combine all questions for Level 4 (30 questions)
        questionBanks[4] = [
            ...questionBanks[1],
            ...questionBanks[2],
            ...questionBanks[3]
        ];

        // Quiz State Management
        let currentLevel = 1;
        let userAnswers = {};
        let shuffledQuestions = [];

        // File Upload System
        const uploadSystem = {
            files: [],
            currentFilter: 'all',
            currentSort: 'date-desc',
            currentFileIndex: 0,
            
            init: function() {
                this.setupEventListeners();
                this.loadStoredFiles();
                this.renderFiles();
                this.updateStats();
            },
            
            setupEventListeners: function() {
                // File input
                const fileInput = document.getElementById('fileInput');
                const uploadArea = document.getElementById('uploadArea');
                
                uploadArea.addEventListener('click', () => fileInput.click());
                
                fileInput.addEventListener('change', (e) => this.handleFiles(e.target.files));
                
                // Drag and drop
                uploadArea.addEventListener('dragover', (e) => {
                    e.preventDefault();
                    uploadArea.classList.add('dragover');
                });
                
                uploadArea.addEventListener('dragleave', () => {
                    uploadArea.classList.remove('dragover');
                });
                
                uploadArea.addEventListener('drop', (e) => {
                    e.preventDefault();
                    uploadArea.classList.remove('dragover');
                    this.handleFiles(e.dataTransfer.files);
                });
                
                // Filter buttons
                document.querySelectorAll('.filter-btn').forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        document.querySelectorAll('.filter-btn').forEach(b => b.classList.remove('active'));
                        e.target.classList.add('active');
                        this.currentFilter = e.target.dataset.filter;
                        this.renderFiles();
                    });
                });
                
                // Sort select
                document.getElementById('sortSelect').addEventListener('change', (e) => {
                    this.currentSort = e.target.value;
                    this.renderFiles();
                });
                
                // Preview modal controls
                document.getElementById('backBtn').addEventListener('click', () => this.closePreview());
                document.getElementById('closePreviewBtn').addEventListener('click', () => this.closePreview());
                document.getElementById('downloadPreviewBtn').addEventListener('click', () => this.downloadCurrentFile());
                document.getElementById('prevFileBtn').addEventListener('click', () => this.showPrevFile());
                document.getElementById('nextFileBtn').addEventListener('click', () => this.showNextFile());
                // PDF viewer buttons
                const viewPdfBtn = document.getElementById('viewPdfBtn');
                if (viewPdfBtn) viewPdfBtn.addEventListener('click', () => this.openPdfWithPdfJs());
                const prevPdfPageBtn = document.getElementById('prevPdfPageBtn');
                if (prevPdfPageBtn) prevPdfPageBtn.addEventListener('click', () => this.prevPdfPage());
                const nextPdfPageBtn = document.getElementById('nextPdfPageBtn');
                if (nextPdfPageBtn) nextPdfPageBtn.addEventListener('click', () => this.nextPdfPage());
                const zoomInPdfBtn = document.getElementById('zoomInPdfBtn');
                if (zoomInPdfBtn) zoomInPdfBtn.addEventListener('click', () => this.zoomPdf(1.25));
                const zoomOutPdfBtn = document.getElementById('zoomOutPdfBtn');
                if (zoomOutPdfBtn) zoomOutPdfBtn.addEventListener('click', () => this.zoomPdf(0.8));
                const pdfFullscreenBtn = document.getElementById('pdfFullscreenBtn');
                if (pdfFullscreenBtn) pdfFullscreenBtn.addEventListener('click', () => this.togglePdfFullscreen());
                // adjust viewer when entering/exiting fullscreen
                document.addEventListener('fullscreenchange', () => {
                    try {
                        // re-render current page to suit new size
                        if (this.pdfState && this.pdfState.pdfDoc) this.renderPdfPage(this.pdfState.currentPage);
                    } catch (e) {}
                });
            },
            
            handleFiles: function(fileList) {
                const progressBar = document.getElementById('uploadProgress');
                const progressFill = document.getElementById('uploadProgressFill');
                const progressText = document.getElementById('progressText');
                
                progressBar.style.display = 'flex';
                
                Array.from(fileList).forEach((file, index) => {
                    setTimeout(() => {
                        this.processFile(file);
                        const progress = ((index + 1) / fileList.length) * 100;
                        progressFill.style.width = `${progress}%`;
                        progressText.textContent = `${Math.round(progress)}%`;
                        
                        if (index === fileList.length - 1) {
                            setTimeout(() => {
                                progressBar.style.display = 'none';
                                progressFill.style.width = '0%';
                                progressText.textContent = '0%';
                                this.renderFiles();
                                this.updateStats();
                            }, 500);
                        }
                    }, index * 300);
                });
            },
            
            processFile: function(file) {
                const reader = new FileReader();
                
                reader.onload = (e) => {
                    const fileData = {
                        id: Date.now() + Math.random(),
                        name: file.name,
                        type: this.getFileType(file),
                        size: this.formatFileSize(file.size),
                        rawSize: file.size,
                        date: new Date().toISOString(),
                        formattedDate: new Date().toLocaleDateString(),
                        content: e.target.result,
                        file: file,
                        selected: false
                    };
                    
                    this.files.push(fileData);
                    this.saveToStorage();
                };
                
                if (file.type.startsWith('image/')) {
                    reader.readAsDataURL(file);
                } else if (file.type === 'application/json') {
                    reader.readAsText(file);
                } else if (file.type === 'text/plain' || file.type === 'text/html') {
                    reader.readAsText(file);
                } else {
                    reader.readAsDataURL(file);
                }
            },
            
            getFileType: function(file) {
                const extension = file.name.split('.').pop().toLowerCase();
                
                if (file.type === 'application/pdf') return 'pdf';
                if (file.type.includes('spreadsheet') || extension === 'xlsx' || extension === 'xls') return 'excel';
                if (file.type.includes('word') || extension === 'doc' || extension === 'docx') return 'word';
                if (file.type.includes('presentation') || extension === 'ppt' || extension === 'pptx') return 'ppt';
                if (file.type.startsWith('image/')) return 'image';
                if (extension === 'json') return 'json';
                if (extension === 'html' || extension === 'htm') return 'html';
                if (extension === 'txt') return 'txt';
                
                return 'other';
            },
            
            formatFileSize: function(bytes) {
                if (bytes === 0) return '0 Bytes';
                const k = 1024;
                const sizes = ['Bytes', 'KB', 'MB', 'GB'];
                const i = Math.floor(Math.log(bytes) / Math.log(k));
                return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
            },
            
            saveToStorage: function() {
                const filesToStore = this.files.map(file => ({
                    ...file,
                    file: undefined // Remove actual file object for storage
                }));
                localStorage.setItem('uploadedFiles', JSON.stringify(filesToStore));
            },
            
            loadStoredFiles: function() {
                const stored = localStorage.getItem('uploadedFiles');
                if (stored) {
                    try {
                        const parsed = JSON.parse(stored);
                        // Note: We can't restore the actual file object, but we keep other metadata
                        this.files = parsed;
                    } catch (e) {
                        console.error('Error loading stored files:', e);
                    }
                }
            },
            
            getFilteredAndSortedFiles: function() {
                let filtered = [...this.files];
                
                // Apply filter
                if (this.currentFilter !== 'all') {
                    filtered = filtered.filter(file => file.type === this.currentFilter);
                }
                
                // Apply sort
                filtered.sort((a, b) => {
                    switch (this.currentSort) {
                        case 'date-desc':
                            return new Date(b.date) - new Date(a.date);
                        case 'date-asc':
                            return new Date(a.date) - new Date(b.date);
                        case 'name-asc':
                            return a.name.localeCompare(b.name);
                        case 'name-desc':
                            return b.name.localeCompare(a.name);
                        case 'size-desc':
                            return b.rawSize - a.rawSize;
                        case 'size-asc':
                            return a.rawSize - b.rawSize;
                        default:
                            return 0;
                    }
                });
                
                return filtered;
            },
            
            renderFiles: function() {
                const filesGrid = document.getElementById('filesGrid');
                const filteredFiles = this.getFilteredAndSortedFiles();
                
                if (filteredFiles.length === 0) {
                    filesGrid.innerHTML = `
                        <div class="empty-state">
                            <i class="fas fa-folder-open"></i>
                            <h3>No files uploaded yet</h3>
                            <p>Drag & drop files here or click to browse</p>
                        </div>
                    `;
                    return;
                }
                
                filesGrid.innerHTML = filteredFiles.map((file, index) => {
                    const fileIcon = this.getFileIcon(file.type);
                    
                    return `
                        <div class="file-card" data-index="${index}" data-id="${file.id}">
                            <div style="display:flex;align-items:center;gap:8px;margin-bottom:8px;">
                                <input type="checkbox" class="file-select" data-id="${file.id}" ${file.selected ? 'checked' : ''} />
                                <div class="file-actions">
                                    <button class="file-action-btn delete-btn" title="Delete">
                                        <i class="fas fa-trash"></i>
                                    </button>
                                    <button class="file-action-btn download-btn" title="Download">
                                        <i class="fas fa-download"></i>
                                    </button>
                                </div>
                            </div>
                            <div class="file-icon ${file.type}">
                                <i class="${fileIcon}"></i>
                            </div>
                            <div class="file-name">${this.truncateFileName(file.name)}</div>
                            <div class="file-size">${file.size}</div>
                            <div class="file-date">${file.formattedDate}</div>
                        </div>
                    `;
                }).join('');
                
                // Add event listeners to file cards
                document.querySelectorAll('.file-card').forEach((card, index) => {
                    card.addEventListener('click', (e) => {
                        if (!e.target.closest('.file-action-btn')) {
                            const fileIndex = parseInt(card.dataset.index);
                            const filteredFiles = this.getFilteredAndSortedFiles();
                            this.openPreview(filteredFiles[fileIndex], fileIndex);
                        }
                    });
                    
                    // Delete button
                    const deleteBtn = card.querySelector('.delete-btn');
                    if (deleteBtn) {
                        deleteBtn.addEventListener('click', (e) => {
                            e.stopPropagation();
                            const fileIndex = parseInt(card.dataset.index);
                            const filteredFiles = this.getFilteredAndSortedFiles();
                            this.deleteFile(filteredFiles[fileIndex].id);
                        });
                    }
                    
                    // Download button
                    const downloadBtn = card.querySelector('.download-btn');
                    if (downloadBtn) {
                        downloadBtn.addEventListener('click', (e) => {
                            e.stopPropagation();
                            const fileIndex = parseInt(card.dataset.index);
                            const filteredFiles = this.getFilteredAndSortedFiles();
                            this.downloadFile(filteredFiles[fileIndex]);
                        });
                    }

                    // Selection checkbox
                    const selectCheckbox = card.querySelector('.file-select');
                    if (selectCheckbox) {
                        selectCheckbox.addEventListener('change', (ev) => {
                            ev.stopPropagation();
                            const id = selectCheckbox.dataset.id;
                            const checked = selectCheckbox.checked;
                            // update underlying file selected state
                            const allIndex = this.files.findIndex(f => String(f.id) === String(id));
                            if (allIndex !== -1) {
                                this.files[allIndex].selected = checked;
                            }
                            // update Delete Selected button state
                            const anySelected = this.files.some(f => f.selected);
                            const delBtn = document.getElementById('deleteSelectedBtn');
                            if (delBtn) delBtn.disabled = !anySelected;
                        });
                    }
                });

                // Select All checkbox handling
                const selectAll = document.getElementById('selectAllCheckbox');
                if (selectAll) {
                    selectAll.checked = this.getFilteredAndSortedFiles().every(f => f.selected);
                    selectAll.addEventListener('change', (e) => {
                        const checked = e.target.checked;
                        const filtered = this.getFilteredAndSortedFiles();
                        filtered.forEach(f => {
                            const idx = this.files.findIndex(x => x.id === f.id);
                            if (idx !== -1) this.files[idx].selected = checked;
                        });
                        this.renderFiles();
                    });
                }

                // Delete selected button
                const deleteSelectedBtn = document.getElementById('deleteSelectedBtn');
                if (deleteSelectedBtn) {
                    deleteSelectedBtn.disabled = !this.files.some(f => f.selected);
                    deleteSelectedBtn.addEventListener('click', () => this.deleteSelected());
                }
            },
            
            getFileIcon: function(type) {
                const icons = {
                    pdf: 'fas fa-file-pdf',
                    excel: 'fas fa-file-excel',
                    word: 'fas fa-file-word',
                    image: 'fas fa-file-image',
                    ppt: 'fas fa-file-powerpoint',
                    json: 'fas fa-file-code',
                    html: 'fas fa-file-code',
                    txt: 'fas fa-file-alt',
                    other: 'fas fa-file'
                };
                return icons[type] || 'fas fa-file';
            },
            
            truncateFileName: function(name, maxLength = 15) {
                if (name.length <= maxLength) return name;
                return name.substring(0, maxLength - 3) + '...';
            },
            
            openPreview: function(file, index) {
                const modal = document.getElementById('previewModal');
                const content = document.getElementById('previewContent');
                const filteredFiles = this.getFilteredAndSortedFiles();
                
                this.currentFileIndex = index;
                
                // Update modal title
                document.getElementById('previewTitle').textContent = file.name;
                
                // Update file info
                document.getElementById('fileNamePreview').textContent = `Name: ${file.name}`;
                document.getElementById('fileSizePreview').textContent = `Size: ${file.size}`;
                document.getElementById('fileTypePreview').textContent = `Type: ${file.type.toUpperCase()}`;
                document.getElementById('uploadDatePreview').textContent = `Uploaded: ${file.formattedDate}`;
                
                // Update navigation buttons
                document.getElementById('prevFileBtn').disabled = index === 0;
                document.getElementById('nextFileBtn').disabled = index === filteredFiles.length - 1;
                document.getElementById('fileCounter').textContent = `${index + 1}/${filteredFiles.length}`;
                
                // Load content based on file type
                this.loadPreviewContent(file, content);
                
                // Show modal
                modal.style.display = 'flex';
                document.body.style.overflow = 'hidden';
            },
            
            loadPreviewContent: function(file, container) {
                container.innerHTML = '';
                
                switch (file.type) {
                    case 'pdf':
                        container.innerHTML = `
                            <iframe src="${file.content}" class="preview-frame" title="${file.name}">
                                <p>Your browser does not support PDF preview. 
                                <a href="${file.content}" download="${file.name}">Download PDF</a></p>
                            </iframe>
                        `;
                        break;
                        
                    case 'image':
                        container.innerHTML = `<img src="${file.content}" alt="${file.name}" class="preview-image">`;
                        break;
                        
                    case 'excel':
                    case 'word':
                    case 'ppt':
                        container.innerHTML = `
                            <div class="preview-unsupported">
                                <i class="fas fa-file-excel"></i>
                                <h3>Preview not available for ${file.type.toUpperCase()} files</h3>
                                <p>Please download the file to view it.</p>
                            </div>
                        `;
                        break;
                        
                    case 'json':
                    case 'txt':
                    case 'html':
                        container.innerHTML = `<pre class="preview-text">${this.escapeHtml(file.content)}</pre>`;
                        break;
                        
                    default:
                        container.innerHTML = `
                            <div class="preview-unsupported">
                                <i class="fas fa-file"></i>
                                <h3>Preview not available for this file type</h3>
                                <p>Please download the file to view it.</p>
                            </div>
                        `;
                }
            },
            
            escapeHtml: function(text) {
                const div = document.createElement('div');
                div.textContent = text;
                return div.innerHTML;
            },
            
            closePreview: function() {
                const modal = document.getElementById('previewModal');
                modal.style.display = 'none';
                document.body.style.overflow = 'auto';
                // cleanup any PDF viewer state
                try { this.cleanupPdfViewer(); } catch (e) {}
            },
            
            showPrevFile: function() {
                if (this.currentFileIndex > 0) {
                    const filteredFiles = this.getFilteredAndSortedFiles();
                    this.openPreview(filteredFiles[this.currentFileIndex - 1], this.currentFileIndex - 1);
                }
            },
            
            showNextFile: function() {
                const filteredFiles = this.getFilteredAndSortedFiles();
                if (this.currentFileIndex < filteredFiles.length - 1) {
                    this.openPreview(filteredFiles[this.currentFileIndex + 1], this.currentFileIndex + 1);
                }
            },
            
            downloadFile: function(file) {
                const a = document.createElement('a');
                a.href = file.content;
                a.download = file.name;
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
            },
            
            downloadCurrentFile: function() {
                const filteredFiles = this.getFilteredAndSortedFiles();
                const currentFile = filteredFiles[this.currentFileIndex];
                if (currentFile) {
                    this.downloadFile(currentFile);
                }
            },
            
            deleteFile: function(fileId) {
                if (confirm('Are you sure you want to delete this file?')) {
                    this.files = this.files.filter(file => file.id !== fileId);
                    this.saveToStorage();
                    this.renderFiles();
                    this.updateStats();
                    this.closePreview();
                }
            },

            deleteSelected: function() {
                const selected = this.files.filter(f => f.selected);
                if (selected.length === 0) return;
                if (!confirm(`Delete ${selected.length} selected file(s)?`)) return;
                const ids = new Set(selected.map(s => s.id));
                this.files = this.files.filter(f => !ids.has(f.id));
                this.saveToStorage();
                this.renderFiles();
                this.updateStats();
            },
            
            updateStats: function() {
                const totalFiles = this.files.length;
                const totalSize = this.files.reduce((sum, file) => sum + (file.rawSize || 0), 0);
                const lastUpload = this.files.length > 0 
                    ? new Date(this.files[this.files.length - 1].date).toLocaleDateString()
                    : 'Never';
                
                document.getElementById('totalFiles').textContent = totalFiles;
                document.getElementById('totalSize').textContent = this.formatFileSize(totalSize);
                document.getElementById('lastUpload').textContent = lastUpload;
            }
            ,

            // PDF.js viewer state and methods
                pdfState: {
                pdfDoc: null,
                currentPage: 1,
                scale: 1.0,
                objectUrl: null
            },

            openPdfWithPdfJs: async function(file) {
                const pdfjsLib = window['pdfjs-dist/build/pdf'] || window.pdfjsLib;
                if (!pdfjsLib) {
                    alert('PDF.js not loaded');
                    return;
                }

                pdfjsLib.GlobalWorkerOptions.workerSrc = 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.11.174/pdf.worker.min.js';

                const filteredFiles = this.getFilteredAndSortedFiles();
                const current = file || filteredFiles[this.currentFileIndex];
                if (!current) return;

                // Ensure we have a blob/url
                let blobUrl = null;
                if (current.file instanceof File) {
                    blobUrl = URL.createObjectURL(current.file);
                } else if (typeof current.content === 'string') {
                    if (current.content.startsWith('data:') || current.content.startsWith('blob:')) {
                        // convert data: to blob URL if needed
                        if (current.content.startsWith('data:')) {
                            const res = await fetch(current.content);
                            const blob = await res.blob();
                            blobUrl = URL.createObjectURL(blob);
                        } else {
                            blobUrl = current.content;
                        }
                    } else {
                        // fallback: try fetch
                        try {
                            const res = await fetch(current.content);
                            if (res.ok) {
                                const blob = await res.blob();
                                blobUrl = URL.createObjectURL(blob);
                            }
                        } catch (e) {
                            console.warn('Could not fetch PDF content', e);
                        }
                    }
                }

                if (!blobUrl) {
                    alert('Unable to load PDF content for viewing');
                    return;
                }

                this.pdfState.objectUrl = blobUrl;

                // show modal and prepare canvas
                const modal = document.getElementById('previewModal');
                const content = document.getElementById('previewContent');
                modal.style.display = 'flex';
                document.body.style.overflow = 'hidden';
                content.innerHTML = '<canvas id="pdfJsCanvas" style="display:block;margin:0 auto;max-width:100%;"></canvas>';

                try {
                    const loadingTask = pdfjsLib.getDocument(blobUrl);
                    this.pdfState.pdfDoc = await loadingTask.promise;
                    this.pdfState.currentPage = 1;
                    // enable/disable page nav
                    document.getElementById('prevPdfPageBtn').disabled = false;
                    document.getElementById('nextPdfPageBtn').disabled = false;
                    // enable zoom controls
                    const zin = document.getElementById('zoomInPdfBtn');
                    const zout = document.getElementById('zoomOutPdfBtn');
                    if (zin) zin.disabled = false;
                    if (zout) zout.disabled = false;
                    await this.renderPdfPage(this.pdfState.currentPage);
                } catch (err) {
                    console.error('PDF load error:', err);
                    alert('Failed to load PDF');
                }
            },

            renderPdfPage: async function(pageNum) {
                if (!this.pdfState.pdfDoc) return;
                const page = await this.pdfState.pdfDoc.getPage(pageNum);
                const viewport = page.getViewport({ scale: this.pdfState.scale });
                let canvas = document.getElementById('pdfJsCanvas');
                if (!canvas) {
                    const content = document.getElementById('previewContent');
                    content.innerHTML = '<canvas id="pdfJsCanvas" style="width:100%;height:auto;display:block;margin:0 auto;max-width:100%;"></canvas>';
                    canvas = document.getElementById('pdfJsCanvas');
                }
                const context = canvas.getContext('2d');
                // set internal pixel size to viewport size; avoid forcing CSS width so zoom affects actual render
                canvas.width = Math.floor(viewport.width);
                canvas.height = Math.floor(viewport.height);
                canvas.style.width = '';
                canvas.style.height = '';

                const renderContext = {
                    canvasContext: context,
                    viewport: viewport
                };

                await page.render(renderContext).promise;
                this.pdfState.currentPage = pageNum;
                // update footer info
                document.getElementById('fileNamePreview').textContent = (this.getFilteredAndSortedFiles()[this.currentFileIndex] || {}).name || '';
            },

            prevPdfPage: function() {
                if (!this.pdfState.pdfDoc) return;
                const prev = Math.max(1, this.pdfState.currentPage - 1);
                if (prev !== this.pdfState.currentPage) this.renderPdfPage(prev);
            },

            nextPdfPage: function() {
                if (!this.pdfState.pdfDoc) return;
                const next = Math.min(this.pdfState.pdfDoc.numPages, this.pdfState.currentPage + 1);
                if (next !== this.pdfState.currentPage) this.renderPdfPage(next);
            },

            zoomPdf: function(factor) {
                if (!this.pdfState.pdfDoc) return;
                this.pdfState.scale = Math.max(0.2, this.pdfState.scale * factor);
                this.renderPdfPage(this.pdfState.currentPage);
            },

            togglePdfFullscreen: async function() {
                const modal = document.getElementById('previewModal');
                if (!modal) return;

                try {
                    if (!document.fullscreenElement) {
                        await modal.requestFullscreen();
                        // slightly increase scale for fullscreen for better readability
                        this.pdfState.scale = Math.min(5, this.pdfState.scale * 1.5);
                        this.renderPdfPage(this.pdfState.currentPage);
                    } else {
                        await document.exitFullscreen();
                        // restore scale down a bit
                        this.pdfState.scale = Math.max(0.2, this.pdfState.scale / 1.5);
                        this.renderPdfPage(this.pdfState.currentPage);
                    }
                } catch (e) {
                    console.warn('Fullscreen toggle error', e);
                }
            },

            cleanupPdfViewer: function() {
                if (this.pdfState.objectUrl) {
                    try { URL.revokeObjectURL(this.pdfState.objectUrl); } catch (e) {}
                    this.pdfState.objectUrl = null;
                }
                this.pdfState.pdfDoc = null;
                this.pdfState.currentPage = 1;
            }
        };

        // Theme helper: apply CSS variable-based themes
        function setTheme(name) {
            const themes = {
                default: { '--primary': '#2a9d8f', '--secondary': '#264653', '--accent': '#e9c46a', '--light':'#f8f9fa', '--dark':'#212529' },
                teal: { '--primary': '#0ea5a4', '--secondary': '#075985', '--accent': '#38bdf8', '--light':'#f0fdfa', '--dark':'#06243a' },
                purple: { '--primary': '#7c3aed', '--secondary': '#5b21b6', '--accent': '#f472b6', '--light':'#fbf7ff', '--dark':'#1f1336' },
                olive: { '--primary': '#556b2f', '--secondary': '#3d5223', '--accent': '#b5c99a', '--light':'#fbfdf7', '--dark':'#222617' },
                dark: { '--primary': '#111827', '--secondary': '#0f1724', '--accent': '#4f46e5', '--light':'#0b1220', '--dark':'#e5e7eb' }
            };
            const theme = themes[name] || themes['default'];
            Object.keys(theme).forEach(key => {
                document.documentElement.style.setProperty(key, theme[key]);
            });
            try { localStorage.setItem('selectedTheme', name); } catch (e) {}
        }

        // Initialize everything when the page loads
        document.addEventListener('DOMContentLoaded', function() {
            // Initialize TTS
            ttsManager.init();
            
            // Initialize existing functionality
            initExistingFunctionality();
            
            // Initialize Quiz
            initQuiz();
            
            // Initialize Dropdowns
            initDropdowns();
            
            // Initialize upload system
            uploadSystem.init();
            // Restore previously selected theme (if any) and wire the selector
            try {
                const savedTheme = localStorage.getItem('selectedTheme') || 'default';
                setTheme(savedTheme);
                const themeSelect = document.getElementById('themeSelect');
                if (themeSelect) {
                    themeSelect.value = savedTheme;
                    themeSelect.addEventListener('change', (e) => setTheme(e.target.value));
                }
            } catch (e) { console.warn('Theme init failed', e); }
            // Ensure attached PDF is permanently available in the file list (deferred to after init)
            try {
                setTimeout(() => {
                    const permanentPdfName = 'JB Training Module (2) (1).pdf';
                    let existsInSystem = false;
                    if (window.uploadSystem && Array.isArray(uploadSystem.files)) {
                        existsInSystem = uploadSystem.files.some(f => f && f.name === permanentPdfName);
                    }
                    if (!existsInSystem) {
                        const now = new Date().toISOString();
                        const entry = {
                            id: 'permanent-' + Date.now(),
                            name: permanentPdfName,
                            type: 'pdf',
                            size: 'â€”',
                            rawSize: 0,
                            date: now,
                            formattedDate: new Date().toLocaleDateString(),
                            content: permanentPdfName,
                            file: undefined,
                            selected: false,
                            permanent: true
                        };
                        if (window.uploadSystem && Array.isArray(uploadSystem.files)) {
                            uploadSystem.files.push(entry);
                            try { if (typeof uploadSystem.saveToStorage === 'function') uploadSystem.saveToStorage(); } catch(e){}
                            try { if (typeof uploadSystem.renderFiles === 'function') uploadSystem.renderFiles(); } catch(e){}
                            try { if (typeof uploadSystem.updateStats === 'function') uploadSystem.updateStats(); } catch(e){}
                        } else {
                            try {
                                const stored = JSON.parse(localStorage.getItem('uploadedFiles') || '[]');
                                if (!stored.some(f => f && f.name === permanentPdfName)) {
                                    stored.push(entry);
                                    localStorage.setItem('uploadedFiles', JSON.stringify(stored));
                                }
                            } catch (e) {}
                        }
                    }
                }, 300);
            } catch (e) { console.warn('Could not register permanent PDF', e); }
            
            // Add keyboard shortcuts for TTS
            document.addEventListener('keydown', (e) => {
                // Ctrl+Alt+Space to play/pause TTS
                if (e.ctrlKey && e.altKey && e.code === 'Space') {
                    e.preventDefault();
                    if (ttsManager.isPlaying) {
                        ttsManager.pause();
                    } else {
                        ttsManager.play();
                    }
                }
                
                // Ctrl+Alt+S to stop TTS
                if (e.ctrlKey && e.altKey && e.code === 'KeyS') {
                    e.preventDefault();
                    ttsManager.stop();
                }
                
                // Ctrl+Alt+Right to next section
                if (e.ctrlKey && e.altKey && e.code === 'ArrowRight') {
                    e.preventDefault();
                    if (ttsManager.currentSectionIndex < ttsManager.sections.length - 1) {
                        ttsManager.currentSectionIndex++;
                        ttsManager.updateCurrentSection();
                        ttsManager.playCurrentSection();
                    }
                }
                
                // Ctrl+Alt+Left to previous section
                if (e.ctrlKey && e.altKey && e.code === 'ArrowLeft') {
                    e.preventDefault();
                    if (ttsManager.currentSectionIndex > 0) {
                        ttsManager.currentSectionIndex--;
                        ttsManager.updateCurrentSection();
                        ttsManager.playCurrentSection();
                    }
                }
                
                // Ctrl+Alt+E for English
                if (e.ctrlKey && e.altKey && e.code === 'KeyE') {
                    e.preventDefault();
                    ttsManager.switchLanguage('en');
                }
                
                // Ctrl+Alt+H for Hindi
                if (e.ctrlKey && e.altKey && e.code === 'KeyH') {
                    e.preventDefault();
                    ttsManager.switchLanguage('hi');
                }
                
                // Ctrl+Alt+G for Gujarati
                if (e.ctrlKey && e.altKey && e.code === 'KeyG') {
                    e.preventDefault();
                    ttsManager.switchLanguage('gu');
                }

                // Keyboard shortcuts for upload system
                const previewModal = document.getElementById('previewModal');
                if (previewModal.style.display === 'flex') {
                    // Escape to close preview
                    if (e.key === 'Escape') {
                        uploadSystem.closePreview();
                    }
                    
                    // Arrow keys for navigation
                    if (e.key === 'ArrowLeft') {
                        e.preventDefault();
                        uploadSystem.showPrevFile();
                    }
                    
                    if (e.key === 'ArrowRight') {
                        e.preventDefault();
                        uploadSystem.showNextFile();
                    }
                }
            });
            
            // Show a help tooltip for keyboard shortcuts
            setTimeout(() => {
                if (!localStorage.getItem('ttsHelpShown')) {
                    const helpMessage = `Keyboard shortcuts:
â€¢ Ctrl+Alt+Space: Play/Pause TTS
â€¢ Ctrl+Alt+S: Stop TTS
â€¢ Ctrl+Alt+E/H/G: Switch to English/Hindi/Gujarati`;
                    ttsManager.showToast(helpMessage, 'info');
                    localStorage.setItem('ttsHelpShown', 'true');
                }
            }, 2000);
        });

        // Initialize existing functionality
        function initExistingFunctionality() {
            // Navigation highlighting
            const navLinks = document.querySelectorAll('.nav-links a');
            const sections = document.querySelectorAll('.section, .quiz-section, #upload-section');
            
            function highlightNav() {
                let index = sections.length;
                
                while(--index && window.scrollY + 100 < sections[index].offsetTop) {}
                
                navLinks.forEach((link) => link.classList.remove('active'));
                if (navLinks[index]) {
                    navLinks[index].classList.add('active');
                }
            }
            
            window.addEventListener('scroll', highlightNav);
            
            // Smooth scrolling for navigation links
            navLinks.forEach(link => {
                link.addEventListener('click', function(e) {
                    e.preventDefault();
                    
                    const targetId = this.getAttribute('href');
                    const targetSection = document.querySelector(targetId);
                    
                    if (targetSection) {
                        window.scrollTo({
                            top: targetSection.offsetTop - 30,
                            behavior: 'smooth'
                        });
                    }
                });
            });
            
            // Search functionality
            const searchInput = document.getElementById('searchInput');
            searchInput.addEventListener('input', function() {
                const searchTerm = this.value.toLowerCase();
                
                sections.forEach(section => {
                    const sectionText = section.textContent.toLowerCase();
                    if (sectionText.includes(searchTerm)) {
                        section.style.display = 'block';
                    } else {
                        section.style.display = 'none';
                    }
                });
            });
            
            // Back to top button
            const backToTopBtn = document.getElementById('backToTop');
            window.addEventListener('scroll', function() {
                if (window.pageYOffset > 300) {
                    backToTopBtn.style.display = 'flex';
                } else {
                    backToTopBtn.style.display = 'none';
                }
            });
            
            backToTopBtn.addEventListener('click', function() {
                window.scrollTo({
                    top: 0,
                    behavior: 'smooth'
                });
            });
            
            // Progress bar
            window.addEventListener('scroll', function() {
                const winHeight = window.innerHeight;
                const docHeight = document.documentElement.scrollHeight;
                const scrollTop = window.pageYOffset;
                const scrollPercent = (scrollTop / (docHeight - winHeight)) * 100;
                document.getElementById('progressBar').style.width = scrollPercent + '%';
            });
            
            // PDF download functionality simulation
            document.getElementById('downloadPdf').addEventListener('click', function() {
                const toast = document.getElementById('toast');
                const toastMessage = document.getElementById('toastMessage');
                
                toastMessage.textContent = "PDF download started!";
                toast.classList.add('show');
                
                setTimeout(function() {
                    toast.classList.remove('show');
                }, 3000);
                
                console.log("PDF download functionality would be implemented here");
            });
            
            // Print functionality
            document.getElementById('printBtn').addEventListener('click', function() {
                window.print();
            });
            
            // Dark mode toggle
            const darkModeToggle = document.getElementById('darkModeToggle');
            darkModeToggle.addEventListener('change', function() {
                document.body.classList.toggle('dark-mode');
                
                if (document.body.classList.contains('dark-mode')) {
                    document.body.style.backgroundColor = '#121212';
                    document.body.style.color = '#f5f5f5';
                    document.querySelector('.container').style.backgroundColor = '#1e1e1e';
                    
                    // Update section backgrounds for dark mode
                    document.querySelectorAll('.section, .quiz-section, #upload-section').forEach(section => {
                        section.style.backgroundColor = '#2d2d2d';
                        section.style.color = '#f5f5f5';
                    });
                    
                    // Update table backgrounds for dark mode
                    document.querySelectorAll('table').forEach(table => {
                        table.style.backgroundColor = '#2d2d2d';
                        table.style.color = '#f5f5f5';
                    });
                    
                    // Update card backgrounds for dark mode
                    document.querySelectorAll('.example-card, .rule-card, .stat-card, .level-card, .question-card, .answer-card, .file-card').forEach(card => {
                        card.style.backgroundColor = '#2d2d2d';
                        card.style.color = '#f5f5f5';
                    });
                } else {
                    document.body.style.backgroundColor = '';
                    document.body.style.color = '';
                    document.querySelector('.container').style.backgroundColor = 'white';
                    
                    // Reset section backgrounds
                    document.querySelectorAll('.section, .quiz-section, #upload-section').forEach(section => {
                        section.style.backgroundColor = '';
                        section.style.color = '';
                    });
                    
                    // Reset table backgrounds
                    document.querySelectorAll('table').forEach(table => {
                        table.style.backgroundColor = '';
                        table.style.color = '';
                    });
                    
                    // Reset card backgrounds
                    document.querySelectorAll('.example-card, .rule-card, .stat-card, .level-card, .question-card, .answer-card, .file-card').forEach(card => {
                        card.style.backgroundColor = '';
                        card.style.color = '';
                    });
                }
            });
        }
        
        // Initialize Dropdowns
        function initDropdowns() {
            const dropdowns = document.querySelectorAll('.dropdown');
            
            dropdowns.forEach(dropdown => {
                const button = dropdown.querySelector('.dropdown-btn');
                
                button.addEventListener('click', function(e) {
                    e.preventDefault();
                    e.stopPropagation();
                    
                    // Close other dropdowns
                    dropdowns.forEach(otherDropdown => {
                        if (otherDropdown !== dropdown && otherDropdown.classList.contains('active')) {
                            otherDropdown.classList.remove('active');
                        }
                    });
                    
                    // Toggle current dropdown
                    dropdown.classList.toggle('active');
                    
                    // If clicking an active dropdown link that's not the button
                    if (this.getAttribute('href') && !this.classList.contains('dropdown-btn')) {
                        const targetId = this.getAttribute('href');
                        const targetSection = document.querySelector(targetId);
                        
                        if (targetSection) {
                            window.scrollTo({
                                top: targetSection.offsetTop - 30,
                                behavior: 'smooth'
                            });
                            
                            // Update active states
                            document.querySelectorAll('.nav-links a').forEach(link => {
                                link.classList.remove('active');
                            });
                            this.classList.add('active');
                        }
                    }
                });
                
                // Handle clicks on dropdown items
                const dropdownItems = dropdown.querySelectorAll('.dropdown-content a');
                dropdownItems.forEach(item => {
                    item.addEventListener('click', function(e) {
                        const targetId = this.getAttribute('href');
                        const targetSection = document.querySelector(targetId);
                        
                        if (targetSection) {
                            // Close dropdown after selection on mobile
                            if (window.innerWidth <= 1200) {
                                dropdown.classList.remove('active');
                            }
                            
                            // Update active states
                            document.querySelectorAll('.nav-links a').forEach(link => {
                                link.classList.remove('active');
                            });
                            
                            // Set parent dropdown button as active
                            const parentButton = dropdown.querySelector('.dropdown-btn');
                            parentButton.classList.add('active');
                            
                            // Scroll to section
                            window.scrollTo({
                                top: targetSection.offsetTop - 30,
                                behavior: 'smooth'
                            });
                        }
                    });
                });
            });
            
            // Close dropdowns when clicking outside
            document.addEventListener('click', function(e) {
                if (!e.target.closest('.dropdown')) {
                    dropdowns.forEach(dropdown => {
                        dropdown.classList.remove('active');
                    });
                }
            });
            
            // Update active states based on scroll for dropdown items
            const dropdownAnchors = document.querySelectorAll('.dropdown-content a');
            
            function updateDropdownActiveState() {
                let current = '';
                const sections = document.querySelectorAll('.section, .quiz-section, #upload-section');
                
                sections.forEach(section => {
                    const sectionTop = section.offsetTop;
                    const sectionHeight = section.clientHeight;
                    if (scrollY >= (sectionTop - 150)) {
                        current = '#' + section.getAttribute('id');
                    }
                });
                
                // Remove active from all dropdown items
                dropdownAnchors.forEach(link => {
                    link.classList.remove('active');
                });
                
                // Add active to current section link in dropdown
                if (current) {
                    const activeLink = document.querySelector(`.dropdown-content a[href="${current}"]`);
                    if (activeLink) {
                        activeLink.classList.add('active');
                        
                        // Also activate the parent dropdown button
                        const parentDropdown = activeLink.closest('.dropdown');
                        if (parentDropdown) {
                            const dropdownButton = parentDropdown.querySelector('.dropdown-btn');
                            document.querySelectorAll('.dropdown-btn').forEach(btn => {
                                btn.classList.remove('active');
                            });
                            dropdownButton.classList.add('active');
                        }
                    }
                }
            }
            
            // Call on scroll
            window.addEventListener('scroll', updateDropdownActiveState);
            
            // Update existing scroll highlight function
            function highlightNav() {
                const sections = document.querySelectorAll('.section, .quiz-section, #upload-section');
                let current = '';
                
                sections.forEach(section => {
                    const sectionTop = section.offsetTop;
                    if (scrollY >= sectionTop - 150) {
                        current = '#' + section.getAttribute('id');
                    }
                });
                
                // Update main navigation
                document.querySelectorAll('.nav-links > li > a').forEach(link => {
                    link.classList.remove('active');
                    if (link.getAttribute('href') === current) {
                        link.classList.add('active');
                        
                        // Open the dropdown if it's a dropdown item
                        const parentDropdown = link.closest('.dropdown');
                        if (parentDropdown) {
                            parentDropdown.classList.add('active');
                        }
                    }
                });
            }
            
            // Add smooth scrolling for dropdown anchors
            dropdownAnchors.forEach(anchor => {
                anchor.addEventListener('click', function(e) {
                    e.preventDefault();
                    const targetId = this.getAttribute('href');
                    if (targetId.startsWith('#')) {
                        const targetElement = document.querySelector(targetId);
                        if (targetElement) {
                            window.scrollTo({
                                top: targetElement.offsetTop - 30,
                                behavior: 'smooth'
                            });
                        }
                    }
                });
            });
        }

        // Quiz Functions
        function initQuiz() {
            setupLevelSelection();
            setupQuizControls();
        }

        function setupLevelSelection() {
            const levelCards = document.querySelectorAll('.level-card');
            levelCards.forEach(card => {
                card.addEventListener('click', function() {
                    currentLevel = parseInt(this.dataset.level);
                    startQuiz(currentLevel);
                });
            });
        }

        function startQuiz(level) {
            // Reset state
            userAnswers = {};
            
            // Update UI
            document.getElementById('currentLevel').textContent = `Level ${level}`;
            document.querySelector('.quiz-levels').style.display = 'none';
            document.getElementById('quizContainer').classList.add('active');
            
            // Shuffle questions
            shuffleQuestions(level);
            
            // Display questions
            displayQuestions();
            
            // Update progress
            updateProgress();
            
            // Scroll to quiz
            document.getElementById('quiz-section').scrollIntoView({ behavior: 'smooth' });
        }

        function shuffleQuestions(level) {
            const questions = [...questionBanks[level]];
            
            // Shuffle the questions
            for (let i = questions.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [questions[i], questions[j]] = [questions[j], questions[i]];
            }
            
            // Shuffle options for each question
            questions.forEach(question => {
                const options = [...question.options];
                const correctAnswerText = options[question.correctAnswer];
                
                // Shuffle options
                for (let i = options.length - 1; i > 0; i--) {
                    const j = Math.floor(Math.random() * (i + 1));
                    [options[i], options[j]] = [options[j], options[i]];
                }
                
                // Find new position of correct answer
                const newCorrectIndex = options.indexOf(correctAnswerText);
                
                // Update question with shuffled options
                question.shuffledOptions = options;
                question.shuffledCorrectIndex = newCorrectIndex;
            });
            
            shuffledQuestions = questions;
        }

        function displayQuestions() {
            const questionsGrid = document.getElementById('questionsGrid');
            questionsGrid.innerHTML = '';
            
            // For Level 4, show all questions in a scrollable grid
            if (currentLevel === 4) {
                questionsGrid.className = 'questions-grid-level4';
            }
            
            shuffledQuestions.forEach((question, index) => {
                const questionCard = createQuestionCard(question, index);
                questionsGrid.appendChild(questionCard);
            });
        }

        function createQuestionCard(question, index) {
            const card = document.createElement('div');
            card.className = 'question-card';
            card.id = `question-${index}`;
            
            const userAnswer = userAnswers[index];
            
            let optionsHTML = '';
            question.shuffledOptions.forEach((option, optionIndex) => {
                const isSelected = userAnswer === optionIndex;
                const letter = String.fromCharCode(65 + optionIndex);
                
                optionsHTML += `
                    <div class="option ${isSelected ? 'selected' : ''}" 
                         onclick="selectAnswer(${index}, ${optionIndex})"
                         data-option-index="${optionIndex}">
                        <div class="option-letter">${letter}</div>
                        <div class="option-text">${option}</div>
                    </div>
                `;
            });
            
            card.innerHTML = `
                <div class="question-header">
                    <div class="question-number">${index + 1}</div>
                    <div class="question-text">${question.question}</div>
                </div>
                <div class="options-container">
                    ${optionsHTML}
                </div>
            `;
            
            return card;
        }

        function selectAnswer(questionIndex, optionIndex) {
            userAnswers[questionIndex] = optionIndex;
            
            // Update UI
            const questionCard = document.getElementById(`question-${questionIndex}`);
            const options = questionCard.querySelectorAll('.option');
            
            options.forEach((option, index) => {
                if (index === optionIndex) {
                    option.classList.add('selected');
                    // Add animation
                    option.style.transform = 'scale(1.02)';
                    setTimeout(() => {
                        option.style.transform = 'scale(1)';
                    }, 200);
                } else {
                    option.classList.remove('selected');
                }
            });
            
            // Update progress
            updateProgress();
        }

        function updateProgress() {
            const answeredCount = Object.keys(userAnswers).length;
            const totalQuestions = shuffledQuestions.length;
            const percentage = Math.round((answeredCount / totalQuestions) * 100);
            
            document.getElementById('answeredCount').textContent = answeredCount;
            document.getElementById('progressPercentage').textContent = `${percentage}%`;
            document.getElementById('progressFill').style.width = `${percentage}%`;
            
            // Update progress bar color
            const progressFill = document.getElementById('progressFill');
            if (percentage < 33) {
                progressFill.style.background = 'linear-gradient(135deg, #ef4444, #f97316)';
            } else if (percentage < 66) {
                progressFill.style.background = 'linear-gradient(135deg, #f59e0b, #eab308)';
            } else {
                progressFill.style.background = 'linear-gradient(135deg, var(--quiz-primary), var(--quiz-secondary))';
            }
        }

        function setupQuizControls() {
            // Submit Quiz
            document.getElementById('submitQuiz').addEventListener('click', submitQuiz);
            
            // Back to Levels
            document.getElementById('backToLevels').addEventListener('click', function() {
                document.getElementById('quizContainer').classList.remove('active');
                document.getElementById('resultsContainer').classList.remove('active');
                document.querySelector('.quiz-levels').style.display = 'grid';
            });
            
            // Retry Quiz
            document.getElementById('retryQuiz').addEventListener('click', function() {
                document.getElementById('resultsContainer').classList.remove('active');
                startQuiz(currentLevel);
            });
            
            // Try Another Level
            document.getElementById('tryAnotherLevel').addEventListener('click', function() {
                document.getElementById('resultsContainer').classList.remove('active');
                document.getElementById('quizContainer').classList.remove('active');
                document.querySelector('.quiz-levels').style.display = 'grid';
            });
        }

        function submitQuiz() {
            // Calculate results
            let correctCount = 0;
            const results = [];
            
            shuffledQuestions.forEach((question, index) => {
                const userAnswer = userAnswers[index];
                const isCorrect = userAnswer === question.shuffledCorrectIndex;
                
                if (isCorrect) {
                    correctCount++;
                }
                
                results.push({
                    question: question.question,
                    userAnswerIndex: userAnswer,
                    correctAnswerIndex: question.shuffledCorrectIndex,
                    shuffledOptions: question.shuffledOptions,
                    isCorrect: isCorrect,
                    explanation: question.explanation
                });
            });
            
            // Calculate statistics
            const totalQuestions = shuffledQuestions.length;
            const percentage = Math.round((correctCount / totalQuestions) * 100);
            const unanswered = totalQuestions - Object.keys(userAnswers).length;
            const incorrect = totalQuestions - correctCount - unanswered;
            const accuracy = Object.keys(userAnswers).length > 0 
                ? Math.round((correctCount / Object.keys(userAnswers).length) * 100)
                : 0;
            
            // Show results
            document.getElementById('quizContainer').classList.remove('active');
            document.getElementById('resultsContainer').classList.add('active');
            
            // Update results display
            document.getElementById('finalScore').textContent = `${correctCount}/${totalQuestions}`;
            document.getElementById('scorePercentage').textContent = `${percentage}%`;
            document.getElementById('correctCount').textContent = correctCount;
            document.getElementById('incorrectCount').textContent = incorrect;
            document.getElementById('unansweredCount').textContent = unanswered;
            document.getElementById('accuracy').textContent = `${accuracy}%`;
            
            // Set score message
            let message = "";
            if (percentage >= 90) {
                message = "Excellent! You're an invoice processing expert! ðŸ†";
            } else if (percentage >= 80) {
                message = "Great job! You have excellent knowledge!";
            } else if (percentage >= 70) {
                message = "Good work! You understand invoice processing well.";
            } else if (percentage >= 60) {
                message = "Not bad! Review the guidelines for better results.";
            } else {
                message = "Keep practicing! Review the guidelines carefully.";
            }
            document.getElementById('scoreMessage').textContent = message;
            
            // Display answer review
            displayAnswerReview(results);
            
            // Scroll to results
            document.getElementById('resultsContainer').scrollIntoView({ behavior: 'smooth' });
        }

        function displayAnswerReview(results) {
            const answerCards = document.getElementById('answerCards');
            answerCards.innerHTML = '';
            
            results.forEach((result, index) => {
                const userAnswerText = result.userAnswerIndex !== undefined 
                    ? result.shuffledOptions[result.userAnswerIndex]
                    : "Not answered";
                
                const correctAnswerText = result.shuffledOptions[result.correctAnswerIndex];
                const userLetter = result.userAnswerIndex !== undefined 
                    ? String.fromCharCode(65 + result.userAnswerIndex)
                    : "â€”";
                const correctLetter = String.fromCharCode(65 + result.correctAnswerIndex);
                
                const answerCard = document.createElement('div');
                answerCard.className = `answer-card ${result.isCorrect ? 'correct' : 'incorrect'}`;
                
                answerCard.innerHTML = `
                    <div class="answer-header">
                        <div class="question-number-small">${index + 1}</div>
                        <div class="answer-status ${result.isCorrect ? 'status-correct' : 'status-incorrect'}">
                            ${result.isCorrect ? 'âœ“ Correct' : 'âœ— Incorrect'}
                        </div>
                    </div>
                    
                    <div class="question-review">${result.question}</div>
                    
                    <div class="answer-comparison">
                        <div class="answer-box user-answer">
                            <div class="box-label">Your Answer</div>
                            <div class="answer-text">${userAnswerText}</div>
                            <div class="option-indicator">Option ${userLetter}</div>
                        </div>
                        
                        <div class="answer-box correct-answer">
                            <div class="box-label">Correct Answer</div>
                            <div class="answer-text">${correctAnswerText}</div>
                            <div class="option-indicator">Option ${correctLetter}</div>
                        </div>
                    </div>
                    
                    <div class="explanation">
                        <strong>Explanation:</strong> ${result.explanation}
                    </div>
                `;
                
                answerCards.appendChild(answerCard);
            });
        }

        // Make selectAnswer available globally
        window.selectAnswer = selectAnswer;
    </script>
</body>
</html>
